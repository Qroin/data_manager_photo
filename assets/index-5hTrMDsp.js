(function(){const C=document.createElement("link").relList;if(C&&C.supports&&C.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))w(d);new MutationObserver(d=>{for(const a of d)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&w(i)}).observe(document,{childList:!0,subtree:!0});function s(d){const a={};return d.integrity&&(a.integrity=d.integrity),d.referrerPolicy&&(a.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?a.credentials="include":d.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function w(d){if(d.ep)return;d.ep=!0;const a=s(d);fetch(d.href,a)}})();var qt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $e(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function Yt(x){throw new Error('Could not dynamically require "'+x+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ie={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(x,C){(function(s){x.exports=s()})(function(){return function s(w,d,a){function i(p,y){if(!d[p]){if(!w[p]){var g=typeof Yt=="function"&&Yt;if(!y&&g)return g(p,!0);if(e)return e(p,!0);var b=new Error("Cannot find module '"+p+"'");throw b.code="MODULE_NOT_FOUND",b}var r=d[p]={exports:{}};w[p][0].call(r.exports,function(f){var o=w[p][1][f];return i(o||f)},r,r.exports,s,w,d,a)}return d[p].exports}for(var e=typeof Yt=="function"&&Yt,l=0;l<a.length;l++)i(a[l]);return i}({1:[function(s,w,d){var a=s("./utils"),i=s("./support"),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(l){for(var p,y,g,b,r,f,o,u=[],c=0,_=l.length,k=_,I=a.getTypeOf(l)!=="string";c<l.length;)k=_-c,g=I?(p=l[c++],y=c<_?l[c++]:0,c<_?l[c++]:0):(p=l.charCodeAt(c++),y=c<_?l.charCodeAt(c++):0,c<_?l.charCodeAt(c++):0),b=p>>2,r=(3&p)<<4|y>>4,f=1<k?(15&y)<<2|g>>6:64,o=2<k?63&g:64,u.push(e.charAt(b)+e.charAt(r)+e.charAt(f)+e.charAt(o));return u.join("")},d.decode=function(l){var p,y,g,b,r,f,o=0,u=0,c="data:";if(l.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var _,k=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===e.charAt(64)&&k--,l.charAt(l.length-2)===e.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=i.uint8array?new Uint8Array(0|k):new Array(0|k);o<l.length;)p=e.indexOf(l.charAt(o++))<<2|(b=e.indexOf(l.charAt(o++)))>>4,y=(15&b)<<4|(r=e.indexOf(l.charAt(o++)))>>2,g=(3&r)<<6|(f=e.indexOf(l.charAt(o++))),_[u++]=p,r!==64&&(_[u++]=y),f!==64&&(_[u++]=g);return _}},{"./support":30,"./utils":32}],2:[function(s,w,d){var a=s("./external"),i=s("./stream/DataWorker"),e=s("./stream/Crc32Probe"),l=s("./stream/DataLengthProbe");function p(y,g,b,r,f){this.compressedSize=y,this.uncompressedSize=g,this.crc32=b,this.compression=r,this.compressedContent=f}p.prototype={getContentWorker:function(){var y=new i(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),g=this;return y.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new i(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(y,g,b){return y.pipe(new e).pipe(new l("uncompressedSize")).pipe(g.compressWorker(b)).pipe(new l("compressedSize")).withStreamInfo("compression",g)},w.exports=p},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,w,d){var a=s("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},d.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,w,d){var a=s("./utils"),i=function(){for(var e,l=[],p=0;p<256;p++){e=p;for(var y=0;y<8;y++)e=1&e?3988292384^e>>>1:e>>>1;l[p]=e}return l}();w.exports=function(e,l){return e!==void 0&&e.length?a.getTypeOf(e)!=="string"?function(p,y,g,b){var r=i,f=b+g;p^=-1;for(var o=b;o<f;o++)p=p>>>8^r[255&(p^y[o])];return-1^p}(0|l,e,e.length,0):function(p,y,g,b){var r=i,f=b+g;p^=-1;for(var o=b;o<f;o++)p=p>>>8^r[255&(p^y.charCodeAt(o))];return-1^p}(0|l,e,e.length,0):0}},{"./utils":32}],5:[function(s,w,d){d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(s,w,d){var a=null;a=typeof Promise<"u"?Promise:s("lie"),w.exports={Promise:a}},{lie:37}],7:[function(s,w,d){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=s("pako"),e=s("./utils"),l=s("./stream/GenericWorker"),p=a?"uint8array":"array";function y(g,b){l.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=b,this.meta={}}d.magic="\b\0",e.inherits(y,l),y.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(e.transformTo(p,g.data),!1)},y.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(b){g.push({data:b,meta:g.meta})}},d.compressWorker=function(g){return new y("Deflate",g)},d.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,w,d){function a(r,f){var o,u="";for(o=0;o<f;o++)u+=String.fromCharCode(255&r),r>>>=8;return u}function i(r,f,o,u,c,_){var k,I,E=r.file,D=r.compression,L=_!==p.utf8encode,j=e.transformTo("string",_(E.name)),R=e.transformTo("string",p.utf8encode(E.name)),Z=E.comment,V=e.transformTo("string",_(Z)),v=e.transformTo("string",p.utf8encode(Z)),T=R.length!==E.name.length,n=v.length!==Z.length,P="",Q="",M="",tt=E.dir,G=E.date,J={crc32:0,compressedSize:0,uncompressedSize:0};f&&!o||(J.crc32=r.crc32,J.compressedSize=r.compressedSize,J.uncompressedSize=r.uncompressedSize);var B=0;f&&(B|=8),L||!T&&!n||(B|=2048);var A=0,X=0;tt&&(A|=16),c==="UNIX"?(X=798,A|=function($,at){var pt=$;return $||(pt=at?16893:33204),(65535&pt)<<16}(E.unixPermissions,tt)):(X=20,A|=function($){return 63&($||0)}(E.dosPermissions)),k=G.getUTCHours(),k<<=6,k|=G.getUTCMinutes(),k<<=5,k|=G.getUTCSeconds()/2,I=G.getUTCFullYear()-1980,I<<=4,I|=G.getUTCMonth()+1,I<<=5,I|=G.getUTCDate(),T&&(Q=a(1,1)+a(y(j),4)+R,P+="up"+a(Q.length,2)+Q),n&&(M=a(1,1)+a(y(V),4)+v,P+="uc"+a(M.length,2)+M);var q="";return q+=`
\0`,q+=a(B,2),q+=D.magic,q+=a(k,2),q+=a(I,2),q+=a(J.crc32,4),q+=a(J.compressedSize,4),q+=a(J.uncompressedSize,4),q+=a(j.length,2),q+=a(P.length,2),{fileRecord:g.LOCAL_FILE_HEADER+q+j+P,dirRecord:g.CENTRAL_FILE_HEADER+a(X,2)+q+a(V.length,2)+"\0\0\0\0"+a(A,4)+a(u,4)+j+P+V}}var e=s("../utils"),l=s("../stream/GenericWorker"),p=s("../utf8"),y=s("../crc32"),g=s("../signature");function b(r,f,o,u){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=f,this.zipPlatform=o,this.encodeFileName=u,this.streamFiles=r,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}e.inherits(b,l),b.prototype.push=function(r){var f=r.meta.percent||0,o=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(r):(this.bytesWritten+=r.data.length,l.prototype.push.call(this,{data:r.data,meta:{currentFile:this.currentFile,percent:o?(f+100*(o-u-1))/o:100}}))},b.prototype.openedSource=function(r){this.currentSourceOffset=this.bytesWritten,this.currentFile=r.file.name;var f=this.streamFiles&&!r.file.dir;if(f){var o=i(r,f,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:o.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(r){this.accumulate=!1;var f=this.streamFiles&&!r.file.dir,o=i(r,f,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(o.dirRecord),f)this.push({data:function(u){return g.DATA_DESCRIPTOR+a(u.crc32,4)+a(u.compressedSize,4)+a(u.uncompressedSize,4)}(r),meta:{percent:100}});else for(this.push({data:o.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var r=this.bytesWritten,f=0;f<this.dirRecords.length;f++)this.push({data:this.dirRecords[f],meta:{percent:100}});var o=this.bytesWritten-r,u=function(c,_,k,I,E){var D=e.transformTo("string",E(I));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(c,2)+a(c,2)+a(_,4)+a(k,4)+a(D.length,2)+D}(this.dirRecords.length,o,r,this.zipComment,this.encodeFileName);this.push({data:u,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(r){this._sources.push(r);var f=this;return r.on("data",function(o){f.processChunk(o)}),r.on("end",function(){f.closedSource(f.previous.streamInfo),f._sources.length?f.prepareNextSource():f.end()}),r.on("error",function(o){f.error(o)}),this},b.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(r){var f=this._sources;if(!l.prototype.error.call(this,r))return!1;for(var o=0;o<f.length;o++)try{f[o].error(r)}catch{}return!0},b.prototype.lock=function(){l.prototype.lock.call(this);for(var r=this._sources,f=0;f<r.length;f++)r[f].lock()},w.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,w,d){var a=s("../compressions"),i=s("./ZipFileWorker");d.generateWorker=function(e,l,p){var y=new i(l.streamFiles,p,l.platform,l.encodeFileName),g=0;try{e.forEach(function(b,r){g++;var f=function(_,k){var I=_||k,E=a[I];if(!E)throw new Error(I+" is not a valid compression method !");return E}(r.options.compression,l.compression),o=r.options.compressionOptions||l.compressionOptions||{},u=r.dir,c=r.date;r._compressWorker(f,o).withStreamInfo("file",{name:b,dir:u,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(y)}),y.entriesCount=g}catch(b){y.error(b)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,w,d){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new a;for(var e in this)typeof this[e]!="function"&&(i[e]=this[e]);return i}}(a.prototype=s("./object")).loadAsync=s("./load"),a.support=s("./support"),a.defaults=s("./defaults"),a.version="3.10.1",a.loadAsync=function(i,e){return new a().loadAsync(i,e)},a.external=s("./external"),w.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,w,d){var a=s("./utils"),i=s("./external"),e=s("./utf8"),l=s("./zipEntries"),p=s("./stream/Crc32Probe"),y=s("./nodejsUtils");function g(b){return new i.Promise(function(r,f){var o=b.decompressed.getContentWorker().pipe(new p);o.on("error",function(u){f(u)}).on("end",function(){o.streamInfo.crc32!==b.decompressed.crc32?f(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}w.exports=function(b,r){var f=this;return r=a.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:e.utf8decode}),y.isNode&&y.isStream(b)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",b,!0,r.optimizedBinaryString,r.base64).then(function(o){var u=new l(r);return u.load(o),u}).then(function(o){var u=[i.Promise.resolve(o)],c=o.files;if(r.checkCRC32)for(var _=0;_<c.length;_++)u.push(g(c[_]));return i.Promise.all(u)}).then(function(o){for(var u=o.shift(),c=u.files,_=0;_<c.length;_++){var k=c[_],I=k.fileNameStr,E=a.resolve(k.fileNameStr);f.file(E,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:r.createFolders}),k.dir||(f.file(E).unsafeOriginalName=I)}return u.zipComment.length&&(f.comment=u.zipComment),f})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,w,d){var a=s("../utils"),i=s("../stream/GenericWorker");function e(l,p){i.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(p)}a.inherits(e,i),e.prototype._bindStream=function(l){var p=this;(this._stream=l).pause(),l.on("data",function(y){p.push({data:y,meta:{percent:0}})}).on("error",function(y){p.isPaused?this.generatedError=y:p.error(y)}).on("end",function(){p.isPaused?p._upstreamEnded=!0:p.end()})},e.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},e.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},w.exports=e},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,w,d){var a=s("readable-stream").Readable;function i(e,l,p){a.call(this,l),this._helper=e;var y=this;e.on("data",function(g,b){y.push(g)||y._helper.pause(),p&&p(b)}).on("error",function(g){y.emit("error",g)}).on("end",function(){y.push(null)})}s("../utils").inherits(i,a),i.prototype._read=function(){this._helper.resume()},w.exports=i},{"../utils":32,"readable-stream":16}],14:[function(s,w,d){w.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,i);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,i)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var i=new Buffer(a);return i.fill(0),i},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(s,w,d){function a(E,D,L){var j,R=e.getTypeOf(D),Z=e.extend(L||{},y);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(E=c(E)),Z.createFolders&&(j=u(E))&&_.call(this,j,!0);var V=R==="string"&&Z.binary===!1&&Z.base64===!1;L&&L.binary!==void 0||(Z.binary=!V),(D instanceof g&&D.uncompressedSize===0||Z.dir||!D||D.length===0)&&(Z.base64=!1,Z.binary=!0,D="",Z.compression="STORE",R="string");var v=null;v=D instanceof g||D instanceof l?D:f.isNode&&f.isStream(D)?new o(E,D):e.prepareContent(E,D,Z.binary,Z.optimizedBinaryString,Z.base64);var T=new b(E,v,Z);this.files[E]=T}var i=s("./utf8"),e=s("./utils"),l=s("./stream/GenericWorker"),p=s("./stream/StreamHelper"),y=s("./defaults"),g=s("./compressedObject"),b=s("./zipObject"),r=s("./generate"),f=s("./nodejsUtils"),o=s("./nodejs/NodejsStreamInputAdapter"),u=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var D=E.lastIndexOf("/");return 0<D?E.substring(0,D):""},c=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},_=function(E,D){return D=D!==void 0?D:y.createFolders,E=c(E),this.files[E]||a.call(this,E,null,{dir:!0,createFolders:D}),this.files[E]};function k(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var I={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var D,L,j;for(D in this.files)j=this.files[D],(L=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&E(L,j)},filter:function(E){var D=[];return this.forEach(function(L,j){E(L,j)&&D.push(j)}),D},file:function(E,D,L){if(arguments.length!==1)return E=this.root+E,a.call(this,E,D,L),this;if(k(E)){var j=E;return this.filter(function(Z,V){return!V.dir&&j.test(Z)})}var R=this.files[this.root+E];return R&&!R.dir?R:null},folder:function(E){if(!E)return this;if(k(E))return this.filter(function(R,Z){return Z.dir&&E.test(R)});var D=this.root+E,L=_.call(this,D),j=this.clone();return j.root=L.name,j},remove:function(E){E=this.root+E;var D=this.files[E];if(D||(E.slice(-1)!=="/"&&(E+="/"),D=this.files[E]),D&&!D.dir)delete this.files[E];else for(var L=this.filter(function(R,Z){return Z.name.slice(0,E.length)===E}),j=0;j<L.length;j++)delete this.files[L[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var D,L={};try{if((L=e.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=L.type.toLowerCase(),L.compression=L.compression.toUpperCase(),L.type==="binarystring"&&(L.type="string"),!L.type)throw new Error("No output type specified.");e.checkSupport(L.type),L.platform!=="darwin"&&L.platform!=="freebsd"&&L.platform!=="linux"&&L.platform!=="sunos"||(L.platform="UNIX"),L.platform==="win32"&&(L.platform="DOS");var j=L.comment||this.comment||"";D=r.generateWorker(this,L,j)}catch(R){(D=new l("error")).error(R)}return new p(D,L.type||"string",L.mimeType)},generateAsync:function(E,D){return this.generateInternalStream(E).accumulate(D)},generateNodeStream:function(E,D){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(D)}};w.exports=I},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,w,d){w.exports=s("stream")},{stream:void 0}],17:[function(s,w,d){var a=s("./DataReader");function i(e){a.call(this,e);for(var l=0;l<this.data.length;l++)e[l]=255&e[l]}s("../utils").inherits(i,a),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var l=e.charCodeAt(0),p=e.charCodeAt(1),y=e.charCodeAt(2),g=e.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===l&&this.data[b+1]===p&&this.data[b+2]===y&&this.data[b+3]===g)return b-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var l=e.charCodeAt(0),p=e.charCodeAt(1),y=e.charCodeAt(2),g=e.charCodeAt(3),b=this.readData(4);return l===b[0]&&p===b[1]&&y===b[2]&&g===b[3]},i.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,l},w.exports=i},{"../utils":32,"./DataReader":18}],18:[function(s,w,d){var a=s("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var l,p=0;for(this.checkOffset(e),l=this.index+e-1;l>=this.index;l--)p=(p<<8)+this.byteAt(l);return this.index+=e,p},readString:function(e){return a.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},w.exports=i},{"../utils":32}],19:[function(s,w,d){var a=s("./Uint8ArrayReader");function i(e){a.call(this,e)}s("../utils").inherits(i,a),i.prototype.readData=function(e){this.checkOffset(e);var l=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,l},w.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,w,d){var a=s("./DataReader");function i(e){a.call(this,e)}s("../utils").inherits(i,a),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var l=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,l},w.exports=i},{"../utils":32,"./DataReader":18}],21:[function(s,w,d){var a=s("./ArrayReader");function i(e){a.call(this,e)}s("../utils").inherits(i,a),i.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,l},w.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(s,w,d){var a=s("../utils"),i=s("../support"),e=s("./ArrayReader"),l=s("./StringReader"),p=s("./NodeBufferReader"),y=s("./Uint8ArrayReader");w.exports=function(g){var b=a.getTypeOf(g);return a.checkSupport(b),b!=="string"||i.uint8array?b==="nodebuffer"?new p(g):i.uint8array?new y(a.transformTo("uint8array",g)):new e(a.transformTo("array",g)):new l(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,w,d){d.LOCAL_FILE_HEADER="PK",d.CENTRAL_FILE_HEADER="PK",d.CENTRAL_DIRECTORY_END="PK",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,w,d){var a=s("./GenericWorker"),i=s("../utils");function e(l){a.call(this,"ConvertWorker to "+l),this.destType=l}i.inherits(e,a),e.prototype.processChunk=function(l){this.push({data:i.transformTo(this.destType,l.data),meta:l.meta})},w.exports=e},{"../utils":32,"./GenericWorker":28}],25:[function(s,w,d){var a=s("./GenericWorker"),i=s("../crc32");function e(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(e,a),e.prototype.processChunk=function(l){this.streamInfo.crc32=i(l.data,this.streamInfo.crc32||0),this.push(l)},w.exports=e},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,w,d){var a=s("../utils"),i=s("./GenericWorker");function e(l){i.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}a.inherits(e,i),e.prototype.processChunk=function(l){if(l){var p=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=p+l.data.length}i.prototype.processChunk.call(this,l)},w.exports=e},{"../utils":32,"./GenericWorker":28}],27:[function(s,w,d){var a=s("../utils"),i=s("./GenericWorker");function e(l){i.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(y){p.dataIsReady=!0,p.data=y,p.max=y&&y.length||0,p.type=a.getTypeOf(y),p.isPaused||p._tickAndRepeat()},function(y){p.error(y)})}a.inherits(e,i),e.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},e.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},e.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},e.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,p=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,p);break;case"uint8array":l=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":l=this.data.slice(this.index,p)}return this.index=p,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},w.exports=e},{"../utils":32,"./GenericWorker":28}],28:[function(s,w,d){function a(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,e){return this._listeners[i].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,e){if(this._listeners[i])for(var l=0;l<this._listeners[i].length;l++)this._listeners[i][l].call(this,e)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var e=this;return i.on("data",function(l){e.processChunk(l)}),i.on("end",function(){e.end()}),i.on("error",function(l){e.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,e){return this.extraStreamInfo[i]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},w.exports=a},{}],29:[function(s,w,d){var a=s("../utils"),i=s("./ConvertWorker"),e=s("./GenericWorker"),l=s("../base64"),p=s("../support"),y=s("../external"),g=null;if(p.nodestream)try{g=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(f,o){return new y.Promise(function(u,c){var _=[],k=f._internalType,I=f._outputType,E=f._mimeType;f.on("data",function(D,L){_.push(D),o&&o(L)}).on("error",function(D){_=[],c(D)}).on("end",function(){try{var D=function(L,j,R){switch(L){case"blob":return a.newBlob(a.transformTo("arraybuffer",j),R);case"base64":return l.encode(j);default:return a.transformTo(L,j)}}(I,function(L,j){var R,Z=0,V=null,v=0;for(R=0;R<j.length;R++)v+=j[R].length;switch(L){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(V=new Uint8Array(v),R=0;R<j.length;R++)V.set(j[R],Z),Z+=j[R].length;return V;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+L+"'")}}(k,_),E);u(D)}catch(L){c(L)}_=[]}).resume()})}function r(f,o,u){var c=o;switch(o){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=o,this._mimeType=u,a.checkSupport(c),this._worker=f.pipe(new i(c)),f.lock()}catch(_){this._worker=new e("error"),this._worker.error(_)}}r.prototype={accumulate:function(f){return b(this,f)},on:function(f,o){var u=this;return f==="data"?this._worker.on(f,function(c){o.call(u,c.data,c.meta)}):this._worker.on(f,function(){a.delay(o,arguments,u)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(f){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},f)}},w.exports=r},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,w,d){if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",d.nodebuffer=typeof Buffer<"u",d.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")d.blob=!1;else{var a=new ArrayBuffer(0);try{d.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(a),d.blob=i.getBlob("application/zip").size===0}catch{d.blob=!1}}}try{d.nodestream=!!s("readable-stream").Readable}catch{d.nodestream=!1}},{"readable-stream":16}],31:[function(s,w,d){for(var a=s("./utils"),i=s("./support"),e=s("./nodejsUtils"),l=s("./stream/GenericWorker"),p=new Array(256),y=0;y<256;y++)p[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;p[254]=p[254]=1;function g(){l.call(this,"utf-8 decode"),this.leftOver=null}function b(){l.call(this,"utf-8 encode")}d.utf8encode=function(r){return i.nodebuffer?e.newBufferFrom(r,"utf-8"):function(f){var o,u,c,_,k,I=f.length,E=0;for(_=0;_<I;_++)(64512&(u=f.charCodeAt(_)))==55296&&_+1<I&&(64512&(c=f.charCodeAt(_+1)))==56320&&(u=65536+(u-55296<<10)+(c-56320),_++),E+=u<128?1:u<2048?2:u<65536?3:4;for(o=i.uint8array?new Uint8Array(E):new Array(E),_=k=0;k<E;_++)(64512&(u=f.charCodeAt(_)))==55296&&_+1<I&&(64512&(c=f.charCodeAt(_+1)))==56320&&(u=65536+(u-55296<<10)+(c-56320),_++),u<128?o[k++]=u:(u<2048?o[k++]=192|u>>>6:(u<65536?o[k++]=224|u>>>12:(o[k++]=240|u>>>18,o[k++]=128|u>>>12&63),o[k++]=128|u>>>6&63),o[k++]=128|63&u);return o}(r)},d.utf8decode=function(r){return i.nodebuffer?a.transformTo("nodebuffer",r).toString("utf-8"):function(f){var o,u,c,_,k=f.length,I=new Array(2*k);for(o=u=0;o<k;)if((c=f[o++])<128)I[u++]=c;else if(4<(_=p[c]))I[u++]=65533,o+=_-1;else{for(c&=_===2?31:_===3?15:7;1<_&&o<k;)c=c<<6|63&f[o++],_--;1<_?I[u++]=65533:c<65536?I[u++]=c:(c-=65536,I[u++]=55296|c>>10&1023,I[u++]=56320|1023&c)}return I.length!==u&&(I.subarray?I=I.subarray(0,u):I.length=u),a.applyFromCharCode(I)}(r=a.transformTo(i.uint8array?"uint8array":"array",r))},a.inherits(g,l),g.prototype.processChunk=function(r){var f=a.transformTo(i.uint8array?"uint8array":"array",r.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=f;(f=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),f.set(o,this.leftOver.length)}else f=this.leftOver.concat(f);this.leftOver=null}var u=function(_,k){var I;for((k=k||_.length)>_.length&&(k=_.length),I=k-1;0<=I&&(192&_[I])==128;)I--;return I<0||I===0?k:I+p[_[I]]>k?I:k}(f),c=f;u!==f.length&&(i.uint8array?(c=f.subarray(0,u),this.leftOver=f.subarray(u,f.length)):(c=f.slice(0,u),this.leftOver=f.slice(u,f.length))),this.push({data:d.utf8decode(c),meta:r.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=g,a.inherits(b,l),b.prototype.processChunk=function(r){this.push({data:d.utf8encode(r.data),meta:r.meta})},d.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,w,d){var a=s("./support"),i=s("./base64"),e=s("./nodejsUtils"),l=s("./external");function p(o){return o}function y(o,u){for(var c=0;c<o.length;++c)u[c]=255&o.charCodeAt(c);return u}s("setimmediate"),d.newBlob=function(o,u){d.checkSupport("blob");try{return new Blob([o],{type:u})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(o),c.getBlob(u)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(o,u,c){var _=[],k=0,I=o.length;if(I<=c)return String.fromCharCode.apply(null,o);for(;k<I;)u==="array"||u==="nodebuffer"?_.push(String.fromCharCode.apply(null,o.slice(k,Math.min(k+c,I)))):_.push(String.fromCharCode.apply(null,o.subarray(k,Math.min(k+c,I)))),k+=c;return _.join("")},stringifyByChar:function(o){for(var u="",c=0;c<o.length;c++)u+=String.fromCharCode(o[c]);return u},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,e.allocBuffer(1)).length===1}catch{return!1}}()}};function b(o){var u=65536,c=d.getTypeOf(o),_=!0;if(c==="uint8array"?_=g.applyCanBeUsed.uint8array:c==="nodebuffer"&&(_=g.applyCanBeUsed.nodebuffer),_)for(;1<u;)try{return g.stringifyByChunk(o,c,u)}catch{u=Math.floor(u/2)}return g.stringifyByChar(o)}function r(o,u){for(var c=0;c<o.length;c++)u[c]=o[c];return u}d.applyFromCharCode=b;var f={};f.string={string:p,array:function(o){return y(o,new Array(o.length))},arraybuffer:function(o){return f.string.uint8array(o).buffer},uint8array:function(o){return y(o,new Uint8Array(o.length))},nodebuffer:function(o){return y(o,e.allocBuffer(o.length))}},f.array={string:b,array:p,arraybuffer:function(o){return new Uint8Array(o).buffer},uint8array:function(o){return new Uint8Array(o)},nodebuffer:function(o){return e.newBufferFrom(o)}},f.arraybuffer={string:function(o){return b(new Uint8Array(o))},array:function(o){return r(new Uint8Array(o),new Array(o.byteLength))},arraybuffer:p,uint8array:function(o){return new Uint8Array(o)},nodebuffer:function(o){return e.newBufferFrom(new Uint8Array(o))}},f.uint8array={string:b,array:function(o){return r(o,new Array(o.length))},arraybuffer:function(o){return o.buffer},uint8array:p,nodebuffer:function(o){return e.newBufferFrom(o)}},f.nodebuffer={string:b,array:function(o){return r(o,new Array(o.length))},arraybuffer:function(o){return f.nodebuffer.uint8array(o).buffer},uint8array:function(o){return r(o,new Uint8Array(o.length))},nodebuffer:p},d.transformTo=function(o,u){if(u=u||"",!o)return u;d.checkSupport(o);var c=d.getTypeOf(u);return f[c][o](u)},d.resolve=function(o){for(var u=o.split("/"),c=[],_=0;_<u.length;_++){var k=u[_];k==="."||k===""&&_!==0&&_!==u.length-1||(k===".."?c.pop():c.push(k))}return c.join("/")},d.getTypeOf=function(o){return typeof o=="string"?"string":Object.prototype.toString.call(o)==="[object Array]"?"array":a.nodebuffer&&e.isBuffer(o)?"nodebuffer":a.uint8array&&o instanceof Uint8Array?"uint8array":a.arraybuffer&&o instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(o){if(!a[o.toLowerCase()])throw new Error(o+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(o){var u,c,_="";for(c=0;c<(o||"").length;c++)_+="\\x"+((u=o.charCodeAt(c))<16?"0":"")+u.toString(16).toUpperCase();return _},d.delay=function(o,u,c){setImmediate(function(){o.apply(c||null,u||[])})},d.inherits=function(o,u){function c(){}c.prototype=u.prototype,o.prototype=new c},d.extend=function(){var o,u,c={};for(o=0;o<arguments.length;o++)for(u in arguments[o])Object.prototype.hasOwnProperty.call(arguments[o],u)&&c[u]===void 0&&(c[u]=arguments[o][u]);return c},d.prepareContent=function(o,u,c,_,k){return l.Promise.resolve(u).then(function(I){return a.blob&&(I instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(I))!==-1)&&typeof FileReader<"u"?new l.Promise(function(E,D){var L=new FileReader;L.onload=function(j){E(j.target.result)},L.onerror=function(j){D(j.target.error)},L.readAsArrayBuffer(I)}):I}).then(function(I){var E=d.getTypeOf(I);return E?(E==="arraybuffer"?I=d.transformTo("uint8array",I):E==="string"&&(k?I=i.decode(I):c&&_!==!0&&(I=function(D){return y(D,a.uint8array?new Uint8Array(D.length):new Array(D.length))}(I))),I):l.Promise.reject(new Error("Can't read the data of '"+o+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,w,d){var a=s("./reader/readerFor"),i=s("./utils"),e=s("./signature"),l=s("./zipEntry"),p=s("./support");function y(g){this.files=[],this.loadOptions=g}y.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(b)+", expected "+i.pretty(g)+")")}},isSignature:function(g,b){var r=this.reader.index;this.reader.setIndex(g);var f=this.reader.readString(4)===b;return this.reader.setIndex(r),f},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),b=p.uint8array?"uint8array":"array",r=i.transformTo(b,g);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,b,r,f=this.zip64EndOfCentralSize-44;0<f;)g=this.reader.readInt(2),b=this.reader.readInt(4),r=this.reader.readData(b),this.zip64ExtensibleData[g]={id:g,length:b,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,b;for(g=0;g<this.files.length;g++)b=this.files[g],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(e.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(g=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var b=g;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var f=b-r;if(0<f)this.isSignature(b,e.CENTRAL_FILE_HEADER)||(this.reader.zero=f);else if(f<0)throw new Error("Corrupted zip: missing "+Math.abs(f)+" bytes.")},prepareReader:function(g){this.reader=a(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},w.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,w,d){var a=s("./reader/readerFor"),i=s("./utils"),e=s("./compressedObject"),l=s("./crc32"),p=s("./utf8"),y=s("./compressions"),g=s("./support");function b(r,f){this.options=r,this.loadOptions=f}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(r){var f,o;if(r.skip(22),this.fileNameLength=r.readInt(2),o=r.readInt(2),this.fileName=r.readData(this.fileNameLength),r.skip(o),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((f=function(u){for(var c in y)if(Object.prototype.hasOwnProperty.call(y,c)&&y[c].magic===u)return y[c];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new e(this.compressedSize,this.uncompressedSize,this.crc32,f,r.readData(this.compressedSize))},readCentralPart:function(r){this.versionMadeBy=r.readInt(2),r.skip(2),this.bitFlag=r.readInt(2),this.compressionMethod=r.readString(2),this.date=r.readDate(),this.crc32=r.readInt(4),this.compressedSize=r.readInt(4),this.uncompressedSize=r.readInt(4);var f=r.readInt(2);if(this.extraFieldsLength=r.readInt(2),this.fileCommentLength=r.readInt(2),this.diskNumberStart=r.readInt(2),this.internalFileAttributes=r.readInt(2),this.externalFileAttributes=r.readInt(4),this.localHeaderOffset=r.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");r.skip(f),this.readExtraFields(r),this.parseZIP64ExtraField(r),this.fileComment=r.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var r=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),r==0&&(this.dosPermissions=63&this.externalFileAttributes),r==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var r=a(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(r){var f,o,u,c=r.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});r.index+4<c;)f=r.readInt(2),o=r.readInt(2),u=r.readData(o),this.extraFields[f]={id:f,length:o,value:u};r.setIndex(c)},handleUTF8:function(){var r=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=p.utf8decode(this.fileName),this.fileCommentStr=p.utf8decode(this.fileComment);else{var f=this.findExtraFieldUnicodePath();if(f!==null)this.fileNameStr=f;else{var o=i.transformTo(r,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(o)}var u=this.findExtraFieldUnicodeComment();if(u!==null)this.fileCommentStr=u;else{var c=i.transformTo(r,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var r=this.extraFields[28789];if(r){var f=a(r.value);return f.readInt(1)!==1||l(this.fileName)!==f.readInt(4)?null:p.utf8decode(f.readData(r.length-5))}return null},findExtraFieldUnicodeComment:function(){var r=this.extraFields[25461];if(r){var f=a(r.value);return f.readInt(1)!==1||l(this.fileComment)!==f.readInt(4)?null:p.utf8decode(f.readData(r.length-5))}return null}},w.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,w,d){function a(f,o,u){this.name=f,this.dir=u.dir,this.date=u.date,this.comment=u.comment,this.unixPermissions=u.unixPermissions,this.dosPermissions=u.dosPermissions,this._data=o,this._dataBinary=u.binary,this.options={compression:u.compression,compressionOptions:u.compressionOptions}}var i=s("./stream/StreamHelper"),e=s("./stream/DataWorker"),l=s("./utf8"),p=s("./compressedObject"),y=s("./stream/GenericWorker");a.prototype={internalStream:function(f){var o=null,u="string";try{if(!f)throw new Error("No output type specified.");var c=(u=f.toLowerCase())==="string"||u==="text";u!=="binarystring"&&u!=="text"||(u="string"),o=this._decompressWorker();var _=!this._dataBinary;_&&!c&&(o=o.pipe(new l.Utf8EncodeWorker)),!_&&c&&(o=o.pipe(new l.Utf8DecodeWorker))}catch(k){(o=new y("error")).error(k)}return new i(o,u,"")},async:function(f,o){return this.internalStream(f).accumulate(o)},nodeStream:function(f,o){return this.internalStream(f||"nodebuffer").toNodejsStream(o)},_compressWorker:function(f,o){if(this._data instanceof p&&this._data.compression.magic===f.magic)return this._data.getCompressedWorker();var u=this._decompressWorker();return this._dataBinary||(u=u.pipe(new l.Utf8EncodeWorker)),p.createWorkerFrom(u,f,o)},_decompressWorker:function(){return this._data instanceof p?this._data.getContentWorker():this._data instanceof y?this._data:new e(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},r=0;r<g.length;r++)a.prototype[g[r]]=b;w.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,w,d){(function(a){var i,e,l=a.MutationObserver||a.WebKitMutationObserver;if(l){var p=0,y=new l(f),g=a.document.createTextNode("");y.observe(g,{characterData:!0}),i=function(){g.data=p=++p%2}}else if(a.setImmediate||a.MessageChannel===void 0)i="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var o=a.document.createElement("script");o.onreadystatechange=function(){f(),o.onreadystatechange=null,o.parentNode.removeChild(o),o=null},a.document.documentElement.appendChild(o)}:function(){setTimeout(f,0)};else{var b=new a.MessageChannel;b.port1.onmessage=f,i=function(){b.port2.postMessage(0)}}var r=[];function f(){var o,u;e=!0;for(var c=r.length;c;){for(u=r,r=[],o=-1;++o<c;)u[o]();c=r.length}e=!1}w.exports=function(o){r.push(o)!==1||e||i()}}).call(this,typeof qt<"u"?qt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,w,d){var a=s("immediate");function i(){}var e={},l=["REJECTED"],p=["FULFILLED"],y=["PENDING"];function g(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,c!==i&&o(this,c)}function b(c,_,k){this.promise=c,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function r(c,_,k){a(function(){var I;try{I=_(k)}catch(E){return e.reject(c,E)}I===c?e.reject(c,new TypeError("Cannot resolve promise with itself")):e.resolve(c,I)})}function f(c){var _=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof _=="function")return function(){_.apply(c,arguments)}}function o(c,_){var k=!1;function I(L){k||(k=!0,e.reject(c,L))}function E(L){k||(k=!0,e.resolve(c,L))}var D=u(function(){_(E,I)});D.status==="error"&&I(D.value)}function u(c,_){var k={};try{k.value=c(_),k.status="success"}catch(I){k.status="error",k.value=I}return k}(w.exports=g).prototype.finally=function(c){if(typeof c!="function")return this;var _=this.constructor;return this.then(function(k){return _.resolve(c()).then(function(){return k})},function(k){return _.resolve(c()).then(function(){throw k})})},g.prototype.catch=function(c){return this.then(null,c)},g.prototype.then=function(c,_){if(typeof c!="function"&&this.state===p||typeof _!="function"&&this.state===l)return this;var k=new this.constructor(i);return this.state!==y?r(k,this.state===p?c:_,this.outcome):this.queue.push(new b(k,c,_)),k},b.prototype.callFulfilled=function(c){e.resolve(this.promise,c)},b.prototype.otherCallFulfilled=function(c){r(this.promise,this.onFulfilled,c)},b.prototype.callRejected=function(c){e.reject(this.promise,c)},b.prototype.otherCallRejected=function(c){r(this.promise,this.onRejected,c)},e.resolve=function(c,_){var k=u(f,_);if(k.status==="error")return e.reject(c,k.value);var I=k.value;if(I)o(c,I);else{c.state=p,c.outcome=_;for(var E=-1,D=c.queue.length;++E<D;)c.queue[E].callFulfilled(_)}return c},e.reject=function(c,_){c.state=l,c.outcome=_;for(var k=-1,I=c.queue.length;++k<I;)c.queue[k].callRejected(_);return c},g.resolve=function(c){return c instanceof this?c:e.resolve(new this(i),c)},g.reject=function(c){var _=new this(i);return e.reject(_,c)},g.all=function(c){var _=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=c.length,I=!1;if(!k)return this.resolve([]);for(var E=new Array(k),D=0,L=-1,j=new this(i);++L<k;)R(c[L],L);return j;function R(Z,V){_.resolve(Z).then(function(v){E[V]=v,++D!==k||I||(I=!0,e.resolve(j,E))},function(v){I||(I=!0,e.reject(j,v))})}},g.race=function(c){var _=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=c.length,I=!1;if(!k)return this.resolve([]);for(var E=-1,D=new this(i);++E<k;)L=c[E],_.resolve(L).then(function(j){I||(I=!0,e.resolve(D,j))},function(j){I||(I=!0,e.reject(D,j))});var L;return D}},{immediate:36}],38:[function(s,w,d){var a={};(0,s("./lib/utils/common").assign)(a,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),w.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,w,d){var a=s("./zlib/deflate"),i=s("./utils/common"),e=s("./utils/strings"),l=s("./zlib/messages"),p=s("./zlib/zstream"),y=Object.prototype.toString,g=0,b=-1,r=0,f=8;function o(c){if(!(this instanceof o))return new o(c);this.options=i.assign({level:b,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:r,to:""},c||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var k=a.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(k!==g)throw new Error(l[k]);if(_.header&&a.deflateSetHeader(this.strm,_.header),_.dictionary){var I;if(I=typeof _.dictionary=="string"?e.string2buf(_.dictionary):y.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(k=a.deflateSetDictionary(this.strm,I))!==g)throw new Error(l[k]);this._dict_set=!0}}function u(c,_){var k=new o(_);if(k.push(c,!0),k.err)throw k.msg||l[k.err];return k.result}o.prototype.push=function(c,_){var k,I,E=this.strm,D=this.options.chunkSize;if(this.ended)return!1;I=_===~~_?_:_===!0?4:0,typeof c=="string"?E.input=e.string2buf(c):y.call(c)==="[object ArrayBuffer]"?E.input=new Uint8Array(c):E.input=c,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new i.Buf8(D),E.next_out=0,E.avail_out=D),(k=a.deflate(E,I))!==1&&k!==g)return this.onEnd(k),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||I!==4&&I!==2)||(this.options.to==="string"?this.onData(e.buf2binstring(i.shrinkBuf(E.output,E.next_out))):this.onData(i.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&k!==1);return I===4?(k=a.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===g):I!==2||(this.onEnd(g),!(E.avail_out=0))},o.prototype.onData=function(c){this.chunks.push(c)},o.prototype.onEnd=function(c){c===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},d.Deflate=o,d.deflate=u,d.deflateRaw=function(c,_){return(_=_||{}).raw=!0,u(c,_)},d.gzip=function(c,_){return(_=_||{}).gzip=!0,u(c,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,w,d){var a=s("./zlib/inflate"),i=s("./utils/common"),e=s("./utils/strings"),l=s("./zlib/constants"),p=s("./zlib/messages"),y=s("./zlib/zstream"),g=s("./zlib/gzheader"),b=Object.prototype.toString;function r(o){if(!(this instanceof r))return new r(o);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},o||{});var u=this.options;u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(0<=u.windowBits&&u.windowBits<16)||o&&o.windowBits||(u.windowBits+=32),15<u.windowBits&&u.windowBits<48&&!(15&u.windowBits)&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var c=a.inflateInit2(this.strm,u.windowBits);if(c!==l.Z_OK)throw new Error(p[c]);this.header=new g,a.inflateGetHeader(this.strm,this.header)}function f(o,u){var c=new r(u);if(c.push(o,!0),c.err)throw c.msg||p[c.err];return c.result}r.prototype.push=function(o,u){var c,_,k,I,E,D,L=this.strm,j=this.options.chunkSize,R=this.options.dictionary,Z=!1;if(this.ended)return!1;_=u===~~u?u:u===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof o=="string"?L.input=e.binstring2buf(o):b.call(o)==="[object ArrayBuffer]"?L.input=new Uint8Array(o):L.input=o,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new i.Buf8(j),L.next_out=0,L.avail_out=j),(c=a.inflate(L,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&R&&(D=typeof R=="string"?e.string2buf(R):b.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,c=a.inflateSetDictionary(this.strm,D)),c===l.Z_BUF_ERROR&&Z===!0&&(c=l.Z_OK,Z=!1),c!==l.Z_STREAM_END&&c!==l.Z_OK)return this.onEnd(c),!(this.ended=!0);L.next_out&&(L.avail_out!==0&&c!==l.Z_STREAM_END&&(L.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=e.utf8border(L.output,L.next_out),I=L.next_out-k,E=e.buf2string(L.output,k),L.next_out=I,L.avail_out=j-I,I&&i.arraySet(L.output,L.output,k,I,0),this.onData(E)):this.onData(i.shrinkBuf(L.output,L.next_out)))),L.avail_in===0&&L.avail_out===0&&(Z=!0)}while((0<L.avail_in||L.avail_out===0)&&c!==l.Z_STREAM_END);return c===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(c=a.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(L.avail_out=0))},r.prototype.onData=function(o){this.chunks.push(o)},r.prototype.onEnd=function(o){o===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg},d.Inflate=r,d.inflate=f,d.inflateRaw=function(o,u){return(u=u||{}).raw=!0,f(o,u)},d.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,w,d){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(l){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var y=p.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var g in y)y.hasOwnProperty(g)&&(l[g]=y[g])}}return l},d.shrinkBuf=function(l,p){return l.length===p?l:l.subarray?l.subarray(0,p):(l.length=p,l)};var i={arraySet:function(l,p,y,g,b){if(p.subarray&&l.subarray)l.set(p.subarray(y,y+g),b);else for(var r=0;r<g;r++)l[b+r]=p[y+r]},flattenChunks:function(l){var p,y,g,b,r,f;for(p=g=0,y=l.length;p<y;p++)g+=l[p].length;for(f=new Uint8Array(g),p=b=0,y=l.length;p<y;p++)r=l[p],f.set(r,b),b+=r.length;return f}},e={arraySet:function(l,p,y,g,b){for(var r=0;r<g;r++)l[b+r]=p[y+r]},flattenChunks:function(l){return[].concat.apply([],l)}};d.setTyped=function(l){l?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,i)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,e))},d.setTyped(a)},{}],42:[function(s,w,d){var a=s("./common"),i=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e=!1}for(var l=new a.Buf8(256),p=0;p<256;p++)l[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;function y(g,b){if(b<65537&&(g.subarray&&e||!g.subarray&&i))return String.fromCharCode.apply(null,a.shrinkBuf(g,b));for(var r="",f=0;f<b;f++)r+=String.fromCharCode(g[f]);return r}l[254]=l[254]=1,d.string2buf=function(g){var b,r,f,o,u,c=g.length,_=0;for(o=0;o<c;o++)(64512&(r=g.charCodeAt(o)))==55296&&o+1<c&&(64512&(f=g.charCodeAt(o+1)))==56320&&(r=65536+(r-55296<<10)+(f-56320),o++),_+=r<128?1:r<2048?2:r<65536?3:4;for(b=new a.Buf8(_),o=u=0;u<_;o++)(64512&(r=g.charCodeAt(o)))==55296&&o+1<c&&(64512&(f=g.charCodeAt(o+1)))==56320&&(r=65536+(r-55296<<10)+(f-56320),o++),r<128?b[u++]=r:(r<2048?b[u++]=192|r>>>6:(r<65536?b[u++]=224|r>>>12:(b[u++]=240|r>>>18,b[u++]=128|r>>>12&63),b[u++]=128|r>>>6&63),b[u++]=128|63&r);return b},d.buf2binstring=function(g){return y(g,g.length)},d.binstring2buf=function(g){for(var b=new a.Buf8(g.length),r=0,f=b.length;r<f;r++)b[r]=g.charCodeAt(r);return b},d.buf2string=function(g,b){var r,f,o,u,c=b||g.length,_=new Array(2*c);for(r=f=0;r<c;)if((o=g[r++])<128)_[f++]=o;else if(4<(u=l[o]))_[f++]=65533,r+=u-1;else{for(o&=u===2?31:u===3?15:7;1<u&&r<c;)o=o<<6|63&g[r++],u--;1<u?_[f++]=65533:o<65536?_[f++]=o:(o-=65536,_[f++]=55296|o>>10&1023,_[f++]=56320|1023&o)}return y(_,f)},d.utf8border=function(g,b){var r;for((b=b||g.length)>g.length&&(b=g.length),r=b-1;0<=r&&(192&g[r])==128;)r--;return r<0||r===0?b:r+l[g[r]]>b?r:b}},{"./common":41}],43:[function(s,w,d){w.exports=function(a,i,e,l){for(var p=65535&a|0,y=a>>>16&65535|0,g=0;e!==0;){for(e-=g=2e3<e?2e3:e;y=y+(p=p+i[l++]|0)|0,--g;);p%=65521,y%=65521}return p|y<<16|0}},{}],44:[function(s,w,d){w.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,w,d){var a=function(){for(var i,e=[],l=0;l<256;l++){i=l;for(var p=0;p<8;p++)i=1&i?3988292384^i>>>1:i>>>1;e[l]=i}return e}();w.exports=function(i,e,l,p){var y=a,g=p+l;i^=-1;for(var b=p;b<g;b++)i=i>>>8^y[255&(i^e[b])];return-1^i}},{}],46:[function(s,w,d){var a,i=s("../utils/common"),e=s("./trees"),l=s("./adler32"),p=s("./crc32"),y=s("./messages"),g=0,b=4,r=0,f=-2,o=-1,u=4,c=2,_=8,k=9,I=286,E=30,D=19,L=2*I+1,j=15,R=3,Z=258,V=Z+R+1,v=42,T=113,n=1,P=2,Q=3,M=4;function tt(t,F){return t.msg=y[F],F}function G(t){return(t<<1)-(4<t?9:0)}function J(t){for(var F=t.length;0<=--F;)t[F]=0}function B(t){var F=t.state,O=F.pending;O>t.avail_out&&(O=t.avail_out),O!==0&&(i.arraySet(t.output,F.pending_buf,F.pending_out,O,t.next_out),t.next_out+=O,F.pending_out+=O,t.total_out+=O,t.avail_out-=O,F.pending-=O,F.pending===0&&(F.pending_out=0))}function A(t,F){e._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,F),t.block_start=t.strstart,B(t.strm)}function X(t,F){t.pending_buf[t.pending++]=F}function q(t,F){t.pending_buf[t.pending++]=F>>>8&255,t.pending_buf[t.pending++]=255&F}function $(t,F){var O,m,h=t.max_chain_length,S=t.strstart,N=t.prev_length,U=t.nice_match,z=t.strstart>t.w_size-V?t.strstart-(t.w_size-V):0,W=t.window,Y=t.w_mask,H=t.prev,K=t.strstart+Z,it=W[S+N-1],nt=W[S+N];t.prev_length>=t.good_match&&(h>>=2),U>t.lookahead&&(U=t.lookahead);do if(W[(O=F)+N]===nt&&W[O+N-1]===it&&W[O]===W[S]&&W[++O]===W[S+1]){S+=2,O++;do;while(W[++S]===W[++O]&&W[++S]===W[++O]&&W[++S]===W[++O]&&W[++S]===W[++O]&&W[++S]===W[++O]&&W[++S]===W[++O]&&W[++S]===W[++O]&&W[++S]===W[++O]&&S<K);if(m=Z-(K-S),S=K-Z,N<m){if(t.match_start=F,U<=(N=m))break;it=W[S+N-1],nt=W[S+N]}}while((F=H[F&Y])>z&&--h!=0);return N<=t.lookahead?N:t.lookahead}function at(t){var F,O,m,h,S,N,U,z,W,Y,H=t.w_size;do{if(h=t.window_size-t.lookahead-t.strstart,t.strstart>=H+(H-V)){for(i.arraySet(t.window,t.window,H,H,0),t.match_start-=H,t.strstart-=H,t.block_start-=H,F=O=t.hash_size;m=t.head[--F],t.head[F]=H<=m?m-H:0,--O;);for(F=O=H;m=t.prev[--F],t.prev[F]=H<=m?m-H:0,--O;);h+=H}if(t.strm.avail_in===0)break;if(N=t.strm,U=t.window,z=t.strstart+t.lookahead,W=h,Y=void 0,Y=N.avail_in,W<Y&&(Y=W),O=Y===0?0:(N.avail_in-=Y,i.arraySet(U,N.input,N.next_in,Y,z),N.state.wrap===1?N.adler=l(N.adler,U,Y,z):N.state.wrap===2&&(N.adler=p(N.adler,U,Y,z)),N.next_in+=Y,N.total_in+=Y,Y),t.lookahead+=O,t.lookahead+t.insert>=R)for(S=t.strstart-t.insert,t.ins_h=t.window[S],t.ins_h=(t.ins_h<<t.hash_shift^t.window[S+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[S+R-1])&t.hash_mask,t.prev[S&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=S,S++,t.insert--,!(t.lookahead+t.insert<R)););}while(t.lookahead<V&&t.strm.avail_in!==0)}function pt(t,F){for(var O,m;;){if(t.lookahead<V){if(at(t),t.lookahead<V&&F===g)return n;if(t.lookahead===0)break}if(O=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),O!==0&&t.strstart-O<=t.w_size-V&&(t.match_length=$(t,O)),t.match_length>=R)if(m=e._tr_tally(t,t.strstart-t.match_start,t.match_length-R),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=R){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else m=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(m&&(A(t,!1),t.strm.avail_out===0))return n}return t.insert=t.strstart<R-1?t.strstart:R-1,F===b?(A(t,!0),t.strm.avail_out===0?Q:M):t.last_lit&&(A(t,!1),t.strm.avail_out===0)?n:P}function et(t,F){for(var O,m,h;;){if(t.lookahead<V){if(at(t),t.lookahead<V&&F===g)return n;if(t.lookahead===0)break}if(O=0,t.lookahead>=R&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=R-1,O!==0&&t.prev_length<t.max_lazy_match&&t.strstart-O<=t.w_size-V&&(t.match_length=$(t,O),t.match_length<=5&&(t.strategy===1||t.match_length===R&&4096<t.strstart-t.match_start)&&(t.match_length=R-1)),t.prev_length>=R&&t.match_length<=t.prev_length){for(h=t.strstart+t.lookahead-R,m=e._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-R),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=h&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+R-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=R-1,t.strstart++,m&&(A(t,!1),t.strm.avail_out===0))return n}else if(t.match_available){if((m=e._tr_tally(t,0,t.window[t.strstart-1]))&&A(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return n}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(m=e._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<R-1?t.strstart:R-1,F===b?(A(t,!0),t.strm.avail_out===0?Q:M):t.last_lit&&(A(t,!1),t.strm.avail_out===0)?n:P}function rt(t,F,O,m,h){this.good_length=t,this.max_lazy=F,this.nice_length=O,this.max_chain=m,this.func=h}function ft(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*L),this.dyn_dtree=new i.Buf16(2*(2*E+1)),this.bl_tree=new i.Buf16(2*(2*D+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(j+1),this.heap=new i.Buf16(2*I+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*I+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function st(t){var F;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=c,(F=t.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?v:T,t.adler=F.wrap===2?0:1,F.last_flush=g,e._tr_init(F),r):tt(t,f)}function xt(t){var F=st(t);return F===r&&function(O){O.window_size=2*O.w_size,J(O.head),O.max_lazy_match=a[O.level].max_lazy,O.good_match=a[O.level].good_length,O.nice_match=a[O.level].nice_length,O.max_chain_length=a[O.level].max_chain,O.strstart=0,O.block_start=0,O.lookahead=0,O.insert=0,O.match_length=O.prev_length=R-1,O.match_available=0,O.ins_h=0}(t.state),F}function kt(t,F,O,m,h,S){if(!t)return f;var N=1;if(F===o&&(F=6),m<0?(N=0,m=-m):15<m&&(N=2,m-=16),h<1||k<h||O!==_||m<8||15<m||F<0||9<F||S<0||u<S)return tt(t,f);m===8&&(m=9);var U=new ft;return(t.state=U).strm=t,U.wrap=N,U.gzhead=null,U.w_bits=m,U.w_size=1<<U.w_bits,U.w_mask=U.w_size-1,U.hash_bits=h+7,U.hash_size=1<<U.hash_bits,U.hash_mask=U.hash_size-1,U.hash_shift=~~((U.hash_bits+R-1)/R),U.window=new i.Buf8(2*U.w_size),U.head=new i.Buf16(U.hash_size),U.prev=new i.Buf16(U.w_size),U.lit_bufsize=1<<h+6,U.pending_buf_size=4*U.lit_bufsize,U.pending_buf=new i.Buf8(U.pending_buf_size),U.d_buf=1*U.lit_bufsize,U.l_buf=3*U.lit_bufsize,U.level=F,U.strategy=S,U.method=O,xt(t)}a=[new rt(0,0,0,0,function(t,F){var O=65535;for(O>t.pending_buf_size-5&&(O=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),t.lookahead===0&&F===g)return n;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var m=t.block_start+O;if((t.strstart===0||t.strstart>=m)&&(t.lookahead=t.strstart-m,t.strstart=m,A(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-V&&(A(t,!1),t.strm.avail_out===0))return n}return t.insert=0,F===b?(A(t,!0),t.strm.avail_out===0?Q:M):(t.strstart>t.block_start&&(A(t,!1),t.strm.avail_out),n)}),new rt(4,4,8,4,pt),new rt(4,5,16,8,pt),new rt(4,6,32,32,pt),new rt(4,4,16,16,et),new rt(8,16,32,32,et),new rt(8,16,128,128,et),new rt(8,32,128,256,et),new rt(32,128,258,1024,et),new rt(32,258,258,4096,et)],d.deflateInit=function(t,F){return kt(t,F,_,15,8,0)},d.deflateInit2=kt,d.deflateReset=xt,d.deflateResetKeep=st,d.deflateSetHeader=function(t,F){return t&&t.state?t.state.wrap!==2?f:(t.state.gzhead=F,r):f},d.deflate=function(t,F){var O,m,h,S;if(!t||!t.state||5<F||F<0)return t?tt(t,f):f;if(m=t.state,!t.output||!t.input&&t.avail_in!==0||m.status===666&&F!==b)return tt(t,t.avail_out===0?-5:f);if(m.strm=t,O=m.last_flush,m.last_flush=F,m.status===v)if(m.wrap===2)t.adler=0,X(m,31),X(m,139),X(m,8),m.gzhead?(X(m,(m.gzhead.text?1:0)+(m.gzhead.hcrc?2:0)+(m.gzhead.extra?4:0)+(m.gzhead.name?8:0)+(m.gzhead.comment?16:0)),X(m,255&m.gzhead.time),X(m,m.gzhead.time>>8&255),X(m,m.gzhead.time>>16&255),X(m,m.gzhead.time>>24&255),X(m,m.level===9?2:2<=m.strategy||m.level<2?4:0),X(m,255&m.gzhead.os),m.gzhead.extra&&m.gzhead.extra.length&&(X(m,255&m.gzhead.extra.length),X(m,m.gzhead.extra.length>>8&255)),m.gzhead.hcrc&&(t.adler=p(t.adler,m.pending_buf,m.pending,0)),m.gzindex=0,m.status=69):(X(m,0),X(m,0),X(m,0),X(m,0),X(m,0),X(m,m.level===9?2:2<=m.strategy||m.level<2?4:0),X(m,3),m.status=T);else{var N=_+(m.w_bits-8<<4)<<8;N|=(2<=m.strategy||m.level<2?0:m.level<6?1:m.level===6?2:3)<<6,m.strstart!==0&&(N|=32),N+=31-N%31,m.status=T,q(m,N),m.strstart!==0&&(q(m,t.adler>>>16),q(m,65535&t.adler)),t.adler=1}if(m.status===69)if(m.gzhead.extra){for(h=m.pending;m.gzindex<(65535&m.gzhead.extra.length)&&(m.pending!==m.pending_buf_size||(m.gzhead.hcrc&&m.pending>h&&(t.adler=p(t.adler,m.pending_buf,m.pending-h,h)),B(t),h=m.pending,m.pending!==m.pending_buf_size));)X(m,255&m.gzhead.extra[m.gzindex]),m.gzindex++;m.gzhead.hcrc&&m.pending>h&&(t.adler=p(t.adler,m.pending_buf,m.pending-h,h)),m.gzindex===m.gzhead.extra.length&&(m.gzindex=0,m.status=73)}else m.status=73;if(m.status===73)if(m.gzhead.name){h=m.pending;do{if(m.pending===m.pending_buf_size&&(m.gzhead.hcrc&&m.pending>h&&(t.adler=p(t.adler,m.pending_buf,m.pending-h,h)),B(t),h=m.pending,m.pending===m.pending_buf_size)){S=1;break}S=m.gzindex<m.gzhead.name.length?255&m.gzhead.name.charCodeAt(m.gzindex++):0,X(m,S)}while(S!==0);m.gzhead.hcrc&&m.pending>h&&(t.adler=p(t.adler,m.pending_buf,m.pending-h,h)),S===0&&(m.gzindex=0,m.status=91)}else m.status=91;if(m.status===91)if(m.gzhead.comment){h=m.pending;do{if(m.pending===m.pending_buf_size&&(m.gzhead.hcrc&&m.pending>h&&(t.adler=p(t.adler,m.pending_buf,m.pending-h,h)),B(t),h=m.pending,m.pending===m.pending_buf_size)){S=1;break}S=m.gzindex<m.gzhead.comment.length?255&m.gzhead.comment.charCodeAt(m.gzindex++):0,X(m,S)}while(S!==0);m.gzhead.hcrc&&m.pending>h&&(t.adler=p(t.adler,m.pending_buf,m.pending-h,h)),S===0&&(m.status=103)}else m.status=103;if(m.status===103&&(m.gzhead.hcrc?(m.pending+2>m.pending_buf_size&&B(t),m.pending+2<=m.pending_buf_size&&(X(m,255&t.adler),X(m,t.adler>>8&255),t.adler=0,m.status=T)):m.status=T),m.pending!==0){if(B(t),t.avail_out===0)return m.last_flush=-1,r}else if(t.avail_in===0&&G(F)<=G(O)&&F!==b)return tt(t,-5);if(m.status===666&&t.avail_in!==0)return tt(t,-5);if(t.avail_in!==0||m.lookahead!==0||F!==g&&m.status!==666){var U=m.strategy===2?function(z,W){for(var Y;;){if(z.lookahead===0&&(at(z),z.lookahead===0)){if(W===g)return n;break}if(z.match_length=0,Y=e._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,Y&&(A(z,!1),z.strm.avail_out===0))return n}return z.insert=0,W===b?(A(z,!0),z.strm.avail_out===0?Q:M):z.last_lit&&(A(z,!1),z.strm.avail_out===0)?n:P}(m,F):m.strategy===3?function(z,W){for(var Y,H,K,it,nt=z.window;;){if(z.lookahead<=Z){if(at(z),z.lookahead<=Z&&W===g)return n;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=R&&0<z.strstart&&(H=nt[K=z.strstart-1])===nt[++K]&&H===nt[++K]&&H===nt[++K]){it=z.strstart+Z;do;while(H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&K<it);z.match_length=Z-(it-K),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=R?(Y=e._tr_tally(z,1,z.match_length-R),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(Y=e._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),Y&&(A(z,!1),z.strm.avail_out===0))return n}return z.insert=0,W===b?(A(z,!0),z.strm.avail_out===0?Q:M):z.last_lit&&(A(z,!1),z.strm.avail_out===0)?n:P}(m,F):a[m.level].func(m,F);if(U!==Q&&U!==M||(m.status=666),U===n||U===Q)return t.avail_out===0&&(m.last_flush=-1),r;if(U===P&&(F===1?e._tr_align(m):F!==5&&(e._tr_stored_block(m,0,0,!1),F===3&&(J(m.head),m.lookahead===0&&(m.strstart=0,m.block_start=0,m.insert=0))),B(t),t.avail_out===0))return m.last_flush=-1,r}return F!==b?r:m.wrap<=0?1:(m.wrap===2?(X(m,255&t.adler),X(m,t.adler>>8&255),X(m,t.adler>>16&255),X(m,t.adler>>24&255),X(m,255&t.total_in),X(m,t.total_in>>8&255),X(m,t.total_in>>16&255),X(m,t.total_in>>24&255)):(q(m,t.adler>>>16),q(m,65535&t.adler)),B(t),0<m.wrap&&(m.wrap=-m.wrap),m.pending!==0?r:1)},d.deflateEnd=function(t){var F;return t&&t.state?(F=t.state.status)!==v&&F!==69&&F!==73&&F!==91&&F!==103&&F!==T&&F!==666?tt(t,f):(t.state=null,F===T?tt(t,-3):r):f},d.deflateSetDictionary=function(t,F){var O,m,h,S,N,U,z,W,Y=F.length;if(!t||!t.state||(S=(O=t.state).wrap)===2||S===1&&O.status!==v||O.lookahead)return f;for(S===1&&(t.adler=l(t.adler,F,Y,0)),O.wrap=0,Y>=O.w_size&&(S===0&&(J(O.head),O.strstart=0,O.block_start=0,O.insert=0),W=new i.Buf8(O.w_size),i.arraySet(W,F,Y-O.w_size,O.w_size,0),F=W,Y=O.w_size),N=t.avail_in,U=t.next_in,z=t.input,t.avail_in=Y,t.next_in=0,t.input=F,at(O);O.lookahead>=R;){for(m=O.strstart,h=O.lookahead-(R-1);O.ins_h=(O.ins_h<<O.hash_shift^O.window[m+R-1])&O.hash_mask,O.prev[m&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=m,m++,--h;);O.strstart=m,O.lookahead=R-1,at(O)}return O.strstart+=O.lookahead,O.block_start=O.strstart,O.insert=O.lookahead,O.lookahead=0,O.match_length=O.prev_length=R-1,O.match_available=0,t.next_in=U,t.input=z,t.avail_in=N,O.wrap=S,r},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,w,d){w.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,w,d){w.exports=function(a,i){var e,l,p,y,g,b,r,f,o,u,c,_,k,I,E,D,L,j,R,Z,V,v,T,n,P;e=a.state,l=a.next_in,n=a.input,p=l+(a.avail_in-5),y=a.next_out,P=a.output,g=y-(i-a.avail_out),b=y+(a.avail_out-257),r=e.dmax,f=e.wsize,o=e.whave,u=e.wnext,c=e.window,_=e.hold,k=e.bits,I=e.lencode,E=e.distcode,D=(1<<e.lenbits)-1,L=(1<<e.distbits)-1;t:do{k<15&&(_+=n[l++]<<k,k+=8,_+=n[l++]<<k,k+=8),j=I[_&D];e:for(;;){if(_>>>=R=j>>>24,k-=R,(R=j>>>16&255)===0)P[y++]=65535&j;else{if(!(16&R)){if(!(64&R)){j=I[(65535&j)+(_&(1<<R)-1)];continue e}if(32&R){e.mode=12;break t}a.msg="invalid literal/length code",e.mode=30;break t}Z=65535&j,(R&=15)&&(k<R&&(_+=n[l++]<<k,k+=8),Z+=_&(1<<R)-1,_>>>=R,k-=R),k<15&&(_+=n[l++]<<k,k+=8,_+=n[l++]<<k,k+=8),j=E[_&L];n:for(;;){if(_>>>=R=j>>>24,k-=R,!(16&(R=j>>>16&255))){if(!(64&R)){j=E[(65535&j)+(_&(1<<R)-1)];continue n}a.msg="invalid distance code",e.mode=30;break t}if(V=65535&j,k<(R&=15)&&(_+=n[l++]<<k,(k+=8)<R&&(_+=n[l++]<<k,k+=8)),r<(V+=_&(1<<R)-1)){a.msg="invalid distance too far back",e.mode=30;break t}if(_>>>=R,k-=R,(R=y-g)<V){if(o<(R=V-R)&&e.sane){a.msg="invalid distance too far back",e.mode=30;break t}if(T=c,(v=0)===u){if(v+=f-R,R<Z){for(Z-=R;P[y++]=c[v++],--R;);v=y-V,T=P}}else if(u<R){if(v+=f+u-R,(R-=u)<Z){for(Z-=R;P[y++]=c[v++],--R;);if(v=0,u<Z){for(Z-=R=u;P[y++]=c[v++],--R;);v=y-V,T=P}}}else if(v+=u-R,R<Z){for(Z-=R;P[y++]=c[v++],--R;);v=y-V,T=P}for(;2<Z;)P[y++]=T[v++],P[y++]=T[v++],P[y++]=T[v++],Z-=3;Z&&(P[y++]=T[v++],1<Z&&(P[y++]=T[v++]))}else{for(v=y-V;P[y++]=P[v++],P[y++]=P[v++],P[y++]=P[v++],2<(Z-=3););Z&&(P[y++]=P[v++],1<Z&&(P[y++]=P[v++]))}break}}break}}while(l<p&&y<b);l-=Z=k>>3,_&=(1<<(k-=Z<<3))-1,a.next_in=l,a.next_out=y,a.avail_in=l<p?p-l+5:5-(l-p),a.avail_out=y<b?b-y+257:257-(y-b),e.hold=_,e.bits=k}},{}],49:[function(s,w,d){var a=s("../utils/common"),i=s("./adler32"),e=s("./crc32"),l=s("./inffast"),p=s("./inftrees"),y=1,g=2,b=0,r=-2,f=1,o=852,u=592;function c(v){return(v>>>24&255)+(v>>>8&65280)+((65280&v)<<8)+((255&v)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(v){var T;return v&&v.state?(T=v.state,v.total_in=v.total_out=T.total=0,v.msg="",T.wrap&&(v.adler=1&T.wrap),T.mode=f,T.last=0,T.havedict=0,T.dmax=32768,T.head=null,T.hold=0,T.bits=0,T.lencode=T.lendyn=new a.Buf32(o),T.distcode=T.distdyn=new a.Buf32(u),T.sane=1,T.back=-1,b):r}function I(v){var T;return v&&v.state?((T=v.state).wsize=0,T.whave=0,T.wnext=0,k(v)):r}function E(v,T){var n,P;return v&&v.state?(P=v.state,T<0?(n=0,T=-T):(n=1+(T>>4),T<48&&(T&=15)),T&&(T<8||15<T)?r:(P.window!==null&&P.wbits!==T&&(P.window=null),P.wrap=n,P.wbits=T,I(v))):r}function D(v,T){var n,P;return v?(P=new _,(v.state=P).window=null,(n=E(v,T))!==b&&(v.state=null),n):r}var L,j,R=!0;function Z(v){if(R){var T;for(L=new a.Buf32(512),j=new a.Buf32(32),T=0;T<144;)v.lens[T++]=8;for(;T<256;)v.lens[T++]=9;for(;T<280;)v.lens[T++]=7;for(;T<288;)v.lens[T++]=8;for(p(y,v.lens,0,288,L,0,v.work,{bits:9}),T=0;T<32;)v.lens[T++]=5;p(g,v.lens,0,32,j,0,v.work,{bits:5}),R=!1}v.lencode=L,v.lenbits=9,v.distcode=j,v.distbits=5}function V(v,T,n,P){var Q,M=v.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new a.Buf8(M.wsize)),P>=M.wsize?(a.arraySet(M.window,T,n-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(P<(Q=M.wsize-M.wnext)&&(Q=P),a.arraySet(M.window,T,n-P,Q,M.wnext),(P-=Q)?(a.arraySet(M.window,T,n-P,P,0),M.wnext=P,M.whave=M.wsize):(M.wnext+=Q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=Q))),0}d.inflateReset=I,d.inflateReset2=E,d.inflateResetKeep=k,d.inflateInit=function(v){return D(v,15)},d.inflateInit2=D,d.inflate=function(v,T){var n,P,Q,M,tt,G,J,B,A,X,q,$,at,pt,et,rt,ft,st,xt,kt,t,F,O,m,h=0,S=new a.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!v||!v.state||!v.output||!v.input&&v.avail_in!==0)return r;(n=v.state).mode===12&&(n.mode=13),tt=v.next_out,Q=v.output,J=v.avail_out,M=v.next_in,P=v.input,G=v.avail_in,B=n.hold,A=n.bits,X=G,q=J,F=b;t:for(;;)switch(n.mode){case f:if(n.wrap===0){n.mode=13;break}for(;A<16;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(2&n.wrap&&B===35615){S[n.check=0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0),A=B=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&B)<<8)+(B>>8))%31){v.msg="incorrect header check",n.mode=30;break}if((15&B)!=8){v.msg="unknown compression method",n.mode=30;break}if(A-=4,t=8+(15&(B>>>=4)),n.wbits===0)n.wbits=t;else if(t>n.wbits){v.msg="invalid window size",n.mode=30;break}n.dmax=1<<t,v.adler=n.check=1,n.mode=512&B?10:12,A=B=0;break;case 2:for(;A<16;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(n.flags=B,(255&n.flags)!=8){v.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){v.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=B>>8&1),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0)),A=B=0,n.mode=3;case 3:for(;A<32;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}n.head&&(n.head.time=B),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,S[2]=B>>>16&255,S[3]=B>>>24&255,n.check=e(n.check,S,4,0)),A=B=0,n.mode=4;case 4:for(;A<16;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}n.head&&(n.head.xflags=255&B,n.head.os=B>>8),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0)),A=B=0,n.mode=5;case 5:if(1024&n.flags){for(;A<16;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}n.length=B,n.head&&(n.head.extra_len=B),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0)),A=B=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(G<($=n.length)&&($=G),$&&(n.head&&(t=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),a.arraySet(n.head.extra,P,M,$,t)),512&n.flags&&(n.check=e(n.check,P,$,M)),G-=$,M+=$,n.length-=$),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(G===0)break t;for($=0;t=P[M+$++],n.head&&t&&n.length<65536&&(n.head.name+=String.fromCharCode(t)),t&&$<G;);if(512&n.flags&&(n.check=e(n.check,P,$,M)),G-=$,M+=$,t)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(G===0)break t;for($=0;t=P[M+$++],n.head&&t&&n.length<65536&&(n.head.comment+=String.fromCharCode(t)),t&&$<G;);if(512&n.flags&&(n.check=e(n.check,P,$,M)),G-=$,M+=$,t)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;A<16;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(B!==(65535&n.check)){v.msg="header crc mismatch",n.mode=30;break}A=B=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),v.adler=n.check=0,n.mode=12;break;case 10:for(;A<32;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}v.adler=n.check=c(B),A=B=0,n.mode=11;case 11:if(n.havedict===0)return v.next_out=tt,v.avail_out=J,v.next_in=M,v.avail_in=G,n.hold=B,n.bits=A,2;v.adler=n.check=1,n.mode=12;case 12:if(T===5||T===6)break t;case 13:if(n.last){B>>>=7&A,A-=7&A,n.mode=27;break}for(;A<3;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}switch(n.last=1&B,A-=1,3&(B>>>=1)){case 0:n.mode=14;break;case 1:if(Z(n),n.mode=20,T!==6)break;B>>>=2,A-=2;break t;case 2:n.mode=17;break;case 3:v.msg="invalid block type",n.mode=30}B>>>=2,A-=2;break;case 14:for(B>>>=7&A,A-=7&A;A<32;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if((65535&B)!=(B>>>16^65535)){v.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&B,A=B=0,n.mode=15,T===6)break t;case 15:n.mode=16;case 16:if($=n.length){if(G<$&&($=G),J<$&&($=J),$===0)break t;a.arraySet(Q,P,M,$,tt),G-=$,M+=$,J-=$,tt+=$,n.length-=$;break}n.mode=12;break;case 17:for(;A<14;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(n.nlen=257+(31&B),B>>>=5,A-=5,n.ndist=1+(31&B),B>>>=5,A-=5,n.ncode=4+(15&B),B>>>=4,A-=4,286<n.nlen||30<n.ndist){v.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;A<3;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}n.lens[N[n.have++]]=7&B,B>>>=3,A-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,O={bits:n.lenbits},F=p(0,n.lens,0,19,n.lencode,0,n.work,O),n.lenbits=O.bits,F){v.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;rt=(h=n.lencode[B&(1<<n.lenbits)-1])>>>16&255,ft=65535&h,!((et=h>>>24)<=A);){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(ft<16)B>>>=et,A-=et,n.lens[n.have++]=ft;else{if(ft===16){for(m=et+2;A<m;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(B>>>=et,A-=et,n.have===0){v.msg="invalid bit length repeat",n.mode=30;break}t=n.lens[n.have-1],$=3+(3&B),B>>>=2,A-=2}else if(ft===17){for(m=et+3;A<m;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}A-=et,t=0,$=3+(7&(B>>>=et)),B>>>=3,A-=3}else{for(m=et+7;A<m;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}A-=et,t=0,$=11+(127&(B>>>=et)),B>>>=7,A-=7}if(n.have+$>n.nlen+n.ndist){v.msg="invalid bit length repeat",n.mode=30;break}for(;$--;)n.lens[n.have++]=t}}if(n.mode===30)break;if(n.lens[256]===0){v.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,O={bits:n.lenbits},F=p(y,n.lens,0,n.nlen,n.lencode,0,n.work,O),n.lenbits=O.bits,F){v.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,O={bits:n.distbits},F=p(g,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,O),n.distbits=O.bits,F){v.msg="invalid distances set",n.mode=30;break}if(n.mode=20,T===6)break t;case 20:n.mode=21;case 21:if(6<=G&&258<=J){v.next_out=tt,v.avail_out=J,v.next_in=M,v.avail_in=G,n.hold=B,n.bits=A,l(v,q),tt=v.next_out,Q=v.output,J=v.avail_out,M=v.next_in,P=v.input,G=v.avail_in,B=n.hold,A=n.bits,n.mode===12&&(n.back=-1);break}for(n.back=0;rt=(h=n.lencode[B&(1<<n.lenbits)-1])>>>16&255,ft=65535&h,!((et=h>>>24)<=A);){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(rt&&!(240&rt)){for(st=et,xt=rt,kt=ft;rt=(h=n.lencode[kt+((B&(1<<st+xt)-1)>>st)])>>>16&255,ft=65535&h,!(st+(et=h>>>24)<=A);){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}B>>>=st,A-=st,n.back+=st}if(B>>>=et,A-=et,n.back+=et,n.length=ft,rt===0){n.mode=26;break}if(32&rt){n.back=-1,n.mode=12;break}if(64&rt){v.msg="invalid literal/length code",n.mode=30;break}n.extra=15&rt,n.mode=22;case 22:if(n.extra){for(m=n.extra;A<m;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}n.length+=B&(1<<n.extra)-1,B>>>=n.extra,A-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;rt=(h=n.distcode[B&(1<<n.distbits)-1])>>>16&255,ft=65535&h,!((et=h>>>24)<=A);){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(!(240&rt)){for(st=et,xt=rt,kt=ft;rt=(h=n.distcode[kt+((B&(1<<st+xt)-1)>>st)])>>>16&255,ft=65535&h,!(st+(et=h>>>24)<=A);){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}B>>>=st,A-=st,n.back+=st}if(B>>>=et,A-=et,n.back+=et,64&rt){v.msg="invalid distance code",n.mode=30;break}n.offset=ft,n.extra=15&rt,n.mode=24;case 24:if(n.extra){for(m=n.extra;A<m;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}n.offset+=B&(1<<n.extra)-1,B>>>=n.extra,A-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){v.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(J===0)break t;if($=q-J,n.offset>$){if(($=n.offset-$)>n.whave&&n.sane){v.msg="invalid distance too far back",n.mode=30;break}at=$>n.wnext?($-=n.wnext,n.wsize-$):n.wnext-$,$>n.length&&($=n.length),pt=n.window}else pt=Q,at=tt-n.offset,$=n.length;for(J<$&&($=J),J-=$,n.length-=$;Q[tt++]=pt[at++],--$;);n.length===0&&(n.mode=21);break;case 26:if(J===0)break t;Q[tt++]=n.length,J--,n.mode=21;break;case 27:if(n.wrap){for(;A<32;){if(G===0)break t;G--,B|=P[M++]<<A,A+=8}if(q-=J,v.total_out+=q,n.total+=q,q&&(v.adler=n.check=n.flags?e(n.check,Q,q,tt-q):i(n.check,Q,q,tt-q)),q=J,(n.flags?B:c(B))!==n.check){v.msg="incorrect data check",n.mode=30;break}A=B=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;A<32;){if(G===0)break t;G--,B+=P[M++]<<A,A+=8}if(B!==(4294967295&n.total)){v.msg="incorrect length check",n.mode=30;break}A=B=0}n.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return r}return v.next_out=tt,v.avail_out=J,v.next_in=M,v.avail_in=G,n.hold=B,n.bits=A,(n.wsize||q!==v.avail_out&&n.mode<30&&(n.mode<27||T!==4))&&V(v,v.output,v.next_out,q-v.avail_out)?(n.mode=31,-4):(X-=v.avail_in,q-=v.avail_out,v.total_in+=X,v.total_out+=q,n.total+=q,n.wrap&&q&&(v.adler=n.check=n.flags?e(n.check,Q,q,v.next_out-q):i(n.check,Q,q,v.next_out-q)),v.data_type=n.bits+(n.last?64:0)+(n.mode===12?128:0)+(n.mode===20||n.mode===15?256:0),(X==0&&q===0||T===4)&&F===b&&(F=-5),F)},d.inflateEnd=function(v){if(!v||!v.state)return r;var T=v.state;return T.window&&(T.window=null),v.state=null,b},d.inflateGetHeader=function(v,T){var n;return v&&v.state&&2&(n=v.state).wrap?((n.head=T).done=!1,b):r},d.inflateSetDictionary=function(v,T){var n,P=T.length;return v&&v.state?(n=v.state).wrap!==0&&n.mode!==11?r:n.mode===11&&i(1,T,P,0)!==n.check?-3:V(v,T,P,P)?(n.mode=31,-4):(n.havedict=1,b):r},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,w,d){var a=s("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];w.exports=function(y,g,b,r,f,o,u,c){var _,k,I,E,D,L,j,R,Z,V=c.bits,v=0,T=0,n=0,P=0,Q=0,M=0,tt=0,G=0,J=0,B=0,A=null,X=0,q=new a.Buf16(16),$=new a.Buf16(16),at=null,pt=0;for(v=0;v<=15;v++)q[v]=0;for(T=0;T<r;T++)q[g[b+T]]++;for(Q=V,P=15;1<=P&&q[P]===0;P--);if(P<Q&&(Q=P),P===0)return f[o++]=20971520,f[o++]=20971520,c.bits=1,0;for(n=1;n<P&&q[n]===0;n++);for(Q<n&&(Q=n),v=G=1;v<=15;v++)if(G<<=1,(G-=q[v])<0)return-1;if(0<G&&(y===0||P!==1))return-1;for($[1]=0,v=1;v<15;v++)$[v+1]=$[v]+q[v];for(T=0;T<r;T++)g[b+T]!==0&&(u[$[g[b+T]]++]=T);if(L=y===0?(A=at=u,19):y===1?(A=i,X-=257,at=e,pt-=257,256):(A=l,at=p,-1),v=n,D=o,tt=T=B=0,I=-1,E=(J=1<<(M=Q))-1,y===1&&852<J||y===2&&592<J)return 1;for(;;){for(j=v-tt,Z=u[T]<L?(R=0,u[T]):u[T]>L?(R=at[pt+u[T]],A[X+u[T]]):(R=96,0),_=1<<v-tt,n=k=1<<M;f[D+(B>>tt)+(k-=_)]=j<<24|R<<16|Z|0,k!==0;);for(_=1<<v-1;B&_;)_>>=1;if(_!==0?(B&=_-1,B+=_):B=0,T++,--q[v]==0){if(v===P)break;v=g[b+u[T]]}if(Q<v&&(B&E)!==I){for(tt===0&&(tt=Q),D+=n,G=1<<(M=v-tt);M+tt<P&&!((G-=q[M+tt])<=0);)M++,G<<=1;if(J+=1<<M,y===1&&852<J||y===2&&592<J)return 1;f[I=B&E]=Q<<24|M<<16|D-o|0}}return B!==0&&(f[D+B]=v-tt<<24|64<<16|0),c.bits=Q,0}},{"../utils/common":41}],51:[function(s,w,d){w.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,w,d){var a=s("../utils/common"),i=0,e=1;function l(h){for(var S=h.length;0<=--S;)h[S]=0}var p=0,y=29,g=256,b=g+1+y,r=30,f=19,o=2*b+1,u=15,c=16,_=7,k=256,I=16,E=17,D=18,L=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(b+2));l(V);var v=new Array(2*r);l(v);var T=new Array(512);l(T);var n=new Array(256);l(n);var P=new Array(y);l(P);var Q,M,tt,G=new Array(r);function J(h,S,N,U,z){this.static_tree=h,this.extra_bits=S,this.extra_base=N,this.elems=U,this.max_length=z,this.has_stree=h&&h.length}function B(h,S){this.dyn_tree=h,this.max_code=0,this.stat_desc=S}function A(h){return h<256?T[h]:T[256+(h>>>7)]}function X(h,S){h.pending_buf[h.pending++]=255&S,h.pending_buf[h.pending++]=S>>>8&255}function q(h,S,N){h.bi_valid>c-N?(h.bi_buf|=S<<h.bi_valid&65535,X(h,h.bi_buf),h.bi_buf=S>>c-h.bi_valid,h.bi_valid+=N-c):(h.bi_buf|=S<<h.bi_valid&65535,h.bi_valid+=N)}function $(h,S,N){q(h,N[2*S],N[2*S+1])}function at(h,S){for(var N=0;N|=1&h,h>>>=1,N<<=1,0<--S;);return N>>>1}function pt(h,S,N){var U,z,W=new Array(u+1),Y=0;for(U=1;U<=u;U++)W[U]=Y=Y+N[U-1]<<1;for(z=0;z<=S;z++){var H=h[2*z+1];H!==0&&(h[2*z]=at(W[H]++,H))}}function et(h){var S;for(S=0;S<b;S++)h.dyn_ltree[2*S]=0;for(S=0;S<r;S++)h.dyn_dtree[2*S]=0;for(S=0;S<f;S++)h.bl_tree[2*S]=0;h.dyn_ltree[2*k]=1,h.opt_len=h.static_len=0,h.last_lit=h.matches=0}function rt(h){8<h.bi_valid?X(h,h.bi_buf):0<h.bi_valid&&(h.pending_buf[h.pending++]=h.bi_buf),h.bi_buf=0,h.bi_valid=0}function ft(h,S,N,U){var z=2*S,W=2*N;return h[z]<h[W]||h[z]===h[W]&&U[S]<=U[N]}function st(h,S,N){for(var U=h.heap[N],z=N<<1;z<=h.heap_len&&(z<h.heap_len&&ft(S,h.heap[z+1],h.heap[z],h.depth)&&z++,!ft(S,U,h.heap[z],h.depth));)h.heap[N]=h.heap[z],N=z,z<<=1;h.heap[N]=U}function xt(h,S,N){var U,z,W,Y,H=0;if(h.last_lit!==0)for(;U=h.pending_buf[h.d_buf+2*H]<<8|h.pending_buf[h.d_buf+2*H+1],z=h.pending_buf[h.l_buf+H],H++,U===0?$(h,z,S):($(h,(W=n[z])+g+1,S),(Y=L[W])!==0&&q(h,z-=P[W],Y),$(h,W=A(--U),N),(Y=j[W])!==0&&q(h,U-=G[W],Y)),H<h.last_lit;);$(h,k,S)}function kt(h,S){var N,U,z,W=S.dyn_tree,Y=S.stat_desc.static_tree,H=S.stat_desc.has_stree,K=S.stat_desc.elems,it=-1;for(h.heap_len=0,h.heap_max=o,N=0;N<K;N++)W[2*N]!==0?(h.heap[++h.heap_len]=it=N,h.depth[N]=0):W[2*N+1]=0;for(;h.heap_len<2;)W[2*(z=h.heap[++h.heap_len]=it<2?++it:0)]=1,h.depth[z]=0,h.opt_len--,H&&(h.static_len-=Y[2*z+1]);for(S.max_code=it,N=h.heap_len>>1;1<=N;N--)st(h,W,N);for(z=K;N=h.heap[1],h.heap[1]=h.heap[h.heap_len--],st(h,W,1),U=h.heap[1],h.heap[--h.heap_max]=N,h.heap[--h.heap_max]=U,W[2*z]=W[2*N]+W[2*U],h.depth[z]=(h.depth[N]>=h.depth[U]?h.depth[N]:h.depth[U])+1,W[2*N+1]=W[2*U+1]=z,h.heap[1]=z++,st(h,W,1),2<=h.heap_len;);h.heap[--h.heap_max]=h.heap[1],function(nt,vt){var Rt,Et,Dt,lt,Ht,ae,It=vt.dyn_tree,ye=vt.max_code,We=vt.stat_desc.static_tree,Ze=vt.stat_desc.has_stree,He=vt.stat_desc.extra_bits,be=vt.stat_desc.extra_base,Tt=vt.stat_desc.max_length,$t=0;for(lt=0;lt<=u;lt++)nt.bl_count[lt]=0;for(It[2*nt.heap[nt.heap_max]+1]=0,Rt=nt.heap_max+1;Rt<o;Rt++)Tt<(lt=It[2*It[2*(Et=nt.heap[Rt])+1]+1]+1)&&(lt=Tt,$t++),It[2*Et+1]=lt,ye<Et||(nt.bl_count[lt]++,Ht=0,be<=Et&&(Ht=He[Et-be]),ae=It[2*Et],nt.opt_len+=ae*(lt+Ht),Ze&&(nt.static_len+=ae*(We[2*Et+1]+Ht)));if($t!==0){do{for(lt=Tt-1;nt.bl_count[lt]===0;)lt--;nt.bl_count[lt]--,nt.bl_count[lt+1]+=2,nt.bl_count[Tt]--,$t-=2}while(0<$t);for(lt=Tt;lt!==0;lt--)for(Et=nt.bl_count[lt];Et!==0;)ye<(Dt=nt.heap[--Rt])||(It[2*Dt+1]!==lt&&(nt.opt_len+=(lt-It[2*Dt+1])*It[2*Dt],It[2*Dt+1]=lt),Et--)}}(h,S),pt(W,it,h.bl_count)}function t(h,S,N){var U,z,W=-1,Y=S[1],H=0,K=7,it=4;for(Y===0&&(K=138,it=3),S[2*(N+1)+1]=65535,U=0;U<=N;U++)z=Y,Y=S[2*(U+1)+1],++H<K&&z===Y||(H<it?h.bl_tree[2*z]+=H:z!==0?(z!==W&&h.bl_tree[2*z]++,h.bl_tree[2*I]++):H<=10?h.bl_tree[2*E]++:h.bl_tree[2*D]++,W=z,it=(H=0)===Y?(K=138,3):z===Y?(K=6,3):(K=7,4))}function F(h,S,N){var U,z,W=-1,Y=S[1],H=0,K=7,it=4;for(Y===0&&(K=138,it=3),U=0;U<=N;U++)if(z=Y,Y=S[2*(U+1)+1],!(++H<K&&z===Y)){if(H<it)for(;$(h,z,h.bl_tree),--H!=0;);else z!==0?(z!==W&&($(h,z,h.bl_tree),H--),$(h,I,h.bl_tree),q(h,H-3,2)):H<=10?($(h,E,h.bl_tree),q(h,H-3,3)):($(h,D,h.bl_tree),q(h,H-11,7));W=z,it=(H=0)===Y?(K=138,3):z===Y?(K=6,3):(K=7,4)}}l(G);var O=!1;function m(h,S,N,U){q(h,(p<<1)+(U?1:0),3),function(z,W,Y,H){rt(z),X(z,Y),X(z,~Y),a.arraySet(z.pending_buf,z.window,W,Y,z.pending),z.pending+=Y}(h,S,N)}d._tr_init=function(h){O||(function(){var S,N,U,z,W,Y=new Array(u+1);for(z=U=0;z<y-1;z++)for(P[z]=U,S=0;S<1<<L[z];S++)n[U++]=z;for(n[U-1]=z,z=W=0;z<16;z++)for(G[z]=W,S=0;S<1<<j[z];S++)T[W++]=z;for(W>>=7;z<r;z++)for(G[z]=W<<7,S=0;S<1<<j[z]-7;S++)T[256+W++]=z;for(N=0;N<=u;N++)Y[N]=0;for(S=0;S<=143;)V[2*S+1]=8,S++,Y[8]++;for(;S<=255;)V[2*S+1]=9,S++,Y[9]++;for(;S<=279;)V[2*S+1]=7,S++,Y[7]++;for(;S<=287;)V[2*S+1]=8,S++,Y[8]++;for(pt(V,b+1,Y),S=0;S<r;S++)v[2*S+1]=5,v[2*S]=at(S,5);Q=new J(V,L,g+1,b,u),M=new J(v,j,0,r,u),tt=new J(new Array(0),R,0,f,_)}(),O=!0),h.l_desc=new B(h.dyn_ltree,Q),h.d_desc=new B(h.dyn_dtree,M),h.bl_desc=new B(h.bl_tree,tt),h.bi_buf=0,h.bi_valid=0,et(h)},d._tr_stored_block=m,d._tr_flush_block=function(h,S,N,U){var z,W,Y=0;0<h.level?(h.strm.data_type===2&&(h.strm.data_type=function(H){var K,it=4093624447;for(K=0;K<=31;K++,it>>>=1)if(1&it&&H.dyn_ltree[2*K]!==0)return i;if(H.dyn_ltree[18]!==0||H.dyn_ltree[20]!==0||H.dyn_ltree[26]!==0)return e;for(K=32;K<g;K++)if(H.dyn_ltree[2*K]!==0)return e;return i}(h)),kt(h,h.l_desc),kt(h,h.d_desc),Y=function(H){var K;for(t(H,H.dyn_ltree,H.l_desc.max_code),t(H,H.dyn_dtree,H.d_desc.max_code),kt(H,H.bl_desc),K=f-1;3<=K&&H.bl_tree[2*Z[K]+1]===0;K--);return H.opt_len+=3*(K+1)+5+5+4,K}(h),z=h.opt_len+3+7>>>3,(W=h.static_len+3+7>>>3)<=z&&(z=W)):z=W=N+5,N+4<=z&&S!==-1?m(h,S,N,U):h.strategy===4||W===z?(q(h,2+(U?1:0),3),xt(h,V,v)):(q(h,4+(U?1:0),3),function(H,K,it,nt){var vt;for(q(H,K-257,5),q(H,it-1,5),q(H,nt-4,4),vt=0;vt<nt;vt++)q(H,H.bl_tree[2*Z[vt]+1],3);F(H,H.dyn_ltree,K-1),F(H,H.dyn_dtree,it-1)}(h,h.l_desc.max_code+1,h.d_desc.max_code+1,Y+1),xt(h,h.dyn_ltree,h.dyn_dtree)),et(h),U&&rt(h)},d._tr_tally=function(h,S,N){return h.pending_buf[h.d_buf+2*h.last_lit]=S>>>8&255,h.pending_buf[h.d_buf+2*h.last_lit+1]=255&S,h.pending_buf[h.l_buf+h.last_lit]=255&N,h.last_lit++,S===0?h.dyn_ltree[2*N]++:(h.matches++,S--,h.dyn_ltree[2*(n[N]+g+1)]++,h.dyn_dtree[2*A(S)]++),h.last_lit===h.lit_bufsize-1},d._tr_align=function(h){q(h,2,3),$(h,k,V),function(S){S.bi_valid===16?(X(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):8<=S.bi_valid&&(S.pending_buf[S.pending++]=255&S.bi_buf,S.bi_buf>>=8,S.bi_valid-=8)}(h)}},{"../utils/common":41}],53:[function(s,w,d){w.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,w,d){(function(a){(function(i,e){if(!i.setImmediate){var l,p,y,g,b=1,r={},f=!1,o=i.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(i);u=u&&u.setTimeout?u:i,l={}.toString.call(i.process)==="[object process]"?function(I){process.nextTick(function(){_(I)})}:function(){if(i.postMessage&&!i.importScripts){var I=!0,E=i.onmessage;return i.onmessage=function(){I=!1},i.postMessage("","*"),i.onmessage=E,I}}()?(g="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",k,!1):i.attachEvent("onmessage",k),function(I){i.postMessage(g+I,"*")}):i.MessageChannel?((y=new MessageChannel).port1.onmessage=function(I){_(I.data)},function(I){y.port2.postMessage(I)}):o&&"onreadystatechange"in o.createElement("script")?(p=o.documentElement,function(I){var E=o.createElement("script");E.onreadystatechange=function(){_(I),E.onreadystatechange=null,p.removeChild(E),E=null},p.appendChild(E)}):function(I){setTimeout(_,0,I)},u.setImmediate=function(I){typeof I!="function"&&(I=new Function(""+I));for(var E=new Array(arguments.length-1),D=0;D<E.length;D++)E[D]=arguments[D+1];var L={callback:I,args:E};return r[b]=L,l(b),b++},u.clearImmediate=c}function c(I){delete r[I]}function _(I){if(f)setTimeout(_,0,I);else{var E=r[I];if(E){f=!0;try{(function(D){var L=D.callback,j=D.args;switch(j.length){case 0:L();break;case 1:L(j[0]);break;case 2:L(j[0],j[1]);break;case 3:L(j[0],j[1],j[2]);break;default:L.apply(e,j)}})(E)}finally{c(I),f=!1}}}}function k(I){I.source===i&&typeof I.data=="string"&&I.data.indexOf(g)===0&&_(+I.data.slice(g.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof qt<"u"?qt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Ie);var qe=Ie.exports;const te=$e(qe),he="PhotoAppDB",Ye=3,yt="photos",wt="groups",At="folders";let ht,Ct,ot=[],dt=[],ut=[],bt=-1,Ft=!1,gt=new Set,Jt=new Set,St=null,ct=null,jt=localStorage.getItem("isAutoFilename")!=="false",Ce=null,Pt=null;const mt=new Map;let Ot;const Ke=7e3,Mt=document.getElementById("camera-page"),Gt=document.getElementById("gallery-page"),zt=document.getElementById("camera-feed"),Kt=document.getElementById("capture-canvas"),Xe=document.getElementById("capture-btn"),Ve=document.getElementById("to-gallery-btn"),Xt=document.getElementById("last-photo-preview"),Je=document.getElementById("camera-photo-count"),Qe=document.getElementById("current-group-name"),tn=document.getElementById("new-group-btn"),ee=document.getElementById("group-memo-input"),ze=document.getElementById("folder-select"),en=document.getElementById("new-folder-btn"),nn=document.getElementById("to-camera-btn"),ve=document.getElementById("gallery-grid"),rn=document.getElementById("photo-count"),on=document.getElementById("settings-btn"),le=document.getElementById("select-mode-btn");async function Wt(){[ze,document.getElementById("gallery-folder-select")].forEach(C=>{C&&(C.innerHTML="",ut.forEach(s=>{const w=document.createElement("option");w.value=s.id,w.textContent=s.name,s.id===ct&&(w.selected=!0),C.appendChild(w)}))})}async function we(){let x=0;const C=/^Folder\s+(\d+)$/;ut.forEach(d=>{const a=d.name.match(C);if(a){const i=parseInt(a[1]);i>x&&(x=i)}});const s=x+1;ct=(await fe(`Folder ${s}`)).id,localStorage.setItem("defaultFolderId",ct),await Lt("Group 1","",ct),Zt(),Wt()}async function an(x){ct=Number(x.target.value),localStorage.setItem("defaultFolderId",ct),Zt()}async function sn(){if(!ct)return;const x=dt.filter(a=>a.folderId===ct);let C=0;const s=/^Group\s+(\d+)$/;x.forEach(a=>{const i=a.name.match(s);if(i){const e=parseInt(i[1]);e>C&&(C=e)}});const w=C+1;St=(await Lt(`Group ${w}`,"",ct)).id,ue(),ee.value="",Gt.classList.contains("hidden")||await _t()}const ke=document.getElementById("bulk-action-bar"),ln=document.getElementById("selected-count"),ce=document.getElementById("select-all-btn"),cn=document.getElementById("bulk-download-btn"),dn=document.getElementById("bulk-delete-btn"),un=document.getElementById("bulk-move-btn"),Nt=document.getElementById("photo-modal"),Ae=document.getElementById("modal-image"),hn=document.getElementById("close-modal-btn"),fn=document.getElementById("download-btn"),pn=document.getElementById("delete-btn"),mn=document.getElementById("move-btn"),Be=document.getElementById("prev-btn"),Oe=document.getElementById("next-btn"),de=document.getElementById("settings-modal"),gn=document.getElementById("close-settings-btn"),Le=document.getElementById("auto-filename-toggle"),_n=document.getElementById("reset-app-btn"),Bt=document.getElementById("move-modal"),yn=document.getElementById("close-move-btn"),Vt=document.getElementById("group-list");function bn(){mt.forEach(x=>{URL.revokeObjectURL(x)}),mt.clear()}function vn(){Pt||(Pt=new IntersectionObserver(x=>{x.forEach(C=>{if(C.isIntersecting){const s=C.target,w=s.dataset.photoId;w&&!s.src&&(wn(s,w),Pt.unobserve(s))}})},{rootMargin:"100px"}))}function wn(x,C){const s=ot.find(w=>w.id==C);if(s){let w=mt.get(C);w||(w=URL.createObjectURL(s.blob),mt.set(C,w)),x.src=w}}async function kn(){try{await De(),await En(),ut=await Te(),ut.sort((C,s)=>C.id-s.id),dt=await Pe(),dt.sort((C,s)=>C.id-s.id);const x=localStorage.getItem("defaultFolderId");x&&ut.find(C=>C.id==x)?ct=Number(x):ut.length>0?ct=ut[ut.length-1].id:ct=(await fe("Folder 1")).id,Zt(),Se(),Gn(),await ne(),ot=await Ne(),ge(),Hn(),vn(),Le.checked=jt,Se(),Re(),Wt()}catch(x){console.error("Initialization failed:",x),alert("Failed to initialize app.")}}function Zt(){const x=dt.filter(C=>C.folderId===ct);x.length>0?St=x[x.length-1].id:Lt("Group 1","",ct).then(C=>{St=C.id,ue()}),ue()}function Re(){Mt.classList.remove("hidden"),Gt.classList.add("hidden"),Ct?zt.paused&&zt.play():ne(),re()}async function xn(){Mt.classList.add("hidden"),Gt.classList.remove("hidden"),Mt.classList.add("hidden"),Gt.classList.remove("hidden"),je(),await _t()}function De(){return new Promise((x,C)=>{const s=indexedDB.open(he,Ye);s.onerror=()=>C(s.error),s.onsuccess=()=>{ht=s.result,x(ht)},s.onupgradeneeded=w=>{const d=w.target.result;d.objectStoreNames.contains(yt)||d.createObjectStore(yt,{keyPath:"id"}),d.objectStoreNames.contains(wt)||d.createObjectStore(wt,{keyPath:"id"}),d.objectStoreNames.contains(At)||d.createObjectStore(At,{keyPath:"id"})}})}async function En(){const C=(await Pe()).filter(s=>!s.folderId);if(C.length>0){console.log(`Found ${C.length} orphaned groups. Migrating...`);const s=await Te();let w=0;const d=/^Folder\s+(\d+)$/;s.forEach(i=>{const e=i.name.match(d);if(e){const l=parseInt(e[1]);l>w&&(w=l)}});const a=await fe(`Folder ${w+1}`);for(const i of C)await Sn(i.id,a.id);console.log("Migration complete.")}}function fe(x,C=""){return new Promise((s,w)=>{const a=ht.transaction([At],"readwrite").objectStore(At),i={id:Date.now(),name:x,memo:C,date:new Date().toISOString()},e=a.add(i);e.onsuccess=()=>{ut.push(i),s(i)},e.onerror=()=>w(e.error)})}function Te(){return new Promise((x,C)=>{const d=ht.transaction([At],"readonly").objectStore(At).getAll();d.onsuccess=()=>x(d.result),d.onerror=()=>C(d.error)})}function Lt(x,C="",s=null){return new Promise((w,d)=>{const i=ht.transaction([wt],"readwrite").objectStore(wt),e={id:Date.now(),name:x,memo:C,folderId:s||ct,date:new Date().toISOString()},l=i.add(e);l.onsuccess=()=>{dt.push(e),w(e)},l.onerror=()=>d(l.error)})}function Sn(x,C){return new Promise((s,w)=>{const a=ht.transaction([wt],"readwrite").objectStore(wt),i=a.get(x);i.onsuccess=()=>{const e=i.result;e?(e.folderId=C,a.put(e),s()):w("Group not found")},i.onerror=()=>w(i.error)})}function Fe(x,C){return new Promise((s,w)=>{const a=ht.transaction([wt],"readwrite").objectStore(wt),i=a.get(x);i.onsuccess=()=>{const e=i.result;if(e){e.memo=C,a.put(e);const l=dt.findIndex(p=>p.id===x);l!==-1&&(dt[l].memo=C),s()}else w("Group not found")},i.onerror=()=>w(i.error)})}function Pe(){return new Promise((x,C)=>{const d=ht.transaction([wt],"readonly").objectStore(wt).getAll();d.onsuccess=()=>x(d.result),d.onerror=()=>C(d.error)})}async function ue(){const x=dt.find(C=>C.id===St);x&&(Qe.textContent=x.name,ee.value=x.memo||""),await Wt()}function pe(x,C=null){return new Promise((s,w)=>{const a=ht.transaction([yt],"readwrite").objectStore(yt),i={id:Date.now(),blob:x,groupId:C||St,date:new Date().toISOString()},e=a.add(i);e.onsuccess=()=>s(i),e.onerror=()=>w(e.error)})}function In(x,C){return new Promise((s,w)=>{const a=ht.transaction([yt],"readwrite").objectStore(yt),i=a.get(x);i.onsuccess=()=>{const e=i.result;e?(e.groupId=C,a.put(e),s()):w("Photo not found")},i.onerror=()=>w(i.error)})}function Ne(){return new Promise((x,C)=>{const d=ht.transaction([yt],"readonly").objectStore(yt).getAll();d.onsuccess=()=>x(d.result.reverse()),d.onerror=()=>C(d.error)})}function Ue(x){return new Promise((C,s)=>{const a=ht.transaction([yt],"readwrite").objectStore(yt).delete(x);a.onsuccess=()=>C(),a.onerror=()=>s(a.error)})}function me(x){return new Promise(async(C,s)=>{try{const w=ht.transaction([yt],"readwrite");let a=w.objectStore(yt).openCursor();a.onsuccess=p=>{const y=p.target.result;y&&(y.value.groupId===x&&y.delete(),y.continue())},await new Promise((p,y)=>{w.oncomplete=p,w.onerror=y});const e=ht.transaction([wt],"readwrite").objectStore(wt);await new Promise((p,y)=>{const g=e.delete(x);g.onsuccess=p,g.onerror=y});const l=dt.findIndex(p=>p.id===x);l>-1&&dt.splice(l,1),C()}catch(w){s(w)}})}async function ne(){if(!Ct)try{Ct=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:4096},height:{ideal:4096}},audio:!1}),zt.srcObject=Ct,zt.play().catch(x=>console.log("Autoplay blocked:",x)),re()}catch(x){console.error("Camera access denied:",x)}}function je(){Ct&&(Ct.getTracks().forEach(x=>x.stop()),Ct=null,zt.srcObject=null),Ot&&(clearTimeout(Ot),Ot=null)}function re(){Ot&&clearTimeout(Ot),Mt.classList.contains("hidden")||(Ot=setTimeout(()=>{je(),console.log("Camera auto-disabled due to inactivity")},Ke))}function Cn(){if(re(),!Ct){ne();return}const x=zt.videoWidth,C=zt.videoHeight,s=x/C,w=1080,d=w/s;Kt.width=w,Kt.height=d,Kt.getContext("2d").drawImage(zt,0,0,w,d),Kt.toBlob(async i=>{if(i)try{const e=await pe(i);ot.unshift(e),ge();const l=document.querySelector(".inner-circle");l.style.transform="scale(0.8)",setTimeout(()=>l.style.transform="scale(1)",100)}catch(e){console.error("Failed to save photo:",e),alert("Failed to save photo.")}},"image/jpeg",.8)}function ge(){const x=ot.length;if(Je.textContent=x,x>0){const C=ot[0],s="thumbnail-latest",w=mt.get(s);w&&URL.revokeObjectURL(w);const d=URL.createObjectURL(C.blob);mt.set(s,d),Xt.src=d,Xt.classList.remove("hidden")}else{const C=mt.get("thumbnail-latest");C&&(URL.revokeObjectURL(C),mt.delete("thumbnail-latest")),Xt.src="",Xt.classList.add("hidden")}}let Ut=new Set;async function _t(){bn(),ot=await Ne(),ge(),ve.innerHTML="";const x=new Map;dt.forEach(r=>x.set(r.id,r));const C={};ot.forEach(r=>{const f=r.groupId||"undefined";C[f]||(C[f]=[]),C[f].push(r)});const s=new Map;ut.forEach(r=>s.set(r.id,r));let w=ct;!s.has(w)&&w!=="undefined"&&(ut.length>0?w=ut[0].id:w="undefined");const d=dt.filter(r=>w==="undefined"?!r.folderId:r.folderId===w),a=w==="undefined"?{id:"undefined",name:"Uncategorized"}:s.get(w),i=document.createDocumentFragment(),e=document.createElement("div");e.className="gallery-folder-header",e.style.cssText="width: 100%; display: flex; align-items: center; padding: 15px 10px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-top: 10px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.1);";const l=document.createElement("div");l.style.cssText="flex: 1; display: flex; align-items: center; gap: 10px; overflow: hidden;";const p=document.createElement("h3");p.textContent=a.name,p.style.margin="0",p.style.fontSize="1.2rem",l.appendChild(p);const y=document.createElement("span");y.textContent=a.memo||(w!=="undefined"?"Add details...":""),y.style.cssText="color: #aaa; font-size: 0.9rem; margin-left: 10px; flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; cursor: pointer; border-bottom: 1px dashed rgba(255,255,255,0.2);",y.onclick=()=>{if(w==="undefined")return;const r=prompt("Edit Folder Memo:",a.memo||"");r!==null&&updateFolderMemo(a.id,r).then(_t)},l.appendChild(y);const g=document.createElement("div");if(g.style.cssText="display: flex; gap: 8px;",w!=="undefined"){const r=document.createElement("button");r.className="icon-btn small primary",r.title="Backup Folder (ZIP)",r.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>',r.onclick=()=>On(a.id);const f=document.createElement("button");f.className="icon-btn small",f.title="Restore Folder (ZIP)",f.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>',f.onclick=()=>Ln(a.id);const o=document.createElement("button");o.className="icon-btn small danger",o.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>',o.onclick=()=>Bn(a.id),g.appendChild(r),g.appendChild(f),g.appendChild(o)}e.appendChild(l),e.appendChild(g),i.appendChild(e);const b=d.sort((r,f)=>{const o=_=>{const k=_.name&&_.name.match(/Group\s*(\d+)/i);return k?parseInt(k[1]):-1},u=o(r),c=o(f);return u!==-1&&c!==-1?c-u:f.id-r.id});if(b.length===0){const r=document.createElement("div");r.style.cssText="width: 100%; text-align: center; padding: 40px; color: #666; font-style: italic;",r.textContent="No groups in this folder.",i.appendChild(r)}for(const r of b){const f=C[r.id]||[],o=document.createElement("div");o.className="gallery-group-header",o.style.marginLeft="0px",o.style.width="100%";const u=document.createElement("div");u.style.display="flex",u.style.alignItems="center",u.style.flex="1",u.style.overflow="hidden";const c=document.createElement("button");c.className="icon-btn small",c.innerHTML=Ut.has(r.id)?"":"",c.style.marginRight="8px",c.style.fontSize="0.8rem",c.onclick=L=>{L.stopPropagation(),zn(r.id)};const _=document.createElement("span");_.textContent=r.name;const k=document.createElement("span");k.className="group-memo-display",k.textContent=r.memo||"Add memo...",k.onclick=()=>{const L=prompt("Edit Memo:",r.memo||"");L!==null&&Fe(r.id,L).then(()=>{_t(),St===r.id&&(ee.value=L)})},u.appendChild(c),u.appendChild(_),u.appendChild(k);const I=document.createElement("div");I.style.display="flex",I.style.alignItems="center",I.style.gap="8px";const E=document.createElement("span");E.style.fontSize="0.7rem",E.style.opacity="0.7",E.textContent=f.length;const D=document.createElement("button");D.className="icon-btn small danger",D.innerHTML=`
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        `,D.onclick=()=>An(r.id,f.length),I.appendChild(E),I.appendChild(D),o.appendChild(u),o.appendChild(I),i.appendChild(o),Ut.has(r.id)||(f.forEach(L=>{const j=Rn(L);i.appendChild(j)}),i.appendChild($n(r.id)))}ve.appendChild(i),Dn()}function zn(x){Ut.has(x)?Ut.delete(x):Ut.add(x),_t()}async function An(x,C){if(confirm(`Delete Group and all ${C} photos?`))try{await me(x),St===x&&dt.length>0&&(St=dt[0].id),await _t()}catch(s){console.error(s),alert("Failed to delete group")}}async function Bn(x){if(confirm("Delete this folder? This will delete all groups and photos inside it."))try{const C=dt.filter(d=>d.folderId===x);for(const d of C)await me(d.id);const w=ht.transaction([At],"readwrite").objectStore(At);await new Promise((d,a)=>{const i=w.delete(x);i.onsuccess=d,i.onerror=a}),ut=ut.filter(d=>d.id!==x),ct===x&&(ct="undefined",localStorage.removeItem("defaultFolderId"),ut.length>0&&(ct=ut[0].id),await Zt()),Wt(),await _t()}catch(C){console.error(C),alert("Failed to delete folder")}}async function On(x){const C=ut.find(s=>s.id===x);if(C)try{const s=new te,w=C.name.replace(/[\\/:*?"<>|]/g,"_"),d=(C.memo||"").replace(/[\\/:*?"<>|]/g,"_"),a=d?`${w}(${d}).zip`:`${w}.zip`,i=dt.filter(p=>p.folderId===x);for(const p of i){const y=p.name.replace(/[\\/:*?"<>|]/g,"_"),g=(p.memo||"").replace(/[\\/:*?"<>|]/g,"_"),b=g?`${y}(${g})`:y,r=ot.filter(o=>o.groupId===p.id);r.sort((o,u)=>new Date(o.date)-new Date(u.date));let f=1;for(const o of r){const u=new Date(o.date),c=u.getFullYear(),_=String(u.getMonth()+1).padStart(2,"0"),k=String(u.getDate()).padStart(2,"0"),I=String(u.getHours()).padStart(2,"0"),E=String(u.getMinutes()).padStart(2,"0"),D=String(u.getSeconds()).padStart(2,"0"),j=`${`${c}${_}${k}_${I}${E}${D}`}(${f}).jpg`;s.folder(b).file(j,o.blob),f++}}const e=await s.generateAsync({type:"blob"}),l=document.createElement("a");l.href=URL.createObjectURL(e),l.download=a,l.click(),URL.revokeObjectURL(l.href)}catch(s){console.error("Failed to save folder:",s),alert("Failed to export folder.")}}async function Ln(x){const C=document.createElement("input");C.type="file",C.accept=".zip",C.onchange=async s=>{const w=s.target.files[0];if(w&&confirm("This will REPLACE the contents of this folder. Continue?"))try{const d=await te.loadAsync(w),a=dt.filter(p=>p.folderId===x);for(const p of a)await me(p.id);const i=new Map,e=p=>{const y=p.match(/^(.*)\((.*)\)$/);return y?{name:y[1].trim(),memo:y[2].trim()}:{name:p.trim(),memo:""}},l=p=>{const y=p.match(/^(\d{4})(\d{2})(\d{2})_(\d{2})(\d{2})(\d{2})\(\d+\)\./);if(y){const g=parseInt(y[1]),b=parseInt(y[2])-1,r=parseInt(y[3]),f=parseInt(y[4]),o=parseInt(y[5]),u=parseInt(y[6]);return new Date(g,b,r,f,o,u).toISOString()}return new Date().toISOString()};d.forEach((p,y)=>{if(y.dir||p.startsWith("__MACOSX")||p.includes("/."))return;const g=p.split("/");let b="Uncategorized",r=g[g.length-1];g.length>=2&&(b=g[g.length-2]),i.has(b)||i.set(b,{...e(b),photos:[]}),i.get(b).photos.push(y)});for(const[p,y]of i){const g=await Lt(y.name,y.memo,x);y.photos.sort((b,r)=>b.name.localeCompare(r.name));for(const b of y.photos){const r=await b.async("blob"),f=b.name.split("/").pop(),o=l(f);await new Promise((u,c)=>{const k=ht.transaction([yt],"readwrite").objectStore(yt),I={id:Date.now()+Math.random(),groupId:g.id,name:f,blob:r,date:o},E=k.add(I);E.onsuccess=u,E.onerror=c})}}await _t(),alert("Folder Restored Successfully")}catch(d){console.error(d),alert("Failed to restore folder")}},C.click()}function Rn(x){const C=document.createElement("div");C.className="gallery-item";const s=document.createElement("div");s.className="selection-indicator",C.appendChild(s);const w=document.createElement("img");if(w.dataset.photoId=x.id,w.alt="",Pt)Pt.observe(w);else{const d=URL.createObjectURL(x.blob);w.src=d,mt.set(x.id,d)}return C.appendChild(w),C.onclick=()=>{Ft?Tn(x.id,C):jn(x.id)},C}function Dn(){const x=ot.length;rn.textContent=`${x} photo${x!==1?"s":""}`}function ie(){Ft=!Ft,Ft?(ke.classList.remove("hidden"),le.textContent="Cancel",document.querySelectorAll(".gallery-item").forEach(x=>{x.classList.add("selecting")})):(ke.classList.add("hidden"),le.textContent="Select",gt.clear(),_e(),document.querySelectorAll(".gallery-item").forEach(x=>{x.classList.remove("selecting","selected")}))}function Tn(x,C){gt.has(x)?(gt.delete(x),C.classList.remove("selected")):(gt.add(x),C.classList.add("selected")),_e()}function _e(){ln.textContent=`${gt.size} selected`,gt.size===ot.length&&ot.length>0?ce.textContent="Deselect All":ce.textContent="Select All"}function Fn(){gt.size===ot.length?(gt.clear(),document.querySelectorAll(".gallery-item").forEach(x=>{x.classList.remove("selected")})):(ot.forEach(x=>gt.add(x.id)),document.querySelectorAll(".gallery-item").forEach(x=>{x.classList.add("selected")})),_e()}async function Pn(){if(gt.size===0)return;const x=ot.filter(c=>gt.has(c.id));let C=null;const s=new Date,w=s.getFullYear(),d=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0"),i=String(s.getHours()).padStart(2,"0"),e=String(s.getMinutes()).padStart(2,"0"),l=String(s.getSeconds()).padStart(2,"0"),p=`${w}${d}${a}_${i}${e}${l}`;if(jt)C=p;else{const c=prompt("Enter filename:",p);if(c===null)return;C=c.replace(".zip","").replace(".jpg","")}const y=new te,g=new Map(dt.map(c=>[c.id,c])),b={};x.forEach(c=>{const _=c.groupId||"undefined";b[_]||(b[_]=[]),b[_].push(c)});let r=1;for(const[c,_]of Object.entries(b)){let k="Uncategorized";if(c!=="undefined"){const E=g.get(Number(c));if(E){const D=E.name.replace(/[\\/:*?"<>|]/g,"_"),L=(E.memo||"").replace(/[\\/:*?"<>|]/g,"_");k=L?`${D}(${L})`:D}}const I=y.folder(k);_.forEach(E=>{const D=`${C}(${r}).jpg`;I.file(D,E.blob),r++})}const f=await y.generateAsync({type:"blob"}),o=URL.createObjectURL(f),u=document.createElement("a");u.href=o,u.download=`${C}.zip`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o),alert(`${C}.zip ${x.length}  .`),ie()}async function Nn(){if(gt.size!==0&&confirm(`Delete ${gt.size} photos?`)){for(const x of gt)await Ue(x);await _t(),ie()}}function Me(x=null){if(x?Jt=new Set(x):Jt=new Set(gt),Jt.size===0)return;Vt.innerHTML="";const C={};ut.forEach(d=>C[d.id]=[]),C.undefined=[],dt.forEach(d=>{d.folderId&&C[d.folderId]?C[d.folderId].push(d):C.undefined.push(d)});const s=ut.sort((d,a)=>d.id-a.id),w=d=>{const a=document.createElement("div");a.className="group-list-item",a.style.paddingLeft="25px",a.innerHTML=`<span>${d.name}</span><span style="font-size:0.8rem;color:#aaa">${d.memo||""}</span>`,a.onclick=()=>Un(d.id),Vt.appendChild(a)};if(s.forEach(d=>{const a=C[d.id];if(a.length===0)return;const i=document.createElement("div");i.style.cssText="padding: 8px 10px; background: rgba(255,255,255,0.1); font-weight: bold; margin-top: 5px; border-radius: 4px;",i.textContent=` ${d.name}`,Vt.appendChild(i),a.forEach(w)}),C.undefined.length>0){const d=document.createElement("div");d.style.cssText="padding: 8px 10px; background: rgba(255,255,255,0.1); font-weight: bold; margin-top: 5px; border-radius: 4px;",d.textContent=" Uncategorized",Vt.appendChild(d),C.undefined.forEach(w)}Bt.classList.remove("hidden")}async function Un(x){for(const C of Jt)await In(C,x);Bt.classList.add("hidden"),Ft&&ie(),await _t()}function jn(x){bt=ot.findIndex(C=>C.id===x),bt!==-1&&(oe(),Nt.classList.remove("hidden"))}function oe(){const x=ot[bt];if(!x)return;const C=`modal-${x.id}`;let s=mt.get(C);s||(s=URL.createObjectURL(x.blob),mt.set(C,s)),Ae.src=s,fn.onclick=()=>Mn(x),mn.onclick=()=>Me([x.id]),pn.onclick=async()=>{if(confirm("Delete this photo?")){await Ue(x.id);const w=mt.get(x.id);w&&(URL.revokeObjectURL(w),mt.delete(x.id));const d=mt.get(C);d&&(URL.revokeObjectURL(d),mt.delete(C)),ot.splice(bt,1),ot.length===0?(Qt(),_t()):(bt>=ot.length&&(bt=ot.length-1),oe(),_t())}},Be.style.display=bt>0?"flex":"none",Oe.style.display=bt<ot.length-1?"flex":"none"}function xe(){bt<ot.length-1&&(bt++,oe())}function Ee(){bt>0&&(bt--,oe())}function Qt(){Nt.classList.add("hidden"),setTimeout(()=>{Ae.src="",bt=-1},300)}function Mn(x,C=null,s=null){return new Promise(w=>{const d=URL.createObjectURL(x.blob),a=document.createElement("a");a.href=d;let i,e;if(s)i=s,e=`${i}.jpg`;else{const l=new Date,p=l.getFullYear(),y=String(l.getMonth()+1).padStart(2,"0"),g=String(l.getDate()).padStart(2,"0"),b=String(l.getHours()).padStart(2,"0"),r=String(l.getMinutes()).padStart(2,"0"),f=String(l.getSeconds()).padStart(2,"0");if(i=`${p}${y}${g}_${b}${r}${f}`,e=`${i}.jpg`,!jt){const o=prompt("Enter filename:",e);if(o===null){URL.revokeObjectURL(d),w();return}i=o.replace(".jpg",""),e=`${i}.jpg`}}if(C){let l=1;for(;C.has(e);)e=`${i}(${l}).jpg`,l++;C.add(e)}a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(d),w()})}function Gn(){const x=document.createElement("input");x.type="file",x.id="hidden-zip-input",x.accept=".zip",x.style.display="none",document.body.appendChild(x),x.addEventListener("change",C=>Wn(C.target.files[0]))}async function Wn(x){if(x){if(!confirm("WARNING: This will DELETE ALL current photos and replace them with the backup.")){document.getElementById("hidden-zip-input").value="";return}try{const C=await te.loadAsync(x);ht&&ht.close(),await new Promise((i,e)=>{const l=indexedDB.deleteDatabase(he);l.onsuccess=()=>{ht=null,i()},l.onerror=()=>{console.warn("Delete DB failed or blocked, trying to proceed anyway"),i()},l.onblocked=()=>{console.warn("Delete DB blocked. Reloading page might be needed.")}}),await new Promise(i=>setTimeout(i,100)),await De(),dt=[];const s=new Map,w=i=>{const e=i.replace(/\/$/,""),l=/^(.*?)(\((.*)\))?$/,p=e.match(l);let y=e,g="";return p&&(y=p[1]||e,p[3]&&(g=p[3])),{name:y.trim(),memo:g.trim()}},d=[];C.forEach((i,e)=>{!e.dir&&!i.startsWith("__MACOSX")&&!i.includes("/.")&&d.push(e)}),console.log(`Found ${d.length} files in ZIP.`);let a=0;for(const i of d)try{const e=i.name.split("/");let l=null;if(e.length>1){const g=e[0];if(!s.has(g)){const b=w(g),r=await Lt(b.name,b.memo);s.set(g,r.id)}l=s.get(g)}else{if(!s.has("Default")){const g=await Lt("Restored");s.set("Default",g.id)}l=s.get("Default")}const p=await i.async("blob"),y=await Ge(p);await pe(y,l),a++}catch(e){console.error(`Failed to process ${i.name}:`,e)}alert(`Restore complete! ${a} photos imported.`),location.reload()}catch(C){console.error(C),alert("Failed to restore backup: "+C.message),location.reload()}}}function se(){document.getElementById("auto-filename-toggle"),document.getElementById("restore-btn"),de.classList.toggle("hidden")}function Zn(){if(confirm("WARNING: This will delete ALL photos.")){const x=indexedDB.deleteDatabase(he);x.onsuccess=()=>{alert("App reset successfully."),location.reload()},x.onerror=()=>{alert("Failed to reset app.")}}}function Hn(){document.addEventListener("click",s=>{Mt.classList.contains("hidden")||(Ct?re():ne())},!0),Ve.addEventListener("click",xn),nn.addEventListener("click",Re),Xe.addEventListener("click",Cn),en.addEventListener("click",we),ze.addEventListener("change",an);const x=document.getElementById("gallery-folder-select");x&&x.addEventListener("change",async s=>{ct=Number(s.target.value),localStorage.setItem("defaultFolderId",ct),Zt(),Wt(),await _t()});const C=document.getElementById("gallery-new-folder-btn");C&&C.addEventListener("click",async()=>{await we(),Gt.classList.contains("hidden")||await _t()}),tn.addEventListener("click",sn),ee.addEventListener("change",s=>{St&&Fe(St,s.target.value)}),hn.addEventListener("click",Qt),Nt.addEventListener("click",s=>{s.target===Nt&&Qt()}),Be.addEventListener("click",s=>{s.stopPropagation(),Ee()}),Oe.addEventListener("click",s=>{s.stopPropagation(),xe()}),document.addEventListener("keydown",s=>{Nt.classList.contains("hidden")||(s.key==="ArrowLeft"&&Ee(),s.key==="ArrowRight"&&xe(),s.key==="Escape"&&Qt())}),le.addEventListener("click",ie),ce.addEventListener("click",Fn),cn.addEventListener("click",Pn),dn.addEventListener("click",Nn),un.addEventListener("click",()=>Me()),on.addEventListener("click",se),gn.addEventListener("click",se),de.addEventListener("click",s=>{s.target===de&&se()}),Le.addEventListener("change",s=>{jt=s.target.checked,localStorage.setItem("isAutoFilename",jt)}),_n.addEventListener("click",Zn),document.getElementById("restore-btn").onclick=()=>{document.getElementById("hidden-zip-input").click()},yn.addEventListener("click",()=>Bt.classList.add("hidden")),Bt.addEventListener("click",s=>{s.target===Bt&&Bt.classList.add("hidden")})}function Se(){const x=document.createElement("input");x.type="file",x.id="hidden-file-input",x.accept="image/*",x.multiple=!0,x.style.display="none",document.body.appendChild(x),x.addEventListener("change",C=>qn(C.target.files))}function $n(x){const C=document.createElement("div");return C.className="gallery-item upload-btn",C.innerHTML=`
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
    `,C.onclick=()=>{Ce=Number(x),document.getElementById("hidden-file-input").click()},C}async function qn(x){if(!(!x||x.length===0))try{const C=Array.from(x);let s=0;for(const w of C){const d=await Ge(w);await pe(d,Ce),s++}document.getElementById("hidden-file-input").value="",await _t()}catch(C){console.error("Upload failed:",C),alert("Failed to upload photos.")}}function Ge(x){return new Promise((C,s)=>{const w=new FileReader;w.onload=d=>{const a=new Image;a.onload=()=>{let e=a.width,l=a.height;e>l?e>1920&&(l*=1920/e,e=1920):l>1920&&(e*=1920/l,l=1920);const p=document.createElement("canvas");p.width=e,p.height=l,p.getContext("2d").drawImage(a,0,0,e,l),p.toBlob(g=>{C(g)},"image/jpeg",.8)},a.onerror=s,a.src=d.target.result},w.onerror=s,w.readAsDataURL(x)})}kn();
