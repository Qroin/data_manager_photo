(function(){const x=document.createElement("link").relList;if(x&&x.supports&&x.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))v(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&v(r)}).observe(document,{childList:!0,subtree:!0});function s(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerPolicy&&(i.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?i.credentials="include":d.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function v(d){if(d.ep)return;d.ep=!0;const i=s(d);fetch(d.href,i)}})();var Yt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Je(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}function Kt(E){throw new Error('Could not dynamically require "'+E+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Oe={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(E,x){(function(s){E.exports=s()})(function(){return function s(v,d,i){function r(f,_){if(!d[f]){if(!v[f]){var p=typeof Kt=="function"&&Kt;if(!_&&p)return p(f,!0);if(e)return e(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var l=d[f]={exports:{}};v[f][0].call(l.exports,function(m){var o=v[f][1][m];return r(o||m)},l,l.exports,s,v,d,i)}return d[f].exports}for(var e=typeof Kt=="function"&&Kt,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(s,v,d){var i=s("./utils"),r=s("./support"),e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(a){for(var f,_,p,b,l,m,o,u=[],c=0,y=a.length,k=y,C=i.getTypeOf(a)!=="string";c<a.length;)k=y-c,p=C?(f=a[c++],_=c<y?a[c++]:0,c<y?a[c++]:0):(f=a.charCodeAt(c++),_=c<y?a.charCodeAt(c++):0,c<y?a.charCodeAt(c++):0),b=f>>2,l=(3&f)<<4|_>>4,m=1<k?(15&_)<<2|p>>6:64,o=2<k?63&p:64,u.push(e.charAt(b)+e.charAt(l)+e.charAt(m)+e.charAt(o));return u.join("")},d.decode=function(a){var f,_,p,b,l,m,o=0,u=0,c="data:";if(a.substr(0,c.length)===c)throw new Error("Invalid base64 input, it looks like a data url.");var y,k=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===e.charAt(64)&&k--,a.charAt(a.length-2)===e.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=r.uint8array?new Uint8Array(0|k):new Array(0|k);o<a.length;)f=e.indexOf(a.charAt(o++))<<2|(b=e.indexOf(a.charAt(o++)))>>4,_=(15&b)<<4|(l=e.indexOf(a.charAt(o++)))>>2,p=(3&l)<<6|(m=e.indexOf(a.charAt(o++))),y[u++]=f,l!==64&&(y[u++]=_),m!==64&&(y[u++]=p);return y}},{"./support":30,"./utils":32}],2:[function(s,v,d){var i=s("./external"),r=s("./stream/DataWorker"),e=s("./stream/Crc32Probe"),a=s("./stream/DataLengthProbe");function f(_,p,b,l,m){this.compressedSize=_,this.uncompressedSize=p,this.crc32=b,this.compression=l,this.compressedContent=m}f.prototype={getContentWorker:function(){var _=new r(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),p=this;return _.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new r(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(_,p,b){return _.pipe(new e).pipe(new a("uncompressedSize")).pipe(p.compressWorker(b)).pipe(new a("compressedSize")).withStreamInfo("compression",p)},v.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,v,d){var i=s("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},d.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,v,d){var i=s("./utils"),r=function(){for(var e,a=[],f=0;f<256;f++){e=f;for(var _=0;_<8;_++)e=1&e?3988292384^e>>>1:e>>>1;a[f]=e}return a}();v.exports=function(e,a){return e!==void 0&&e.length?i.getTypeOf(e)!=="string"?function(f,_,p,b){var l=r,m=b+p;f^=-1;for(var o=b;o<m;o++)f=f>>>8^l[255&(f^_[o])];return-1^f}(0|a,e,e.length,0):function(f,_,p,b){var l=r,m=b+p;f^=-1;for(var o=b;o<m;o++)f=f>>>8^l[255&(f^_.charCodeAt(o))];return-1^f}(0|a,e,e.length,0):0}},{"./utils":32}],5:[function(s,v,d){d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(s,v,d){var i=null;i=typeof Promise<"u"?Promise:s("lie"),v.exports={Promise:i}},{lie:37}],7:[function(s,v,d){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=s("pako"),e=s("./utils"),a=s("./stream/GenericWorker"),f=i?"uint8array":"array";function _(p,b){a.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=b,this.meta={}}d.magic="\b\0",e.inherits(_,a),_.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(e.transformTo(f,p.data),!1)},_.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(b){p.push({data:b,meta:p.meta})}},d.compressWorker=function(p){return new _("Deflate",p)},d.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,v,d){function i(l,m){var o,u="";for(o=0;o<m;o++)u+=String.fromCharCode(255&l),l>>>=8;return u}function r(l,m,o,u,c,y){var k,C,I=l.file,T=l.compression,R=y!==f.utf8encode,j=e.transformTo("string",y(I.name)),L=e.transformTo("string",f.utf8encode(I.name)),Z=I.comment,V=e.transformTo("string",y(Z)),w=e.transformTo("string",f.utf8encode(Z)),D=L.length!==I.name.length,n=w.length!==Z.length,N="",Q="",M="",tt=I.dir,W=I.date,J={crc32:0,compressedSize:0,uncompressedSize:0};m&&!o||(J.crc32=l.crc32,J.compressedSize=l.compressedSize,J.uncompressedSize=l.uncompressedSize);var B=0;m&&(B|=8),R||!D&&!n||(B|=2048);var A=0,X=0;tt&&(A|=16),c==="UNIX"?(X=798,A|=function($,at){var pt=$;return $||(pt=at?16893:33204),(65535&pt)<<16}(I.unixPermissions,tt)):(X=20,A|=function($){return 63&($||0)}(I.dosPermissions)),k=W.getUTCHours(),k<<=6,k|=W.getUTCMinutes(),k<<=5,k|=W.getUTCSeconds()/2,C=W.getUTCFullYear()-1980,C<<=4,C|=W.getUTCMonth()+1,C<<=5,C|=W.getUTCDate(),D&&(Q=i(1,1)+i(_(j),4)+L,N+="up"+i(Q.length,2)+Q),n&&(M=i(1,1)+i(_(V),4)+w,N+="uc"+i(M.length,2)+M);var q="";return q+=`
\0`,q+=i(B,2),q+=T.magic,q+=i(k,2),q+=i(C,2),q+=i(J.crc32,4),q+=i(J.compressedSize,4),q+=i(J.uncompressedSize,4),q+=i(j.length,2),q+=i(N.length,2),{fileRecord:p.LOCAL_FILE_HEADER+q+j+N,dirRecord:p.CENTRAL_FILE_HEADER+i(X,2)+q+i(V.length,2)+"\0\0\0\0"+i(A,4)+i(u,4)+j+N+V}}var e=s("../utils"),a=s("../stream/GenericWorker"),f=s("../utf8"),_=s("../crc32"),p=s("../signature");function b(l,m,o,u){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=o,this.encodeFileName=u,this.streamFiles=l,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}e.inherits(b,a),b.prototype.push=function(l){var m=l.meta.percent||0,o=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(l):(this.bytesWritten+=l.data.length,a.prototype.push.call(this,{data:l.data,meta:{currentFile:this.currentFile,percent:o?(m+100*(o-u-1))/o:100}}))},b.prototype.openedSource=function(l){this.currentSourceOffset=this.bytesWritten,this.currentFile=l.file.name;var m=this.streamFiles&&!l.file.dir;if(m){var o=r(l,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:o.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(l){this.accumulate=!1;var m=this.streamFiles&&!l.file.dir,o=r(l,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(o.dirRecord),m)this.push({data:function(u){return p.DATA_DESCRIPTOR+i(u.crc32,4)+i(u.compressedSize,4)+i(u.uncompressedSize,4)}(l),meta:{percent:100}});else for(this.push({data:o.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var l=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var o=this.bytesWritten-l,u=function(c,y,k,C,I){var T=e.transformTo("string",I(C));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(c,2)+i(c,2)+i(y,4)+i(k,4)+i(T.length,2)+T}(this.dirRecords.length,o,l,this.zipComment,this.encodeFileName);this.push({data:u,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(l){this._sources.push(l);var m=this;return l.on("data",function(o){m.processChunk(o)}),l.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),l.on("error",function(o){m.error(o)}),this},b.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(l){var m=this._sources;if(!a.prototype.error.call(this,l))return!1;for(var o=0;o<m.length;o++)try{m[o].error(l)}catch{}return!0},b.prototype.lock=function(){a.prototype.lock.call(this);for(var l=this._sources,m=0;m<l.length;m++)l[m].lock()},v.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,v,d){var i=s("../compressions"),r=s("./ZipFileWorker");d.generateWorker=function(e,a,f){var _=new r(a.streamFiles,f,a.platform,a.encodeFileName),p=0;try{e.forEach(function(b,l){p++;var m=function(y,k){var C=y||k,I=i[C];if(!I)throw new Error(C+" is not a valid compression method !");return I}(l.options.compression,a.compression),o=l.options.compressionOptions||a.compressionOptions||{},u=l.dir,c=l.date;l._compressWorker(m,o).withStreamInfo("file",{name:b,dir:u,date:c,comment:l.comment||"",unixPermissions:l.unixPermissions,dosPermissions:l.dosPermissions}).pipe(_)}),_.entriesCount=p}catch(b){_.error(b)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,v,d){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new i;for(var e in this)typeof this[e]!="function"&&(r[e]=this[e]);return r}}(i.prototype=s("./object")).loadAsync=s("./load"),i.support=s("./support"),i.defaults=s("./defaults"),i.version="3.10.1",i.loadAsync=function(r,e){return new i().loadAsync(r,e)},i.external=s("./external"),v.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,v,d){var i=s("./utils"),r=s("./external"),e=s("./utf8"),a=s("./zipEntries"),f=s("./stream/Crc32Probe"),_=s("./nodejsUtils");function p(b){return new r.Promise(function(l,m){var o=b.decompressed.getContentWorker().pipe(new f);o.on("error",function(u){m(u)}).on("end",function(){o.streamInfo.crc32!==b.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):l()}).resume()})}v.exports=function(b,l){var m=this;return l=i.extend(l||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:e.utf8decode}),_.isNode&&_.isStream(b)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",b,!0,l.optimizedBinaryString,l.base64).then(function(o){var u=new a(l);return u.load(o),u}).then(function(o){var u=[r.Promise.resolve(o)],c=o.files;if(l.checkCRC32)for(var y=0;y<c.length;y++)u.push(p(c[y]));return r.Promise.all(u)}).then(function(o){for(var u=o.shift(),c=u.files,y=0;y<c.length;y++){var k=c[y],C=k.fileNameStr,I=i.resolve(k.fileNameStr);m.file(I,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:l.createFolders}),k.dir||(m.file(I).unsafeOriginalName=C)}return u.zipComment.length&&(m.comment=u.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,v,d){var i=s("../utils"),r=s("../stream/GenericWorker");function e(a,f){r.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(e,r),e.prototype._bindStream=function(a){var f=this;(this._stream=a).pause(),a.on("data",function(_){f.push({data:_,meta:{percent:0}})}).on("error",function(_){f.isPaused?this.generatedError=_:f.error(_)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},e.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},e.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},v.exports=e},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,v,d){var i=s("readable-stream").Readable;function r(e,a,f){i.call(this,a),this._helper=e;var _=this;e.on("data",function(p,b){_.push(p)||_._helper.pause(),f&&f(b)}).on("error",function(p){_.emit("error",p)}).on("end",function(){_.push(null)})}s("../utils").inherits(r,i),r.prototype._read=function(){this._helper.resume()},v.exports=r},{"../utils":32,"readable-stream":16}],14:[function(s,v,d){v.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,r);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,r)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var r=new Buffer(i);return r.fill(0),r},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(s,v,d){function i(I,T,R){var j,L=e.getTypeOf(T),Z=e.extend(R||{},_);Z.date=Z.date||new Date,Z.compression!==null&&(Z.compression=Z.compression.toUpperCase()),typeof Z.unixPermissions=="string"&&(Z.unixPermissions=parseInt(Z.unixPermissions,8)),Z.unixPermissions&&16384&Z.unixPermissions&&(Z.dir=!0),Z.dosPermissions&&16&Z.dosPermissions&&(Z.dir=!0),Z.dir&&(I=c(I)),Z.createFolders&&(j=u(I))&&y.call(this,j,!0);var V=L==="string"&&Z.binary===!1&&Z.base64===!1;R&&R.binary!==void 0||(Z.binary=!V),(T instanceof p&&T.uncompressedSize===0||Z.dir||!T||T.length===0)&&(Z.base64=!1,Z.binary=!0,T="",Z.compression="STORE",L="string");var w=null;w=T instanceof p||T instanceof a?T:m.isNode&&m.isStream(T)?new o(I,T):e.prepareContent(I,T,Z.binary,Z.optimizedBinaryString,Z.base64);var D=new b(I,w,Z);this.files[I]=D}var r=s("./utf8"),e=s("./utils"),a=s("./stream/GenericWorker"),f=s("./stream/StreamHelper"),_=s("./defaults"),p=s("./compressedObject"),b=s("./zipObject"),l=s("./generate"),m=s("./nodejsUtils"),o=s("./nodejs/NodejsStreamInputAdapter"),u=function(I){I.slice(-1)==="/"&&(I=I.substring(0,I.length-1));var T=I.lastIndexOf("/");return 0<T?I.substring(0,T):""},c=function(I){return I.slice(-1)!=="/"&&(I+="/"),I},y=function(I,T){return T=T!==void 0?T:_.createFolders,I=c(I),this.files[I]||i.call(this,I,null,{dir:!0,createFolders:T}),this.files[I]};function k(I){return Object.prototype.toString.call(I)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(I){var T,R,j;for(T in this.files)j=this.files[T],(R=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&I(R,j)},filter:function(I){var T=[];return this.forEach(function(R,j){I(R,j)&&T.push(j)}),T},file:function(I,T,R){if(arguments.length!==1)return I=this.root+I,i.call(this,I,T,R),this;if(k(I)){var j=I;return this.filter(function(Z,V){return!V.dir&&j.test(Z)})}var L=this.files[this.root+I];return L&&!L.dir?L:null},folder:function(I){if(!I)return this;if(k(I))return this.filter(function(L,Z){return Z.dir&&I.test(L)});var T=this.root+I,R=y.call(this,T),j=this.clone();return j.root=R.name,j},remove:function(I){I=this.root+I;var T=this.files[I];if(T||(I.slice(-1)!=="/"&&(I+="/"),T=this.files[I]),T&&!T.dir)delete this.files[I];else for(var R=this.filter(function(L,Z){return Z.name.slice(0,I.length)===I}),j=0;j<R.length;j++)delete this.files[R[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(I){var T,R={};try{if((R=e.extend(I||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");e.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var j=R.comment||this.comment||"";T=l.generateWorker(this,R,j)}catch(L){(T=new a("error")).error(L)}return new f(T,R.type||"string",R.mimeType)},generateAsync:function(I,T){return this.generateInternalStream(I).accumulate(T)},generateNodeStream:function(I,T){return(I=I||{}).type||(I.type="nodebuffer"),this.generateInternalStream(I).toNodejsStream(T)}};v.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,v,d){v.exports=s("stream")},{stream:void 0}],17:[function(s,v,d){var i=s("./DataReader");function r(e){i.call(this,e);for(var a=0;a<this.data.length;a++)e[a]=255&e[a]}s("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var a=e.charCodeAt(0),f=e.charCodeAt(1),_=e.charCodeAt(2),p=e.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===a&&this.data[b+1]===f&&this.data[b+2]===_&&this.data[b+3]===p)return b-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var a=e.charCodeAt(0),f=e.charCodeAt(1),_=e.charCodeAt(2),p=e.charCodeAt(3),b=this.readData(4);return a===b[0]&&f===b[1]&&_===b[2]&&p===b[3]},r.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,a},v.exports=r},{"../utils":32,"./DataReader":18}],18:[function(s,v,d){var i=s("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var a,f=0;for(this.checkOffset(e),a=this.index+e-1;a>=this.index;a--)f=(f<<8)+this.byteAt(a);return this.index+=e,f},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},v.exports=r},{"../utils":32}],19:[function(s,v,d){var i=s("./Uint8ArrayReader");function r(e){i.call(this,e)}s("../utils").inherits(r,i),r.prototype.readData=function(e){this.checkOffset(e);var a=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,a},v.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,v,d){var i=s("./DataReader");function r(e){i.call(this,e)}s("../utils").inherits(r,i),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var a=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,a},v.exports=r},{"../utils":32,"./DataReader":18}],21:[function(s,v,d){var i=s("./ArrayReader");function r(e){i.call(this,e)}s("../utils").inherits(r,i),r.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,a},v.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(s,v,d){var i=s("../utils"),r=s("../support"),e=s("./ArrayReader"),a=s("./StringReader"),f=s("./NodeBufferReader"),_=s("./Uint8ArrayReader");v.exports=function(p){var b=i.getTypeOf(p);return i.checkSupport(b),b!=="string"||r.uint8array?b==="nodebuffer"?new f(p):r.uint8array?new _(i.transformTo("uint8array",p)):new e(i.transformTo("array",p)):new a(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,v,d){d.LOCAL_FILE_HEADER="PK",d.CENTRAL_FILE_HEADER="PK",d.CENTRAL_DIRECTORY_END="PK",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,v,d){var i=s("./GenericWorker"),r=s("../utils");function e(a){i.call(this,"ConvertWorker to "+a),this.destType=a}r.inherits(e,i),e.prototype.processChunk=function(a){this.push({data:r.transformTo(this.destType,a.data),meta:a.meta})},v.exports=e},{"../utils":32,"./GenericWorker":28}],25:[function(s,v,d){var i=s("./GenericWorker"),r=s("../crc32");function e(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(e,i),e.prototype.processChunk=function(a){this.streamInfo.crc32=r(a.data,this.streamInfo.crc32||0),this.push(a)},v.exports=e},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,v,d){var i=s("../utils"),r=s("./GenericWorker");function e(a){r.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}i.inherits(e,r),e.prototype.processChunk=function(a){if(a){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+a.data.length}r.prototype.processChunk.call(this,a)},v.exports=e},{"../utils":32,"./GenericWorker":28}],27:[function(s,v,d){var i=s("../utils"),r=s("./GenericWorker");function e(a){r.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(_){f.dataIsReady=!0,f.data=_,f.max=_&&_.length||0,f.type=i.getTypeOf(_),f.isPaused||f._tickAndRepeat()},function(_){f.error(_)})}i.inherits(e,r),e.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},e.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},e.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},e.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,f);break;case"uint8array":a=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":a=this.data.slice(this.index,f)}return this.index=f,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},v.exports=e},{"../utils":32,"./GenericWorker":28}],28:[function(s,v,d){function i(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,e){return this._listeners[r].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,e){if(this._listeners[r])for(var a=0;a<this._listeners[r].length;a++)this._listeners[r][a].call(this,e)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var e=this;return r.on("data",function(a){e.processChunk(a)}),r.on("end",function(){e.end()}),r.on("error",function(a){e.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,e){return this.extraStreamInfo[r]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},v.exports=i},{}],29:[function(s,v,d){var i=s("../utils"),r=s("./ConvertWorker"),e=s("./GenericWorker"),a=s("../base64"),f=s("../support"),_=s("../external"),p=null;if(f.nodestream)try{p=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(m,o){return new _.Promise(function(u,c){var y=[],k=m._internalType,C=m._outputType,I=m._mimeType;m.on("data",function(T,R){y.push(T),o&&o(R)}).on("error",function(T){y=[],c(T)}).on("end",function(){try{var T=function(R,j,L){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",j),L);case"base64":return a.encode(j);default:return i.transformTo(R,j)}}(C,function(R,j){var L,Z=0,V=null,w=0;for(L=0;L<j.length;L++)w+=j[L].length;switch(R){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(V=new Uint8Array(w),L=0;L<j.length;L++)V.set(j[L],Z),Z+=j[L].length;return V;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+R+"'")}}(k,y),I);u(T)}catch(R){c(R)}y=[]}).resume()})}function l(m,o,u){var c=o;switch(o){case"blob":case"arraybuffer":c="uint8array";break;case"base64":c="string"}try{this._internalType=c,this._outputType=o,this._mimeType=u,i.checkSupport(c),this._worker=m.pipe(new r(c)),m.lock()}catch(y){this._worker=new e("error"),this._worker.error(y)}}l.prototype={accumulate:function(m){return b(this,m)},on:function(m,o){var u=this;return m==="data"?this._worker.on(m,function(c){o.call(u,c.data,c.meta)}):this._worker.on(m,function(){i.delay(o,arguments,u)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},m)}},v.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,v,d){if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",d.nodebuffer=typeof Buffer<"u",d.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")d.blob=!1;else{var i=new ArrayBuffer(0);try{d.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),d.blob=r.getBlob("application/zip").size===0}catch{d.blob=!1}}}try{d.nodestream=!!s("readable-stream").Readable}catch{d.nodestream=!1}},{"readable-stream":16}],31:[function(s,v,d){for(var i=s("./utils"),r=s("./support"),e=s("./nodejsUtils"),a=s("./stream/GenericWorker"),f=new Array(256),_=0;_<256;_++)f[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;f[254]=f[254]=1;function p(){a.call(this,"utf-8 decode"),this.leftOver=null}function b(){a.call(this,"utf-8 encode")}d.utf8encode=function(l){return r.nodebuffer?e.newBufferFrom(l,"utf-8"):function(m){var o,u,c,y,k,C=m.length,I=0;for(y=0;y<C;y++)(64512&(u=m.charCodeAt(y)))==55296&&y+1<C&&(64512&(c=m.charCodeAt(y+1)))==56320&&(u=65536+(u-55296<<10)+(c-56320),y++),I+=u<128?1:u<2048?2:u<65536?3:4;for(o=r.uint8array?new Uint8Array(I):new Array(I),y=k=0;k<I;y++)(64512&(u=m.charCodeAt(y)))==55296&&y+1<C&&(64512&(c=m.charCodeAt(y+1)))==56320&&(u=65536+(u-55296<<10)+(c-56320),y++),u<128?o[k++]=u:(u<2048?o[k++]=192|u>>>6:(u<65536?o[k++]=224|u>>>12:(o[k++]=240|u>>>18,o[k++]=128|u>>>12&63),o[k++]=128|u>>>6&63),o[k++]=128|63&u);return o}(l)},d.utf8decode=function(l){return r.nodebuffer?i.transformTo("nodebuffer",l).toString("utf-8"):function(m){var o,u,c,y,k=m.length,C=new Array(2*k);for(o=u=0;o<k;)if((c=m[o++])<128)C[u++]=c;else if(4<(y=f[c]))C[u++]=65533,o+=y-1;else{for(c&=y===2?31:y===3?15:7;1<y&&o<k;)c=c<<6|63&m[o++],y--;1<y?C[u++]=65533:c<65536?C[u++]=c:(c-=65536,C[u++]=55296|c>>10&1023,C[u++]=56320|1023&c)}return C.length!==u&&(C.subarray?C=C.subarray(0,u):C.length=u),i.applyFromCharCode(C)}(l=i.transformTo(r.uint8array?"uint8array":"array",l))},i.inherits(p,a),p.prototype.processChunk=function(l){var m=i.transformTo(r.uint8array?"uint8array":"array",l.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var o=m;(m=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),m.set(o,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var u=function(y,k){var C;for((k=k||y.length)>y.length&&(k=y.length),C=k-1;0<=C&&(192&y[C])==128;)C--;return C<0||C===0?k:C+f[y[C]]>k?C:k}(m),c=m;u!==m.length&&(r.uint8array?(c=m.subarray(0,u),this.leftOver=m.subarray(u,m.length)):(c=m.slice(0,u),this.leftOver=m.slice(u,m.length))),this.push({data:d.utf8decode(c),meta:l.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=p,i.inherits(b,a),b.prototype.processChunk=function(l){this.push({data:d.utf8encode(l.data),meta:l.meta})},d.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,v,d){var i=s("./support"),r=s("./base64"),e=s("./nodejsUtils"),a=s("./external");function f(o){return o}function _(o,u){for(var c=0;c<o.length;++c)u[c]=255&o.charCodeAt(c);return u}s("setimmediate"),d.newBlob=function(o,u){d.checkSupport("blob");try{return new Blob([o],{type:u})}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return c.append(o),c.getBlob(u)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(o,u,c){var y=[],k=0,C=o.length;if(C<=c)return String.fromCharCode.apply(null,o);for(;k<C;)u==="array"||u==="nodebuffer"?y.push(String.fromCharCode.apply(null,o.slice(k,Math.min(k+c,C)))):y.push(String.fromCharCode.apply(null,o.subarray(k,Math.min(k+c,C)))),k+=c;return y.join("")},stringifyByChar:function(o){for(var u="",c=0;c<o.length;c++)u+=String.fromCharCode(o[c]);return u},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,e.allocBuffer(1)).length===1}catch{return!1}}()}};function b(o){var u=65536,c=d.getTypeOf(o),y=!0;if(c==="uint8array"?y=p.applyCanBeUsed.uint8array:c==="nodebuffer"&&(y=p.applyCanBeUsed.nodebuffer),y)for(;1<u;)try{return p.stringifyByChunk(o,c,u)}catch{u=Math.floor(u/2)}return p.stringifyByChar(o)}function l(o,u){for(var c=0;c<o.length;c++)u[c]=o[c];return u}d.applyFromCharCode=b;var m={};m.string={string:f,array:function(o){return _(o,new Array(o.length))},arraybuffer:function(o){return m.string.uint8array(o).buffer},uint8array:function(o){return _(o,new Uint8Array(o.length))},nodebuffer:function(o){return _(o,e.allocBuffer(o.length))}},m.array={string:b,array:f,arraybuffer:function(o){return new Uint8Array(o).buffer},uint8array:function(o){return new Uint8Array(o)},nodebuffer:function(o){return e.newBufferFrom(o)}},m.arraybuffer={string:function(o){return b(new Uint8Array(o))},array:function(o){return l(new Uint8Array(o),new Array(o.byteLength))},arraybuffer:f,uint8array:function(o){return new Uint8Array(o)},nodebuffer:function(o){return e.newBufferFrom(new Uint8Array(o))}},m.uint8array={string:b,array:function(o){return l(o,new Array(o.length))},arraybuffer:function(o){return o.buffer},uint8array:f,nodebuffer:function(o){return e.newBufferFrom(o)}},m.nodebuffer={string:b,array:function(o){return l(o,new Array(o.length))},arraybuffer:function(o){return m.nodebuffer.uint8array(o).buffer},uint8array:function(o){return l(o,new Uint8Array(o.length))},nodebuffer:f},d.transformTo=function(o,u){if(u=u||"",!o)return u;d.checkSupport(o);var c=d.getTypeOf(u);return m[c][o](u)},d.resolve=function(o){for(var u=o.split("/"),c=[],y=0;y<u.length;y++){var k=u[y];k==="."||k===""&&y!==0&&y!==u.length-1||(k===".."?c.pop():c.push(k))}return c.join("/")},d.getTypeOf=function(o){return typeof o=="string"?"string":Object.prototype.toString.call(o)==="[object Array]"?"array":i.nodebuffer&&e.isBuffer(o)?"nodebuffer":i.uint8array&&o instanceof Uint8Array?"uint8array":i.arraybuffer&&o instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(o){if(!i[o.toLowerCase()])throw new Error(o+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(o){var u,c,y="";for(c=0;c<(o||"").length;c++)y+="\\x"+((u=o.charCodeAt(c))<16?"0":"")+u.toString(16).toUpperCase();return y},d.delay=function(o,u,c){setImmediate(function(){o.apply(c||null,u||[])})},d.inherits=function(o,u){function c(){}c.prototype=u.prototype,o.prototype=new c},d.extend=function(){var o,u,c={};for(o=0;o<arguments.length;o++)for(u in arguments[o])Object.prototype.hasOwnProperty.call(arguments[o],u)&&c[u]===void 0&&(c[u]=arguments[o][u]);return c},d.prepareContent=function(o,u,c,y,k){return a.Promise.resolve(u).then(function(C){return i.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new a.Promise(function(I,T){var R=new FileReader;R.onload=function(j){I(j.target.result)},R.onerror=function(j){T(j.target.error)},R.readAsArrayBuffer(C)}):C}).then(function(C){var I=d.getTypeOf(C);return I?(I==="arraybuffer"?C=d.transformTo("uint8array",C):I==="string"&&(k?C=r.decode(C):c&&y!==!0&&(C=function(T){return _(T,i.uint8array?new Uint8Array(T.length):new Array(T.length))}(C))),C):a.Promise.reject(new Error("Can't read the data of '"+o+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,v,d){var i=s("./reader/readerFor"),r=s("./utils"),e=s("./signature"),a=s("./zipEntry"),f=s("./support");function _(p){this.files=[],this.loadOptions=p}_.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(b)+", expected "+r.pretty(p)+")")}},isSignature:function(p,b){var l=this.reader.index;this.reader.setIndex(p);var m=this.reader.readString(4)===b;return this.reader.setIndex(l),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),b=f.uint8array?"uint8array":"array",l=r.transformTo(b,p);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,b,l,m=this.zip64EndOfCentralSize-44;0<m;)p=this.reader.readInt(2),b=this.reader.readInt(4),l=this.reader.readData(b),this.zip64ExtensibleData[p]={id:p,length:b,value:l}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,b;for(p=0;p<this.files.length;p++)b=this.files[p],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(e.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(p=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var b=p;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var l=this.centralDirOffset+this.centralDirSize;this.zip64&&(l+=20,l+=12+this.zip64EndOfCentralSize);var m=b-l;if(0<m)this.isSignature(b,e.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(p){this.reader=i(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},v.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,v,d){var i=s("./reader/readerFor"),r=s("./utils"),e=s("./compressedObject"),a=s("./crc32"),f=s("./utf8"),_=s("./compressions"),p=s("./support");function b(l,m){this.options=l,this.loadOptions=m}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(l){var m,o;if(l.skip(22),this.fileNameLength=l.readInt(2),o=l.readInt(2),this.fileName=l.readData(this.fileNameLength),l.skip(o),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(u){for(var c in _)if(Object.prototype.hasOwnProperty.call(_,c)&&_[c].magic===u)return _[c];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new e(this.compressedSize,this.uncompressedSize,this.crc32,m,l.readData(this.compressedSize))},readCentralPart:function(l){this.versionMadeBy=l.readInt(2),l.skip(2),this.bitFlag=l.readInt(2),this.compressionMethod=l.readString(2),this.date=l.readDate(),this.crc32=l.readInt(4),this.compressedSize=l.readInt(4),this.uncompressedSize=l.readInt(4);var m=l.readInt(2);if(this.extraFieldsLength=l.readInt(2),this.fileCommentLength=l.readInt(2),this.diskNumberStart=l.readInt(2),this.internalFileAttributes=l.readInt(2),this.externalFileAttributes=l.readInt(4),this.localHeaderOffset=l.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");l.skip(m),this.readExtraFields(l),this.parseZIP64ExtraField(l),this.fileComment=l.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var l=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),l==0&&(this.dosPermissions=63&this.externalFileAttributes),l==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var l=i(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=l.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=l.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=l.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=l.readInt(4))}},readExtraFields:function(l){var m,o,u,c=l.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});l.index+4<c;)m=l.readInt(2),o=l.readInt(2),u=l.readData(o),this.extraFields[m]={id:m,length:o,value:u};l.setIndex(c)},handleUTF8:function(){var l=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var o=r.transformTo(l,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(o)}var u=this.findExtraFieldUnicodeComment();if(u!==null)this.fileCommentStr=u;else{var c=r.transformTo(l,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(c)}}},findExtraFieldUnicodePath:function(){var l=this.extraFields[28789];if(l){var m=i(l.value);return m.readInt(1)!==1||a(this.fileName)!==m.readInt(4)?null:f.utf8decode(m.readData(l.length-5))}return null},findExtraFieldUnicodeComment:function(){var l=this.extraFields[25461];if(l){var m=i(l.value);return m.readInt(1)!==1||a(this.fileComment)!==m.readInt(4)?null:f.utf8decode(m.readData(l.length-5))}return null}},v.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,v,d){function i(m,o,u){this.name=m,this.dir=u.dir,this.date=u.date,this.comment=u.comment,this.unixPermissions=u.unixPermissions,this.dosPermissions=u.dosPermissions,this._data=o,this._dataBinary=u.binary,this.options={compression:u.compression,compressionOptions:u.compressionOptions}}var r=s("./stream/StreamHelper"),e=s("./stream/DataWorker"),a=s("./utf8"),f=s("./compressedObject"),_=s("./stream/GenericWorker");i.prototype={internalStream:function(m){var o=null,u="string";try{if(!m)throw new Error("No output type specified.");var c=(u=m.toLowerCase())==="string"||u==="text";u!=="binarystring"&&u!=="text"||(u="string"),o=this._decompressWorker();var y=!this._dataBinary;y&&!c&&(o=o.pipe(new a.Utf8EncodeWorker)),!y&&c&&(o=o.pipe(new a.Utf8DecodeWorker))}catch(k){(o=new _("error")).error(k)}return new r(o,u,"")},async:function(m,o){return this.internalStream(m).accumulate(o)},nodeStream:function(m,o){return this.internalStream(m||"nodebuffer").toNodejsStream(o)},_compressWorker:function(m,o){if(this._data instanceof f&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var u=this._decompressWorker();return this._dataBinary||(u=u.pipe(new a.Utf8EncodeWorker)),f.createWorkerFrom(u,m,o)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof _?this._data:new e(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<p.length;l++)i.prototype[p[l]]=b;v.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,v,d){(function(i){var r,e,a=i.MutationObserver||i.WebKitMutationObserver;if(a){var f=0,_=new a(m),p=i.document.createTextNode("");_.observe(p,{characterData:!0}),r=function(){p.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)r="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var o=i.document.createElement("script");o.onreadystatechange=function(){m(),o.onreadystatechange=null,o.parentNode.removeChild(o),o=null},i.document.documentElement.appendChild(o)}:function(){setTimeout(m,0)};else{var b=new i.MessageChannel;b.port1.onmessage=m,r=function(){b.port2.postMessage(0)}}var l=[];function m(){var o,u;e=!0;for(var c=l.length;c;){for(u=l,l=[],o=-1;++o<c;)u[o]();c=l.length}e=!1}v.exports=function(o){l.push(o)!==1||e||r()}}).call(this,typeof Yt<"u"?Yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,v,d){var i=s("immediate");function r(){}var e={},a=["REJECTED"],f=["FULFILLED"],_=["PENDING"];function p(c){if(typeof c!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,c!==r&&o(this,c)}function b(c,y,k){this.promise=c,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function l(c,y,k){i(function(){var C;try{C=y(k)}catch(I){return e.reject(c,I)}C===c?e.reject(c,new TypeError("Cannot resolve promise with itself")):e.resolve(c,C)})}function m(c){var y=c&&c.then;if(c&&(typeof c=="object"||typeof c=="function")&&typeof y=="function")return function(){y.apply(c,arguments)}}function o(c,y){var k=!1;function C(R){k||(k=!0,e.reject(c,R))}function I(R){k||(k=!0,e.resolve(c,R))}var T=u(function(){y(I,C)});T.status==="error"&&C(T.value)}function u(c,y){var k={};try{k.value=c(y),k.status="success"}catch(C){k.status="error",k.value=C}return k}(v.exports=p).prototype.finally=function(c){if(typeof c!="function")return this;var y=this.constructor;return this.then(function(k){return y.resolve(c()).then(function(){return k})},function(k){return y.resolve(c()).then(function(){throw k})})},p.prototype.catch=function(c){return this.then(null,c)},p.prototype.then=function(c,y){if(typeof c!="function"&&this.state===f||typeof y!="function"&&this.state===a)return this;var k=new this.constructor(r);return this.state!==_?l(k,this.state===f?c:y,this.outcome):this.queue.push(new b(k,c,y)),k},b.prototype.callFulfilled=function(c){e.resolve(this.promise,c)},b.prototype.otherCallFulfilled=function(c){l(this.promise,this.onFulfilled,c)},b.prototype.callRejected=function(c){e.reject(this.promise,c)},b.prototype.otherCallRejected=function(c){l(this.promise,this.onRejected,c)},e.resolve=function(c,y){var k=u(m,y);if(k.status==="error")return e.reject(c,k.value);var C=k.value;if(C)o(c,C);else{c.state=f,c.outcome=y;for(var I=-1,T=c.queue.length;++I<T;)c.queue[I].callFulfilled(y)}return c},e.reject=function(c,y){c.state=a,c.outcome=y;for(var k=-1,C=c.queue.length;++k<C;)c.queue[k].callRejected(y);return c},p.resolve=function(c){return c instanceof this?c:e.resolve(new this(r),c)},p.reject=function(c){var y=new this(r);return e.reject(y,c)},p.all=function(c){var y=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=c.length,C=!1;if(!k)return this.resolve([]);for(var I=new Array(k),T=0,R=-1,j=new this(r);++R<k;)L(c[R],R);return j;function L(Z,V){y.resolve(Z).then(function(w){I[V]=w,++T!==k||C||(C=!0,e.resolve(j,I))},function(w){C||(C=!0,e.reject(j,w))})}},p.race=function(c){var y=this;if(Object.prototype.toString.call(c)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=c.length,C=!1;if(!k)return this.resolve([]);for(var I=-1,T=new this(r);++I<k;)R=c[I],y.resolve(R).then(function(j){C||(C=!0,e.resolve(T,j))},function(j){C||(C=!0,e.reject(T,j))});var R;return T}},{immediate:36}],38:[function(s,v,d){var i={};(0,s("./lib/utils/common").assign)(i,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),v.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,v,d){var i=s("./zlib/deflate"),r=s("./utils/common"),e=s("./utils/strings"),a=s("./zlib/messages"),f=s("./zlib/zstream"),_=Object.prototype.toString,p=0,b=-1,l=0,m=8;function o(c){if(!(this instanceof o))return new o(c);this.options=r.assign({level:b,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},c||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var k=i.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(k!==p)throw new Error(a[k]);if(y.header&&i.deflateSetHeader(this.strm,y.header),y.dictionary){var C;if(C=typeof y.dictionary=="string"?e.string2buf(y.dictionary):_.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(k=i.deflateSetDictionary(this.strm,C))!==p)throw new Error(a[k]);this._dict_set=!0}}function u(c,y){var k=new o(y);if(k.push(c,!0),k.err)throw k.msg||a[k.err];return k.result}o.prototype.push=function(c,y){var k,C,I=this.strm,T=this.options.chunkSize;if(this.ended)return!1;C=y===~~y?y:y===!0?4:0,typeof c=="string"?I.input=e.string2buf(c):_.call(c)==="[object ArrayBuffer]"?I.input=new Uint8Array(c):I.input=c,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new r.Buf8(T),I.next_out=0,I.avail_out=T),(k=i.deflate(I,C))!==1&&k!==p)return this.onEnd(k),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(e.buf2binstring(r.shrinkBuf(I.output,I.next_out))):this.onData(r.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&k!==1);return C===4?(k=i.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===p):C!==2||(this.onEnd(p),!(I.avail_out=0))},o.prototype.onData=function(c){this.chunks.push(c)},o.prototype.onEnd=function(c){c===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=c,this.msg=this.strm.msg},d.Deflate=o,d.deflate=u,d.deflateRaw=function(c,y){return(y=y||{}).raw=!0,u(c,y)},d.gzip=function(c,y){return(y=y||{}).gzip=!0,u(c,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,v,d){var i=s("./zlib/inflate"),r=s("./utils/common"),e=s("./utils/strings"),a=s("./zlib/constants"),f=s("./zlib/messages"),_=s("./zlib/zstream"),p=s("./zlib/gzheader"),b=Object.prototype.toString;function l(o){if(!(this instanceof l))return new l(o);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},o||{});var u=this.options;u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(0<=u.windowBits&&u.windowBits<16)||o&&o.windowBits||(u.windowBits+=32),15<u.windowBits&&u.windowBits<48&&!(15&u.windowBits)&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var c=i.inflateInit2(this.strm,u.windowBits);if(c!==a.Z_OK)throw new Error(f[c]);this.header=new p,i.inflateGetHeader(this.strm,this.header)}function m(o,u){var c=new l(u);if(c.push(o,!0),c.err)throw c.msg||f[c.err];return c.result}l.prototype.push=function(o,u){var c,y,k,C,I,T,R=this.strm,j=this.options.chunkSize,L=this.options.dictionary,Z=!1;if(this.ended)return!1;y=u===~~u?u:u===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof o=="string"?R.input=e.binstring2buf(o):b.call(o)==="[object ArrayBuffer]"?R.input=new Uint8Array(o):R.input=o,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new r.Buf8(j),R.next_out=0,R.avail_out=j),(c=i.inflate(R,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&L&&(T=typeof L=="string"?e.string2buf(L):b.call(L)==="[object ArrayBuffer]"?new Uint8Array(L):L,c=i.inflateSetDictionary(this.strm,T)),c===a.Z_BUF_ERROR&&Z===!0&&(c=a.Z_OK,Z=!1),c!==a.Z_STREAM_END&&c!==a.Z_OK)return this.onEnd(c),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&c!==a.Z_STREAM_END&&(R.avail_in!==0||y!==a.Z_FINISH&&y!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=e.utf8border(R.output,R.next_out),C=R.next_out-k,I=e.buf2string(R.output,k),R.next_out=C,R.avail_out=j-C,C&&r.arraySet(R.output,R.output,k,C,0),this.onData(I)):this.onData(r.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(Z=!0)}while((0<R.avail_in||R.avail_out===0)&&c!==a.Z_STREAM_END);return c===a.Z_STREAM_END&&(y=a.Z_FINISH),y===a.Z_FINISH?(c=i.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===a.Z_OK):y!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(R.avail_out=0))},l.prototype.onData=function(o){this.chunks.push(o)},l.prototype.onEnd=function(o){o===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=o,this.msg=this.strm.msg},d.Inflate=l,d.inflate=m,d.inflateRaw=function(o,u){return(u=u||{}).raw=!0,m(o,u)},d.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,v,d){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(a){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var _=f.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var p in _)_.hasOwnProperty(p)&&(a[p]=_[p])}}return a},d.shrinkBuf=function(a,f){return a.length===f?a:a.subarray?a.subarray(0,f):(a.length=f,a)};var r={arraySet:function(a,f,_,p,b){if(f.subarray&&a.subarray)a.set(f.subarray(_,_+p),b);else for(var l=0;l<p;l++)a[b+l]=f[_+l]},flattenChunks:function(a){var f,_,p,b,l,m;for(f=p=0,_=a.length;f<_;f++)p+=a[f].length;for(m=new Uint8Array(p),f=b=0,_=a.length;f<_;f++)l=a[f],m.set(l,b),b+=l.length;return m}},e={arraySet:function(a,f,_,p,b){for(var l=0;l<p;l++)a[b+l]=f[_+l]},flattenChunks:function(a){return[].concat.apply([],a)}};d.setTyped=function(a){a?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,r)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,e))},d.setTyped(i)},{}],42:[function(s,v,d){var i=s("./common"),r=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e=!1}for(var a=new i.Buf8(256),f=0;f<256;f++)a[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function _(p,b){if(b<65537&&(p.subarray&&e||!p.subarray&&r))return String.fromCharCode.apply(null,i.shrinkBuf(p,b));for(var l="",m=0;m<b;m++)l+=String.fromCharCode(p[m]);return l}a[254]=a[254]=1,d.string2buf=function(p){var b,l,m,o,u,c=p.length,y=0;for(o=0;o<c;o++)(64512&(l=p.charCodeAt(o)))==55296&&o+1<c&&(64512&(m=p.charCodeAt(o+1)))==56320&&(l=65536+(l-55296<<10)+(m-56320),o++),y+=l<128?1:l<2048?2:l<65536?3:4;for(b=new i.Buf8(y),o=u=0;u<y;o++)(64512&(l=p.charCodeAt(o)))==55296&&o+1<c&&(64512&(m=p.charCodeAt(o+1)))==56320&&(l=65536+(l-55296<<10)+(m-56320),o++),l<128?b[u++]=l:(l<2048?b[u++]=192|l>>>6:(l<65536?b[u++]=224|l>>>12:(b[u++]=240|l>>>18,b[u++]=128|l>>>12&63),b[u++]=128|l>>>6&63),b[u++]=128|63&l);return b},d.buf2binstring=function(p){return _(p,p.length)},d.binstring2buf=function(p){for(var b=new i.Buf8(p.length),l=0,m=b.length;l<m;l++)b[l]=p.charCodeAt(l);return b},d.buf2string=function(p,b){var l,m,o,u,c=b||p.length,y=new Array(2*c);for(l=m=0;l<c;)if((o=p[l++])<128)y[m++]=o;else if(4<(u=a[o]))y[m++]=65533,l+=u-1;else{for(o&=u===2?31:u===3?15:7;1<u&&l<c;)o=o<<6|63&p[l++],u--;1<u?y[m++]=65533:o<65536?y[m++]=o:(o-=65536,y[m++]=55296|o>>10&1023,y[m++]=56320|1023&o)}return _(y,m)},d.utf8border=function(p,b){var l;for((b=b||p.length)>p.length&&(b=p.length),l=b-1;0<=l&&(192&p[l])==128;)l--;return l<0||l===0?b:l+a[p[l]]>b?l:b}},{"./common":41}],43:[function(s,v,d){v.exports=function(i,r,e,a){for(var f=65535&i|0,_=i>>>16&65535|0,p=0;e!==0;){for(e-=p=2e3<e?2e3:e;_=_+(f=f+r[a++]|0)|0,--p;);f%=65521,_%=65521}return f|_<<16|0}},{}],44:[function(s,v,d){v.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,v,d){var i=function(){for(var r,e=[],a=0;a<256;a++){r=a;for(var f=0;f<8;f++)r=1&r?3988292384^r>>>1:r>>>1;e[a]=r}return e}();v.exports=function(r,e,a,f){var _=i,p=f+a;r^=-1;for(var b=f;b<p;b++)r=r>>>8^_[255&(r^e[b])];return-1^r}},{}],46:[function(s,v,d){var i,r=s("../utils/common"),e=s("./trees"),a=s("./adler32"),f=s("./crc32"),_=s("./messages"),p=0,b=4,l=0,m=-2,o=-1,u=4,c=2,y=8,k=9,C=286,I=30,T=19,R=2*C+1,j=15,L=3,Z=258,V=Z+L+1,w=42,D=113,n=1,N=2,Q=3,M=4;function tt(t,F){return t.msg=_[F],F}function W(t){return(t<<1)-(4<t?9:0)}function J(t){for(var F=t.length;0<=--F;)t[F]=0}function B(t){var F=t.state,O=F.pending;O>t.avail_out&&(O=t.avail_out),O!==0&&(r.arraySet(t.output,F.pending_buf,F.pending_out,O,t.next_out),t.next_out+=O,F.pending_out+=O,t.total_out+=O,t.avail_out-=O,F.pending-=O,F.pending===0&&(F.pending_out=0))}function A(t,F){e._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,F),t.block_start=t.strstart,B(t.strm)}function X(t,F){t.pending_buf[t.pending++]=F}function q(t,F){t.pending_buf[t.pending++]=F>>>8&255,t.pending_buf[t.pending++]=255&F}function $(t,F){var O,g,h=t.max_chain_length,S=t.strstart,P=t.prev_length,U=t.nice_match,z=t.strstart>t.w_size-V?t.strstart-(t.w_size-V):0,G=t.window,Y=t.w_mask,H=t.prev,K=t.strstart+Z,it=G[S+P-1],nt=G[S+P];t.prev_length>=t.good_match&&(h>>=2),U>t.lookahead&&(U=t.lookahead);do if(G[(O=F)+P]===nt&&G[O+P-1]===it&&G[O]===G[S]&&G[++O]===G[S+1]){S+=2,O++;do;while(G[++S]===G[++O]&&G[++S]===G[++O]&&G[++S]===G[++O]&&G[++S]===G[++O]&&G[++S]===G[++O]&&G[++S]===G[++O]&&G[++S]===G[++O]&&G[++S]===G[++O]&&S<K);if(g=Z-(K-S),S=K-Z,P<g){if(t.match_start=F,U<=(P=g))break;it=G[S+P-1],nt=G[S+P]}}while((F=H[F&Y])>z&&--h!=0);return P<=t.lookahead?P:t.lookahead}function at(t){var F,O,g,h,S,P,U,z,G,Y,H=t.w_size;do{if(h=t.window_size-t.lookahead-t.strstart,t.strstart>=H+(H-V)){for(r.arraySet(t.window,t.window,H,H,0),t.match_start-=H,t.strstart-=H,t.block_start-=H,F=O=t.hash_size;g=t.head[--F],t.head[F]=H<=g?g-H:0,--O;);for(F=O=H;g=t.prev[--F],t.prev[F]=H<=g?g-H:0,--O;);h+=H}if(t.strm.avail_in===0)break;if(P=t.strm,U=t.window,z=t.strstart+t.lookahead,G=h,Y=void 0,Y=P.avail_in,G<Y&&(Y=G),O=Y===0?0:(P.avail_in-=Y,r.arraySet(U,P.input,P.next_in,Y,z),P.state.wrap===1?P.adler=a(P.adler,U,Y,z):P.state.wrap===2&&(P.adler=f(P.adler,U,Y,z)),P.next_in+=Y,P.total_in+=Y,Y),t.lookahead+=O,t.lookahead+t.insert>=L)for(S=t.strstart-t.insert,t.ins_h=t.window[S],t.ins_h=(t.ins_h<<t.hash_shift^t.window[S+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[S+L-1])&t.hash_mask,t.prev[S&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=S,S++,t.insert--,!(t.lookahead+t.insert<L)););}while(t.lookahead<V&&t.strm.avail_in!==0)}function pt(t,F){for(var O,g;;){if(t.lookahead<V){if(at(t),t.lookahead<V&&F===p)return n;if(t.lookahead===0)break}if(O=0,t.lookahead>=L&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),O!==0&&t.strstart-O<=t.w_size-V&&(t.match_length=$(t,O)),t.match_length>=L)if(g=e._tr_tally(t,t.strstart-t.match_start,t.match_length-L),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=L){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,--t.match_length!=0;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else g=e._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(g&&(A(t,!1),t.strm.avail_out===0))return n}return t.insert=t.strstart<L-1?t.strstart:L-1,F===b?(A(t,!0),t.strm.avail_out===0?Q:M):t.last_lit&&(A(t,!1),t.strm.avail_out===0)?n:N}function et(t,F){for(var O,g,h;;){if(t.lookahead<V){if(at(t),t.lookahead<V&&F===p)return n;if(t.lookahead===0)break}if(O=0,t.lookahead>=L&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=L-1,O!==0&&t.prev_length<t.max_lazy_match&&t.strstart-O<=t.w_size-V&&(t.match_length=$(t,O),t.match_length<=5&&(t.strategy===1||t.match_length===L&&4096<t.strstart-t.match_start)&&(t.match_length=L-1)),t.prev_length>=L&&t.match_length<=t.prev_length){for(h=t.strstart+t.lookahead-L,g=e._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-L),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=h&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+L-1])&t.hash_mask,O=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),--t.prev_length!=0;);if(t.match_available=0,t.match_length=L-1,t.strstart++,g&&(A(t,!1),t.strm.avail_out===0))return n}else if(t.match_available){if((g=e._tr_tally(t,0,t.window[t.strstart-1]))&&A(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return n}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(g=e._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<L-1?t.strstart:L-1,F===b?(A(t,!0),t.strm.avail_out===0?Q:M):t.last_lit&&(A(t,!1),t.strm.avail_out===0)?n:N}function rt(t,F,O,g,h){this.good_length=t,this.max_lazy=F,this.nice_length=O,this.max_chain=g,this.func=h}function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*R),this.dyn_dtree=new r.Buf16(2*(2*I+1)),this.bl_tree=new r.Buf16(2*(2*T+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(j+1),this.heap=new r.Buf16(2*C+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*C+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function st(t){var F;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=c,(F=t.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?w:D,t.adler=F.wrap===2?0:1,F.last_flush=p,e._tr_init(F),l):tt(t,m)}function xt(t){var F=st(t);return F===l&&function(O){O.window_size=2*O.w_size,J(O.head),O.max_lazy_match=i[O.level].max_lazy,O.good_match=i[O.level].good_length,O.nice_match=i[O.level].nice_length,O.max_chain_length=i[O.level].max_chain,O.strstart=0,O.block_start=0,O.lookahead=0,O.insert=0,O.match_length=O.prev_length=L-1,O.match_available=0,O.ins_h=0}(t.state),F}function kt(t,F,O,g,h,S){if(!t)return m;var P=1;if(F===o&&(F=6),g<0?(P=0,g=-g):15<g&&(P=2,g-=16),h<1||k<h||O!==y||g<8||15<g||F<0||9<F||S<0||u<S)return tt(t,m);g===8&&(g=9);var U=new ht;return(t.state=U).strm=t,U.wrap=P,U.gzhead=null,U.w_bits=g,U.w_size=1<<U.w_bits,U.w_mask=U.w_size-1,U.hash_bits=h+7,U.hash_size=1<<U.hash_bits,U.hash_mask=U.hash_size-1,U.hash_shift=~~((U.hash_bits+L-1)/L),U.window=new r.Buf8(2*U.w_size),U.head=new r.Buf16(U.hash_size),U.prev=new r.Buf16(U.w_size),U.lit_bufsize=1<<h+6,U.pending_buf_size=4*U.lit_bufsize,U.pending_buf=new r.Buf8(U.pending_buf_size),U.d_buf=1*U.lit_bufsize,U.l_buf=3*U.lit_bufsize,U.level=F,U.strategy=S,U.method=O,xt(t)}i=[new rt(0,0,0,0,function(t,F){var O=65535;for(O>t.pending_buf_size-5&&(O=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),t.lookahead===0&&F===p)return n;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var g=t.block_start+O;if((t.strstart===0||t.strstart>=g)&&(t.lookahead=t.strstart-g,t.strstart=g,A(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-V&&(A(t,!1),t.strm.avail_out===0))return n}return t.insert=0,F===b?(A(t,!0),t.strm.avail_out===0?Q:M):(t.strstart>t.block_start&&(A(t,!1),t.strm.avail_out),n)}),new rt(4,4,8,4,pt),new rt(4,5,16,8,pt),new rt(4,6,32,32,pt),new rt(4,4,16,16,et),new rt(8,16,32,32,et),new rt(8,16,128,128,et),new rt(8,32,128,256,et),new rt(32,128,258,1024,et),new rt(32,258,258,4096,et)],d.deflateInit=function(t,F){return kt(t,F,y,15,8,0)},d.deflateInit2=kt,d.deflateReset=xt,d.deflateResetKeep=st,d.deflateSetHeader=function(t,F){return t&&t.state?t.state.wrap!==2?m:(t.state.gzhead=F,l):m},d.deflate=function(t,F){var O,g,h,S;if(!t||!t.state||5<F||F<0)return t?tt(t,m):m;if(g=t.state,!t.output||!t.input&&t.avail_in!==0||g.status===666&&F!==b)return tt(t,t.avail_out===0?-5:m);if(g.strm=t,O=g.last_flush,g.last_flush=F,g.status===w)if(g.wrap===2)t.adler=0,X(g,31),X(g,139),X(g,8),g.gzhead?(X(g,(g.gzhead.text?1:0)+(g.gzhead.hcrc?2:0)+(g.gzhead.extra?4:0)+(g.gzhead.name?8:0)+(g.gzhead.comment?16:0)),X(g,255&g.gzhead.time),X(g,g.gzhead.time>>8&255),X(g,g.gzhead.time>>16&255),X(g,g.gzhead.time>>24&255),X(g,g.level===9?2:2<=g.strategy||g.level<2?4:0),X(g,255&g.gzhead.os),g.gzhead.extra&&g.gzhead.extra.length&&(X(g,255&g.gzhead.extra.length),X(g,g.gzhead.extra.length>>8&255)),g.gzhead.hcrc&&(t.adler=f(t.adler,g.pending_buf,g.pending,0)),g.gzindex=0,g.status=69):(X(g,0),X(g,0),X(g,0),X(g,0),X(g,0),X(g,g.level===9?2:2<=g.strategy||g.level<2?4:0),X(g,3),g.status=D);else{var P=y+(g.w_bits-8<<4)<<8;P|=(2<=g.strategy||g.level<2?0:g.level<6?1:g.level===6?2:3)<<6,g.strstart!==0&&(P|=32),P+=31-P%31,g.status=D,q(g,P),g.strstart!==0&&(q(g,t.adler>>>16),q(g,65535&t.adler)),t.adler=1}if(g.status===69)if(g.gzhead.extra){for(h=g.pending;g.gzindex<(65535&g.gzhead.extra.length)&&(g.pending!==g.pending_buf_size||(g.gzhead.hcrc&&g.pending>h&&(t.adler=f(t.adler,g.pending_buf,g.pending-h,h)),B(t),h=g.pending,g.pending!==g.pending_buf_size));)X(g,255&g.gzhead.extra[g.gzindex]),g.gzindex++;g.gzhead.hcrc&&g.pending>h&&(t.adler=f(t.adler,g.pending_buf,g.pending-h,h)),g.gzindex===g.gzhead.extra.length&&(g.gzindex=0,g.status=73)}else g.status=73;if(g.status===73)if(g.gzhead.name){h=g.pending;do{if(g.pending===g.pending_buf_size&&(g.gzhead.hcrc&&g.pending>h&&(t.adler=f(t.adler,g.pending_buf,g.pending-h,h)),B(t),h=g.pending,g.pending===g.pending_buf_size)){S=1;break}S=g.gzindex<g.gzhead.name.length?255&g.gzhead.name.charCodeAt(g.gzindex++):0,X(g,S)}while(S!==0);g.gzhead.hcrc&&g.pending>h&&(t.adler=f(t.adler,g.pending_buf,g.pending-h,h)),S===0&&(g.gzindex=0,g.status=91)}else g.status=91;if(g.status===91)if(g.gzhead.comment){h=g.pending;do{if(g.pending===g.pending_buf_size&&(g.gzhead.hcrc&&g.pending>h&&(t.adler=f(t.adler,g.pending_buf,g.pending-h,h)),B(t),h=g.pending,g.pending===g.pending_buf_size)){S=1;break}S=g.gzindex<g.gzhead.comment.length?255&g.gzhead.comment.charCodeAt(g.gzindex++):0,X(g,S)}while(S!==0);g.gzhead.hcrc&&g.pending>h&&(t.adler=f(t.adler,g.pending_buf,g.pending-h,h)),S===0&&(g.status=103)}else g.status=103;if(g.status===103&&(g.gzhead.hcrc?(g.pending+2>g.pending_buf_size&&B(t),g.pending+2<=g.pending_buf_size&&(X(g,255&t.adler),X(g,t.adler>>8&255),t.adler=0,g.status=D)):g.status=D),g.pending!==0){if(B(t),t.avail_out===0)return g.last_flush=-1,l}else if(t.avail_in===0&&W(F)<=W(O)&&F!==b)return tt(t,-5);if(g.status===666&&t.avail_in!==0)return tt(t,-5);if(t.avail_in!==0||g.lookahead!==0||F!==p&&g.status!==666){var U=g.strategy===2?function(z,G){for(var Y;;){if(z.lookahead===0&&(at(z),z.lookahead===0)){if(G===p)return n;break}if(z.match_length=0,Y=e._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,Y&&(A(z,!1),z.strm.avail_out===0))return n}return z.insert=0,G===b?(A(z,!0),z.strm.avail_out===0?Q:M):z.last_lit&&(A(z,!1),z.strm.avail_out===0)?n:N}(g,F):g.strategy===3?function(z,G){for(var Y,H,K,it,nt=z.window;;){if(z.lookahead<=Z){if(at(z),z.lookahead<=Z&&G===p)return n;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=L&&0<z.strstart&&(H=nt[K=z.strstart-1])===nt[++K]&&H===nt[++K]&&H===nt[++K]){it=z.strstart+Z;do;while(H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&H===nt[++K]&&K<it);z.match_length=Z-(it-K),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=L?(Y=e._tr_tally(z,1,z.match_length-L),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(Y=e._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),Y&&(A(z,!1),z.strm.avail_out===0))return n}return z.insert=0,G===b?(A(z,!0),z.strm.avail_out===0?Q:M):z.last_lit&&(A(z,!1),z.strm.avail_out===0)?n:N}(g,F):i[g.level].func(g,F);if(U!==Q&&U!==M||(g.status=666),U===n||U===Q)return t.avail_out===0&&(g.last_flush=-1),l;if(U===N&&(F===1?e._tr_align(g):F!==5&&(e._tr_stored_block(g,0,0,!1),F===3&&(J(g.head),g.lookahead===0&&(g.strstart=0,g.block_start=0,g.insert=0))),B(t),t.avail_out===0))return g.last_flush=-1,l}return F!==b?l:g.wrap<=0?1:(g.wrap===2?(X(g,255&t.adler),X(g,t.adler>>8&255),X(g,t.adler>>16&255),X(g,t.adler>>24&255),X(g,255&t.total_in),X(g,t.total_in>>8&255),X(g,t.total_in>>16&255),X(g,t.total_in>>24&255)):(q(g,t.adler>>>16),q(g,65535&t.adler)),B(t),0<g.wrap&&(g.wrap=-g.wrap),g.pending!==0?l:1)},d.deflateEnd=function(t){var F;return t&&t.state?(F=t.state.status)!==w&&F!==69&&F!==73&&F!==91&&F!==103&&F!==D&&F!==666?tt(t,m):(t.state=null,F===D?tt(t,-3):l):m},d.deflateSetDictionary=function(t,F){var O,g,h,S,P,U,z,G,Y=F.length;if(!t||!t.state||(S=(O=t.state).wrap)===2||S===1&&O.status!==w||O.lookahead)return m;for(S===1&&(t.adler=a(t.adler,F,Y,0)),O.wrap=0,Y>=O.w_size&&(S===0&&(J(O.head),O.strstart=0,O.block_start=0,O.insert=0),G=new r.Buf8(O.w_size),r.arraySet(G,F,Y-O.w_size,O.w_size,0),F=G,Y=O.w_size),P=t.avail_in,U=t.next_in,z=t.input,t.avail_in=Y,t.next_in=0,t.input=F,at(O);O.lookahead>=L;){for(g=O.strstart,h=O.lookahead-(L-1);O.ins_h=(O.ins_h<<O.hash_shift^O.window[g+L-1])&O.hash_mask,O.prev[g&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=g,g++,--h;);O.strstart=g,O.lookahead=L-1,at(O)}return O.strstart+=O.lookahead,O.block_start=O.strstart,O.insert=O.lookahead,O.lookahead=0,O.match_length=O.prev_length=L-1,O.match_available=0,t.next_in=U,t.input=z,t.avail_in=P,O.wrap=S,l},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,v,d){v.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,v,d){v.exports=function(i,r){var e,a,f,_,p,b,l,m,o,u,c,y,k,C,I,T,R,j,L,Z,V,w,D,n,N;e=i.state,a=i.next_in,n=i.input,f=a+(i.avail_in-5),_=i.next_out,N=i.output,p=_-(r-i.avail_out),b=_+(i.avail_out-257),l=e.dmax,m=e.wsize,o=e.whave,u=e.wnext,c=e.window,y=e.hold,k=e.bits,C=e.lencode,I=e.distcode,T=(1<<e.lenbits)-1,R=(1<<e.distbits)-1;t:do{k<15&&(y+=n[a++]<<k,k+=8,y+=n[a++]<<k,k+=8),j=C[y&T];e:for(;;){if(y>>>=L=j>>>24,k-=L,(L=j>>>16&255)===0)N[_++]=65535&j;else{if(!(16&L)){if(!(64&L)){j=C[(65535&j)+(y&(1<<L)-1)];continue e}if(32&L){e.mode=12;break t}i.msg="invalid literal/length code",e.mode=30;break t}Z=65535&j,(L&=15)&&(k<L&&(y+=n[a++]<<k,k+=8),Z+=y&(1<<L)-1,y>>>=L,k-=L),k<15&&(y+=n[a++]<<k,k+=8,y+=n[a++]<<k,k+=8),j=I[y&R];n:for(;;){if(y>>>=L=j>>>24,k-=L,!(16&(L=j>>>16&255))){if(!(64&L)){j=I[(65535&j)+(y&(1<<L)-1)];continue n}i.msg="invalid distance code",e.mode=30;break t}if(V=65535&j,k<(L&=15)&&(y+=n[a++]<<k,(k+=8)<L&&(y+=n[a++]<<k,k+=8)),l<(V+=y&(1<<L)-1)){i.msg="invalid distance too far back",e.mode=30;break t}if(y>>>=L,k-=L,(L=_-p)<V){if(o<(L=V-L)&&e.sane){i.msg="invalid distance too far back",e.mode=30;break t}if(D=c,(w=0)===u){if(w+=m-L,L<Z){for(Z-=L;N[_++]=c[w++],--L;);w=_-V,D=N}}else if(u<L){if(w+=m+u-L,(L-=u)<Z){for(Z-=L;N[_++]=c[w++],--L;);if(w=0,u<Z){for(Z-=L=u;N[_++]=c[w++],--L;);w=_-V,D=N}}}else if(w+=u-L,L<Z){for(Z-=L;N[_++]=c[w++],--L;);w=_-V,D=N}for(;2<Z;)N[_++]=D[w++],N[_++]=D[w++],N[_++]=D[w++],Z-=3;Z&&(N[_++]=D[w++],1<Z&&(N[_++]=D[w++]))}else{for(w=_-V;N[_++]=N[w++],N[_++]=N[w++],N[_++]=N[w++],2<(Z-=3););Z&&(N[_++]=N[w++],1<Z&&(N[_++]=N[w++]))}break}}break}}while(a<f&&_<b);a-=Z=k>>3,y&=(1<<(k-=Z<<3))-1,i.next_in=a,i.next_out=_,i.avail_in=a<f?f-a+5:5-(a-f),i.avail_out=_<b?b-_+257:257-(_-b),e.hold=y,e.bits=k}},{}],49:[function(s,v,d){var i=s("../utils/common"),r=s("./adler32"),e=s("./crc32"),a=s("./inffast"),f=s("./inftrees"),_=1,p=2,b=0,l=-2,m=1,o=852,u=592;function c(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(w){var D;return w&&w.state?(D=w.state,w.total_in=w.total_out=D.total=0,w.msg="",D.wrap&&(w.adler=1&D.wrap),D.mode=m,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new i.Buf32(o),D.distcode=D.distdyn=new i.Buf32(u),D.sane=1,D.back=-1,b):l}function C(w){var D;return w&&w.state?((D=w.state).wsize=0,D.whave=0,D.wnext=0,k(w)):l}function I(w,D){var n,N;return w&&w.state?(N=w.state,D<0?(n=0,D=-D):(n=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?l:(N.window!==null&&N.wbits!==D&&(N.window=null),N.wrap=n,N.wbits=D,C(w))):l}function T(w,D){var n,N;return w?(N=new y,(w.state=N).window=null,(n=I(w,D))!==b&&(w.state=null),n):l}var R,j,L=!0;function Z(w){if(L){var D;for(R=new i.Buf32(512),j=new i.Buf32(32),D=0;D<144;)w.lens[D++]=8;for(;D<256;)w.lens[D++]=9;for(;D<280;)w.lens[D++]=7;for(;D<288;)w.lens[D++]=8;for(f(_,w.lens,0,288,R,0,w.work,{bits:9}),D=0;D<32;)w.lens[D++]=5;f(p,w.lens,0,32,j,0,w.work,{bits:5}),L=!1}w.lencode=R,w.lenbits=9,w.distcode=j,w.distbits=5}function V(w,D,n,N){var Q,M=w.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new i.Buf8(M.wsize)),N>=M.wsize?(i.arraySet(M.window,D,n-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(N<(Q=M.wsize-M.wnext)&&(Q=N),i.arraySet(M.window,D,n-N,Q,M.wnext),(N-=Q)?(i.arraySet(M.window,D,n-N,N,0),M.wnext=N,M.whave=M.wsize):(M.wnext+=Q,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=Q))),0}d.inflateReset=C,d.inflateReset2=I,d.inflateResetKeep=k,d.inflateInit=function(w){return T(w,15)},d.inflateInit2=T,d.inflate=function(w,D){var n,N,Q,M,tt,W,J,B,A,X,q,$,at,pt,et,rt,ht,st,xt,kt,t,F,O,g,h=0,S=new i.Buf8(4),P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return l;(n=w.state).mode===12&&(n.mode=13),tt=w.next_out,Q=w.output,J=w.avail_out,M=w.next_in,N=w.input,W=w.avail_in,B=n.hold,A=n.bits,X=W,q=J,F=b;t:for(;;)switch(n.mode){case m:if(n.wrap===0){n.mode=13;break}for(;A<16;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(2&n.wrap&&B===35615){S[n.check=0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0),A=B=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&B)<<8)+(B>>8))%31){w.msg="incorrect header check",n.mode=30;break}if((15&B)!=8){w.msg="unknown compression method",n.mode=30;break}if(A-=4,t=8+(15&(B>>>=4)),n.wbits===0)n.wbits=t;else if(t>n.wbits){w.msg="invalid window size",n.mode=30;break}n.dmax=1<<t,w.adler=n.check=1,n.mode=512&B?10:12,A=B=0;break;case 2:for(;A<16;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(n.flags=B,(255&n.flags)!=8){w.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){w.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=B>>8&1),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0)),A=B=0,n.mode=3;case 3:for(;A<32;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}n.head&&(n.head.time=B),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,S[2]=B>>>16&255,S[3]=B>>>24&255,n.check=e(n.check,S,4,0)),A=B=0,n.mode=4;case 4:for(;A<16;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}n.head&&(n.head.xflags=255&B,n.head.os=B>>8),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0)),A=B=0,n.mode=5;case 5:if(1024&n.flags){for(;A<16;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}n.length=B,n.head&&(n.head.extra_len=B),512&n.flags&&(S[0]=255&B,S[1]=B>>>8&255,n.check=e(n.check,S,2,0)),A=B=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(W<($=n.length)&&($=W),$&&(n.head&&(t=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,N,M,$,t)),512&n.flags&&(n.check=e(n.check,N,$,M)),W-=$,M+=$,n.length-=$),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(W===0)break t;for($=0;t=N[M+$++],n.head&&t&&n.length<65536&&(n.head.name+=String.fromCharCode(t)),t&&$<W;);if(512&n.flags&&(n.check=e(n.check,N,$,M)),W-=$,M+=$,t)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(W===0)break t;for($=0;t=N[M+$++],n.head&&t&&n.length<65536&&(n.head.comment+=String.fromCharCode(t)),t&&$<W;);if(512&n.flags&&(n.check=e(n.check,N,$,M)),W-=$,M+=$,t)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;A<16;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(B!==(65535&n.check)){w.msg="header crc mismatch",n.mode=30;break}A=B=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),w.adler=n.check=0,n.mode=12;break;case 10:for(;A<32;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}w.adler=n.check=c(B),A=B=0,n.mode=11;case 11:if(n.havedict===0)return w.next_out=tt,w.avail_out=J,w.next_in=M,w.avail_in=W,n.hold=B,n.bits=A,2;w.adler=n.check=1,n.mode=12;case 12:if(D===5||D===6)break t;case 13:if(n.last){B>>>=7&A,A-=7&A,n.mode=27;break}for(;A<3;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}switch(n.last=1&B,A-=1,3&(B>>>=1)){case 0:n.mode=14;break;case 1:if(Z(n),n.mode=20,D!==6)break;B>>>=2,A-=2;break t;case 2:n.mode=17;break;case 3:w.msg="invalid block type",n.mode=30}B>>>=2,A-=2;break;case 14:for(B>>>=7&A,A-=7&A;A<32;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if((65535&B)!=(B>>>16^65535)){w.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&B,A=B=0,n.mode=15,D===6)break t;case 15:n.mode=16;case 16:if($=n.length){if(W<$&&($=W),J<$&&($=J),$===0)break t;i.arraySet(Q,N,M,$,tt),W-=$,M+=$,J-=$,tt+=$,n.length-=$;break}n.mode=12;break;case 17:for(;A<14;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(n.nlen=257+(31&B),B>>>=5,A-=5,n.ndist=1+(31&B),B>>>=5,A-=5,n.ncode=4+(15&B),B>>>=4,A-=4,286<n.nlen||30<n.ndist){w.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;A<3;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}n.lens[P[n.have++]]=7&B,B>>>=3,A-=3}for(;n.have<19;)n.lens[P[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,O={bits:n.lenbits},F=f(0,n.lens,0,19,n.lencode,0,n.work,O),n.lenbits=O.bits,F){w.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;rt=(h=n.lencode[B&(1<<n.lenbits)-1])>>>16&255,ht=65535&h,!((et=h>>>24)<=A);){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(ht<16)B>>>=et,A-=et,n.lens[n.have++]=ht;else{if(ht===16){for(g=et+2;A<g;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(B>>>=et,A-=et,n.have===0){w.msg="invalid bit length repeat",n.mode=30;break}t=n.lens[n.have-1],$=3+(3&B),B>>>=2,A-=2}else if(ht===17){for(g=et+3;A<g;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}A-=et,t=0,$=3+(7&(B>>>=et)),B>>>=3,A-=3}else{for(g=et+7;A<g;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}A-=et,t=0,$=11+(127&(B>>>=et)),B>>>=7,A-=7}if(n.have+$>n.nlen+n.ndist){w.msg="invalid bit length repeat",n.mode=30;break}for(;$--;)n.lens[n.have++]=t}}if(n.mode===30)break;if(n.lens[256]===0){w.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,O={bits:n.lenbits},F=f(_,n.lens,0,n.nlen,n.lencode,0,n.work,O),n.lenbits=O.bits,F){w.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,O={bits:n.distbits},F=f(p,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,O),n.distbits=O.bits,F){w.msg="invalid distances set",n.mode=30;break}if(n.mode=20,D===6)break t;case 20:n.mode=21;case 21:if(6<=W&&258<=J){w.next_out=tt,w.avail_out=J,w.next_in=M,w.avail_in=W,n.hold=B,n.bits=A,a(w,q),tt=w.next_out,Q=w.output,J=w.avail_out,M=w.next_in,N=w.input,W=w.avail_in,B=n.hold,A=n.bits,n.mode===12&&(n.back=-1);break}for(n.back=0;rt=(h=n.lencode[B&(1<<n.lenbits)-1])>>>16&255,ht=65535&h,!((et=h>>>24)<=A);){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(rt&&!(240&rt)){for(st=et,xt=rt,kt=ht;rt=(h=n.lencode[kt+((B&(1<<st+xt)-1)>>st)])>>>16&255,ht=65535&h,!(st+(et=h>>>24)<=A);){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}B>>>=st,A-=st,n.back+=st}if(B>>>=et,A-=et,n.back+=et,n.length=ht,rt===0){n.mode=26;break}if(32&rt){n.back=-1,n.mode=12;break}if(64&rt){w.msg="invalid literal/length code",n.mode=30;break}n.extra=15&rt,n.mode=22;case 22:if(n.extra){for(g=n.extra;A<g;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}n.length+=B&(1<<n.extra)-1,B>>>=n.extra,A-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;rt=(h=n.distcode[B&(1<<n.distbits)-1])>>>16&255,ht=65535&h,!((et=h>>>24)<=A);){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(!(240&rt)){for(st=et,xt=rt,kt=ht;rt=(h=n.distcode[kt+((B&(1<<st+xt)-1)>>st)])>>>16&255,ht=65535&h,!(st+(et=h>>>24)<=A);){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}B>>>=st,A-=st,n.back+=st}if(B>>>=et,A-=et,n.back+=et,64&rt){w.msg="invalid distance code",n.mode=30;break}n.offset=ht,n.extra=15&rt,n.mode=24;case 24:if(n.extra){for(g=n.extra;A<g;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}n.offset+=B&(1<<n.extra)-1,B>>>=n.extra,A-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){w.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(J===0)break t;if($=q-J,n.offset>$){if(($=n.offset-$)>n.whave&&n.sane){w.msg="invalid distance too far back",n.mode=30;break}at=$>n.wnext?($-=n.wnext,n.wsize-$):n.wnext-$,$>n.length&&($=n.length),pt=n.window}else pt=Q,at=tt-n.offset,$=n.length;for(J<$&&($=J),J-=$,n.length-=$;Q[tt++]=pt[at++],--$;);n.length===0&&(n.mode=21);break;case 26:if(J===0)break t;Q[tt++]=n.length,J--,n.mode=21;break;case 27:if(n.wrap){for(;A<32;){if(W===0)break t;W--,B|=N[M++]<<A,A+=8}if(q-=J,w.total_out+=q,n.total+=q,q&&(w.adler=n.check=n.flags?e(n.check,Q,q,tt-q):r(n.check,Q,q,tt-q)),q=J,(n.flags?B:c(B))!==n.check){w.msg="incorrect data check",n.mode=30;break}A=B=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;A<32;){if(W===0)break t;W--,B+=N[M++]<<A,A+=8}if(B!==(4294967295&n.total)){w.msg="incorrect length check",n.mode=30;break}A=B=0}n.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return l}return w.next_out=tt,w.avail_out=J,w.next_in=M,w.avail_in=W,n.hold=B,n.bits=A,(n.wsize||q!==w.avail_out&&n.mode<30&&(n.mode<27||D!==4))&&V(w,w.output,w.next_out,q-w.avail_out)?(n.mode=31,-4):(X-=w.avail_in,q-=w.avail_out,w.total_in+=X,w.total_out+=q,n.total+=q,n.wrap&&q&&(w.adler=n.check=n.flags?e(n.check,Q,q,w.next_out-q):r(n.check,Q,q,w.next_out-q)),w.data_type=n.bits+(n.last?64:0)+(n.mode===12?128:0)+(n.mode===20||n.mode===15?256:0),(X==0&&q===0||D===4)&&F===b&&(F=-5),F)},d.inflateEnd=function(w){if(!w||!w.state)return l;var D=w.state;return D.window&&(D.window=null),w.state=null,b},d.inflateGetHeader=function(w,D){var n;return w&&w.state&&2&(n=w.state).wrap?((n.head=D).done=!1,b):l},d.inflateSetDictionary=function(w,D){var n,N=D.length;return w&&w.state?(n=w.state).wrap!==0&&n.mode!==11?l:n.mode===11&&r(1,D,N,0)!==n.check?-3:V(w,D,N,N)?(n.mode=31,-4):(n.havedict=1,b):l},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,v,d){var i=s("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];v.exports=function(_,p,b,l,m,o,u,c){var y,k,C,I,T,R,j,L,Z,V=c.bits,w=0,D=0,n=0,N=0,Q=0,M=0,tt=0,W=0,J=0,B=0,A=null,X=0,q=new i.Buf16(16),$=new i.Buf16(16),at=null,pt=0;for(w=0;w<=15;w++)q[w]=0;for(D=0;D<l;D++)q[p[b+D]]++;for(Q=V,N=15;1<=N&&q[N]===0;N--);if(N<Q&&(Q=N),N===0)return m[o++]=20971520,m[o++]=20971520,c.bits=1,0;for(n=1;n<N&&q[n]===0;n++);for(Q<n&&(Q=n),w=W=1;w<=15;w++)if(W<<=1,(W-=q[w])<0)return-1;if(0<W&&(_===0||N!==1))return-1;for($[1]=0,w=1;w<15;w++)$[w+1]=$[w]+q[w];for(D=0;D<l;D++)p[b+D]!==0&&(u[$[p[b+D]]++]=D);if(R=_===0?(A=at=u,19):_===1?(A=r,X-=257,at=e,pt-=257,256):(A=a,at=f,-1),w=n,T=o,tt=D=B=0,C=-1,I=(J=1<<(M=Q))-1,_===1&&852<J||_===2&&592<J)return 1;for(;;){for(j=w-tt,Z=u[D]<R?(L=0,u[D]):u[D]>R?(L=at[pt+u[D]],A[X+u[D]]):(L=96,0),y=1<<w-tt,n=k=1<<M;m[T+(B>>tt)+(k-=y)]=j<<24|L<<16|Z|0,k!==0;);for(y=1<<w-1;B&y;)y>>=1;if(y!==0?(B&=y-1,B+=y):B=0,D++,--q[w]==0){if(w===N)break;w=p[b+u[D]]}if(Q<w&&(B&I)!==C){for(tt===0&&(tt=Q),T+=n,W=1<<(M=w-tt);M+tt<N&&!((W-=q[M+tt])<=0);)M++,W<<=1;if(J+=1<<M,_===1&&852<J||_===2&&592<J)return 1;m[C=B&I]=Q<<24|M<<16|T-o|0}}return B!==0&&(m[T+B]=w-tt<<24|64<<16|0),c.bits=Q,0}},{"../utils/common":41}],51:[function(s,v,d){v.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,v,d){var i=s("../utils/common"),r=0,e=1;function a(h){for(var S=h.length;0<=--S;)h[S]=0}var f=0,_=29,p=256,b=p+1+_,l=30,m=19,o=2*b+1,u=15,c=16,y=7,k=256,C=16,I=17,T=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(b+2));a(V);var w=new Array(2*l);a(w);var D=new Array(512);a(D);var n=new Array(256);a(n);var N=new Array(_);a(N);var Q,M,tt,W=new Array(l);function J(h,S,P,U,z){this.static_tree=h,this.extra_bits=S,this.extra_base=P,this.elems=U,this.max_length=z,this.has_stree=h&&h.length}function B(h,S){this.dyn_tree=h,this.max_code=0,this.stat_desc=S}function A(h){return h<256?D[h]:D[256+(h>>>7)]}function X(h,S){h.pending_buf[h.pending++]=255&S,h.pending_buf[h.pending++]=S>>>8&255}function q(h,S,P){h.bi_valid>c-P?(h.bi_buf|=S<<h.bi_valid&65535,X(h,h.bi_buf),h.bi_buf=S>>c-h.bi_valid,h.bi_valid+=P-c):(h.bi_buf|=S<<h.bi_valid&65535,h.bi_valid+=P)}function $(h,S,P){q(h,P[2*S],P[2*S+1])}function at(h,S){for(var P=0;P|=1&h,h>>>=1,P<<=1,0<--S;);return P>>>1}function pt(h,S,P){var U,z,G=new Array(u+1),Y=0;for(U=1;U<=u;U++)G[U]=Y=Y+P[U-1]<<1;for(z=0;z<=S;z++){var H=h[2*z+1];H!==0&&(h[2*z]=at(G[H]++,H))}}function et(h){var S;for(S=0;S<b;S++)h.dyn_ltree[2*S]=0;for(S=0;S<l;S++)h.dyn_dtree[2*S]=0;for(S=0;S<m;S++)h.bl_tree[2*S]=0;h.dyn_ltree[2*k]=1,h.opt_len=h.static_len=0,h.last_lit=h.matches=0}function rt(h){8<h.bi_valid?X(h,h.bi_buf):0<h.bi_valid&&(h.pending_buf[h.pending++]=h.bi_buf),h.bi_buf=0,h.bi_valid=0}function ht(h,S,P,U){var z=2*S,G=2*P;return h[z]<h[G]||h[z]===h[G]&&U[S]<=U[P]}function st(h,S,P){for(var U=h.heap[P],z=P<<1;z<=h.heap_len&&(z<h.heap_len&&ht(S,h.heap[z+1],h.heap[z],h.depth)&&z++,!ht(S,U,h.heap[z],h.depth));)h.heap[P]=h.heap[z],P=z,z<<=1;h.heap[P]=U}function xt(h,S,P){var U,z,G,Y,H=0;if(h.last_lit!==0)for(;U=h.pending_buf[h.d_buf+2*H]<<8|h.pending_buf[h.d_buf+2*H+1],z=h.pending_buf[h.l_buf+H],H++,U===0?$(h,z,S):($(h,(G=n[z])+p+1,S),(Y=R[G])!==0&&q(h,z-=N[G],Y),$(h,G=A(--U),P),(Y=j[G])!==0&&q(h,U-=W[G],Y)),H<h.last_lit;);$(h,k,S)}function kt(h,S){var P,U,z,G=S.dyn_tree,Y=S.stat_desc.static_tree,H=S.stat_desc.has_stree,K=S.stat_desc.elems,it=-1;for(h.heap_len=0,h.heap_max=o,P=0;P<K;P++)G[2*P]!==0?(h.heap[++h.heap_len]=it=P,h.depth[P]=0):G[2*P+1]=0;for(;h.heap_len<2;)G[2*(z=h.heap[++h.heap_len]=it<2?++it:0)]=1,h.depth[z]=0,h.opt_len--,H&&(h.static_len-=Y[2*z+1]);for(S.max_code=it,P=h.heap_len>>1;1<=P;P--)st(h,G,P);for(z=K;P=h.heap[1],h.heap[1]=h.heap[h.heap_len--],st(h,G,1),U=h.heap[1],h.heap[--h.heap_max]=P,h.heap[--h.heap_max]=U,G[2*z]=G[2*P]+G[2*U],h.depth[z]=(h.depth[P]>=h.depth[U]?h.depth[P]:h.depth[U])+1,G[2*P+1]=G[2*U+1]=z,h.heap[1]=z++,st(h,G,1),2<=h.heap_len;);h.heap[--h.heap_max]=h.heap[1],function(nt,vt){var Ft,Et,Tt,lt,$t,le,It=vt.dyn_tree,we=vt.max_code,Ke=vt.stat_desc.static_tree,Xe=vt.stat_desc.has_stree,Ve=vt.stat_desc.extra_bits,ke=vt.stat_desc.extra_base,Nt=vt.stat_desc.max_length,qt=0;for(lt=0;lt<=u;lt++)nt.bl_count[lt]=0;for(It[2*nt.heap[nt.heap_max]+1]=0,Ft=nt.heap_max+1;Ft<o;Ft++)Nt<(lt=It[2*It[2*(Et=nt.heap[Ft])+1]+1]+1)&&(lt=Nt,qt++),It[2*Et+1]=lt,we<Et||(nt.bl_count[lt]++,$t=0,ke<=Et&&($t=Ve[Et-ke]),le=It[2*Et],nt.opt_len+=le*(lt+$t),Xe&&(nt.static_len+=le*(Ke[2*Et+1]+$t)));if(qt!==0){do{for(lt=Nt-1;nt.bl_count[lt]===0;)lt--;nt.bl_count[lt]--,nt.bl_count[lt+1]+=2,nt.bl_count[Nt]--,qt-=2}while(0<qt);for(lt=Nt;lt!==0;lt--)for(Et=nt.bl_count[lt];Et!==0;)we<(Tt=nt.heap[--Ft])||(It[2*Tt+1]!==lt&&(nt.opt_len+=(lt-It[2*Tt+1])*It[2*Tt],It[2*Tt+1]=lt),Et--)}}(h,S),pt(G,it,h.bl_count)}function t(h,S,P){var U,z,G=-1,Y=S[1],H=0,K=7,it=4;for(Y===0&&(K=138,it=3),S[2*(P+1)+1]=65535,U=0;U<=P;U++)z=Y,Y=S[2*(U+1)+1],++H<K&&z===Y||(H<it?h.bl_tree[2*z]+=H:z!==0?(z!==G&&h.bl_tree[2*z]++,h.bl_tree[2*C]++):H<=10?h.bl_tree[2*I]++:h.bl_tree[2*T]++,G=z,it=(H=0)===Y?(K=138,3):z===Y?(K=6,3):(K=7,4))}function F(h,S,P){var U,z,G=-1,Y=S[1],H=0,K=7,it=4;for(Y===0&&(K=138,it=3),U=0;U<=P;U++)if(z=Y,Y=S[2*(U+1)+1],!(++H<K&&z===Y)){if(H<it)for(;$(h,z,h.bl_tree),--H!=0;);else z!==0?(z!==G&&($(h,z,h.bl_tree),H--),$(h,C,h.bl_tree),q(h,H-3,2)):H<=10?($(h,I,h.bl_tree),q(h,H-3,3)):($(h,T,h.bl_tree),q(h,H-11,7));G=z,it=(H=0)===Y?(K=138,3):z===Y?(K=6,3):(K=7,4)}}a(W);var O=!1;function g(h,S,P,U){q(h,(f<<1)+(U?1:0),3),function(z,G,Y,H){rt(z),X(z,Y),X(z,~Y),i.arraySet(z.pending_buf,z.window,G,Y,z.pending),z.pending+=Y}(h,S,P)}d._tr_init=function(h){O||(function(){var S,P,U,z,G,Y=new Array(u+1);for(z=U=0;z<_-1;z++)for(N[z]=U,S=0;S<1<<R[z];S++)n[U++]=z;for(n[U-1]=z,z=G=0;z<16;z++)for(W[z]=G,S=0;S<1<<j[z];S++)D[G++]=z;for(G>>=7;z<l;z++)for(W[z]=G<<7,S=0;S<1<<j[z]-7;S++)D[256+G++]=z;for(P=0;P<=u;P++)Y[P]=0;for(S=0;S<=143;)V[2*S+1]=8,S++,Y[8]++;for(;S<=255;)V[2*S+1]=9,S++,Y[9]++;for(;S<=279;)V[2*S+1]=7,S++,Y[7]++;for(;S<=287;)V[2*S+1]=8,S++,Y[8]++;for(pt(V,b+1,Y),S=0;S<l;S++)w[2*S+1]=5,w[2*S]=at(S,5);Q=new J(V,R,p+1,b,u),M=new J(w,j,0,l,u),tt=new J(new Array(0),L,0,m,y)}(),O=!0),h.l_desc=new B(h.dyn_ltree,Q),h.d_desc=new B(h.dyn_dtree,M),h.bl_desc=new B(h.bl_tree,tt),h.bi_buf=0,h.bi_valid=0,et(h)},d._tr_stored_block=g,d._tr_flush_block=function(h,S,P,U){var z,G,Y=0;0<h.level?(h.strm.data_type===2&&(h.strm.data_type=function(H){var K,it=4093624447;for(K=0;K<=31;K++,it>>>=1)if(1&it&&H.dyn_ltree[2*K]!==0)return r;if(H.dyn_ltree[18]!==0||H.dyn_ltree[20]!==0||H.dyn_ltree[26]!==0)return e;for(K=32;K<p;K++)if(H.dyn_ltree[2*K]!==0)return e;return r}(h)),kt(h,h.l_desc),kt(h,h.d_desc),Y=function(H){var K;for(t(H,H.dyn_ltree,H.l_desc.max_code),t(H,H.dyn_dtree,H.d_desc.max_code),kt(H,H.bl_desc),K=m-1;3<=K&&H.bl_tree[2*Z[K]+1]===0;K--);return H.opt_len+=3*(K+1)+5+5+4,K}(h),z=h.opt_len+3+7>>>3,(G=h.static_len+3+7>>>3)<=z&&(z=G)):z=G=P+5,P+4<=z&&S!==-1?g(h,S,P,U):h.strategy===4||G===z?(q(h,2+(U?1:0),3),xt(h,V,w)):(q(h,4+(U?1:0),3),function(H,K,it,nt){var vt;for(q(H,K-257,5),q(H,it-1,5),q(H,nt-4,4),vt=0;vt<nt;vt++)q(H,H.bl_tree[2*Z[vt]+1],3);F(H,H.dyn_ltree,K-1),F(H,H.dyn_dtree,it-1)}(h,h.l_desc.max_code+1,h.d_desc.max_code+1,Y+1),xt(h,h.dyn_ltree,h.dyn_dtree)),et(h),U&&rt(h)},d._tr_tally=function(h,S,P){return h.pending_buf[h.d_buf+2*h.last_lit]=S>>>8&255,h.pending_buf[h.d_buf+2*h.last_lit+1]=255&S,h.pending_buf[h.l_buf+h.last_lit]=255&P,h.last_lit++,S===0?h.dyn_ltree[2*P]++:(h.matches++,S--,h.dyn_ltree[2*(n[P]+p+1)]++,h.dyn_dtree[2*A(S)]++),h.last_lit===h.lit_bufsize-1},d._tr_align=function(h){q(h,2,3),$(h,k,V),function(S){S.bi_valid===16?(X(S,S.bi_buf),S.bi_buf=0,S.bi_valid=0):8<=S.bi_valid&&(S.pending_buf[S.pending++]=255&S.bi_buf,S.bi_buf>>=8,S.bi_valid-=8)}(h)}},{"../utils/common":41}],53:[function(s,v,d){v.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,v,d){(function(i){(function(r,e){if(!r.setImmediate){var a,f,_,p,b=1,l={},m=!1,o=r.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(r);u=u&&u.setTimeout?u:r,a={}.toString.call(r.process)==="[object process]"?function(C){process.nextTick(function(){y(C)})}:function(){if(r.postMessage&&!r.importScripts){var C=!0,I=r.onmessage;return r.onmessage=function(){C=!1},r.postMessage("","*"),r.onmessage=I,C}}()?(p="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",k,!1):r.attachEvent("onmessage",k),function(C){r.postMessage(p+C,"*")}):r.MessageChannel?((_=new MessageChannel).port1.onmessage=function(C){y(C.data)},function(C){_.port2.postMessage(C)}):o&&"onreadystatechange"in o.createElement("script")?(f=o.documentElement,function(C){var I=o.createElement("script");I.onreadystatechange=function(){y(C),I.onreadystatechange=null,f.removeChild(I),I=null},f.appendChild(I)}):function(C){setTimeout(y,0,C)},u.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var I=new Array(arguments.length-1),T=0;T<I.length;T++)I[T]=arguments[T+1];var R={callback:C,args:I};return l[b]=R,a(b),b++},u.clearImmediate=c}function c(C){delete l[C]}function y(C){if(m)setTimeout(y,0,C);else{var I=l[C];if(I){m=!0;try{(function(T){var R=T.callback,j=T.args;switch(j.length){case 0:R();break;case 1:R(j[0]);break;case 2:R(j[0],j[1]);break;case 3:R(j[0],j[1],j[2]);break;default:R.apply(e,j)}})(I)}finally{c(C),m=!1}}}}function k(C){C.source===r&&typeof C.data=="string"&&C.data.indexOf(p)===0&&y(+C.data.slice(p.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Yt<"u"?Yt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Oe);var Qe=Oe.exports;const ee=Je(Qe),ge="PhotoAppDB",tn=3,_t="photos",wt="groups",At="folders";let dt,Ct,ot=[],ut=[],ft=[],bt=-1,Ut=!1,gt=new Set,Qt=new Set,St=null,ct=null,Gt=localStorage.getItem("isAutoFilename")!=="false",Le=null,jt=null;const mt=new Map;let Lt;const en=7e3,Zt=document.getElementById("camera-page"),Rt=document.getElementById("gallery-page"),zt=document.getElementById("camera-feed"),Xt=document.getElementById("capture-canvas"),nn=document.getElementById("capture-btn"),rn=document.getElementById("to-gallery-btn"),Vt=document.getElementById("last-photo-preview"),on=document.getElementById("camera-photo-count"),an=document.getElementById("current-group-name"),sn=document.getElementById("new-group-btn"),ne=document.getElementById("group-memo-input"),ue=document.getElementById("change-folder-btn"),Ht=document.getElementById("folder-selection-modal"),ce=document.getElementById("folder-selection-list"),xe=document.getElementById("close-folder-modal-btn"),Ee=document.getElementById("modal-new-folder-btn"),ln=document.getElementById("to-camera-btn"),Se=document.getElementById("gallery-grid"),cn=document.getElementById("photo-count"),dn=document.getElementById("settings-btn"),he=document.getElementById("select-mode-btn"),Ie=document.getElementById("gallery-change-folder-btn"),Pt=document.getElementById("gallery-folder-actions");async function Bt(){const E=ft.find(x=>x.id===ct);if(E){if(ue){const x=document.getElementById("camera-folder-name"),s=document.getElementById("camera-folder-memo");x&&(x.textContent=E.name),s&&(s.textContent=E.memo||"No memo")}if(Ie){const x=document.getElementById("gallery-folder-name-text"),s=document.getElementById("gallery-folder-memo-text");x&&(x.textContent=E.name),s&&(s.textContent=E.memo||"No memo"),Ie.onclick=qe}if(Pt){Pt.innerHTML="";const x=document.createElement("button");x.className="icon-btn small primary",x.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>',x.onclick=()=>Tn(E.id),Pt.appendChild(x);const s=document.createElement("button");s.className="icon-btn small",s.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>',s.onclick=()=>Nn(E.id),Pt.appendChild(s);const v=document.createElement("button");v.className="icon-btn small danger",v.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>',v.onclick=()=>deleteFolder(E.id),Pt.appendChild(v)}ce&&(ce.innerHTML="",ft.forEach(x=>{const s=document.createElement("div");s.style.cssText="padding: 12px; background: rgba(255,255,255,0.1); border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; border: 1px solid transparent; margin-bottom: 5px;",x.id===ct&&(s.style.borderColor="#4CAF50",s.style.backgroundColor="rgba(76, 175, 80, 0.2)");const v=document.createElement("div");v.style.display="flex",v.style.flexDirection="column",v.style.alignItems="flex-start";const d=document.createElement("span");d.textContent=x.name,d.style.fontWeight="bold";const i=document.createElement("span");i.textContent=x.memo||"No memo",i.style.fontSize="0.8rem",i.style.color="#aaa",v.appendChild(d),v.appendChild(i);const r=document.createElement("button");r.className="icon-btn small",r.innerHTML='<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>',r.style.opacity="0.6",r.onclick=e=>{e.stopPropagation();const a=prompt("Edit Folder Memo:",x.memo||"");a!==null&&On(x.id,a).then(()=>{Bt(),Rt.classList.contains("hidden")||yt()})},s.appendChild(v),s.appendChild(r),s.onclick=async()=>{ct=x.id,localStorage.setItem("defaultFolderId",ct),await re(),Bt(),Ht.classList.add("hidden"),Rt.classList.contains("hidden")||await yt()},ce.appendChild(s)}))}}async function un(){let E=0;const x=/^Folder\s+(\d+)$/;ft.forEach(d=>{const i=d.name.match(x);if(i){const r=parseInt(i[1]);r>E&&(E=r)}});const s=E+1;ct=(await _e(`Folder ${s}`)).id,localStorage.setItem("defaultFolderId",ct),await Dt("Group 1","",ct),re(),Bt()}async function hn(){if(!ct)return;const E=ut.filter(i=>i.folderId===ct);let x=0;const s=/^Group\s+(\d+)$/;E.forEach(i=>{const r=i.name.match(s);if(r){const e=parseInt(r[1]);e>x&&(x=e)}});const v=x+1;St=(await Dt(`Group ${v}`,"",ct)).id,me(),ne.value="",Rt.classList.contains("hidden")||await yt()}const Ce=document.getElementById("bulk-action-bar"),fn=document.getElementById("selected-count"),fe=document.getElementById("select-all-btn"),pn=document.getElementById("bulk-download-btn"),mn=document.getElementById("bulk-delete-btn"),gn=document.getElementById("bulk-move-btn"),Mt=document.getElementById("photo-modal"),Re=document.getElementById("modal-image"),_n=document.getElementById("close-modal-btn"),yn=document.getElementById("download-btn"),bn=document.getElementById("delete-btn"),vn=document.getElementById("move-btn"),De=document.getElementById("prev-btn"),Fe=document.getElementById("next-btn"),pe=document.getElementById("settings-modal"),wn=document.getElementById("close-settings-btn"),Te=document.getElementById("auto-filename-toggle"),kn=document.getElementById("reset-app-btn"),Ot=document.getElementById("move-modal"),xn=document.getElementById("close-move-btn"),Jt=document.getElementById("group-list");function En(){mt.forEach(E=>{URL.revokeObjectURL(E)}),mt.clear()}function Sn(){jt||(jt=new IntersectionObserver(E=>{E.forEach(x=>{if(x.isIntersecting){const s=x.target,v=s.dataset.photoId;v&&!s.src&&(In(s,v),jt.unobserve(s))}})},{rootMargin:"100px"}))}function In(E,x){const s=ot.find(v=>v.id==x);if(s){let v=mt.get(x);v||(v=URL.createObjectURL(s.blob),mt.set(x,v)),E.src=v}}async function Cn(){try{await Pe(),await An(),ft=await Ue(),ft.sort((x,s)=>x.id-s.id),ut=await Me(),ut.sort((x,s)=>x.id-s.id);const E=localStorage.getItem("defaultFolderId");E&&ft.find(x=>x.id==E)?ct=Number(E):ft.length>0?ct=ft[ft.length-1].id:ct=(await _e("Folder 1")).id,re(),Be(),qn(),await ie(),ot=await We(),be(),Vn(),Sn(),Te.checked=Gt,Be(),Ne(),Bt()}catch(E){console.error("Initialization failed:",E),alert("Failed to initialize app.")}}function re(){const E=ut.filter(x=>x.folderId===ct);E.length>0?St=E[E.length-1].id:Dt("Group 1","",ct).then(x=>{St=x.id,me()}),me()}function Ne(){Zt.classList.remove("hidden"),Rt.classList.add("hidden"),Ct?zt.paused&&zt.play():ie(),oe()}async function zn(){Zt.classList.add("hidden"),Rt.classList.remove("hidden"),Zt.classList.add("hidden"),Rt.classList.remove("hidden"),He(),await yt()}function Pe(){return new Promise((E,x)=>{const s=indexedDB.open(ge,tn);s.onerror=()=>x(s.error),s.onsuccess=()=>{dt=s.result,E(dt)},s.onupgradeneeded=v=>{const d=v.target.result;d.objectStoreNames.contains(_t)||d.createObjectStore(_t,{keyPath:"id"}),d.objectStoreNames.contains(wt)||d.createObjectStore(wt,{keyPath:"id"}),d.objectStoreNames.contains(At)||d.createObjectStore(At,{keyPath:"id"})}})}async function An(){const x=(await Me()).filter(s=>!s.folderId);if(x.length>0){console.log(`Found ${x.length} orphaned groups. Migrating...`);const s=await Ue();let v=0;const d=/^Folder\s+(\d+)$/;s.forEach(r=>{const e=r.name.match(d);if(e){const a=parseInt(e[1]);a>v&&(v=a)}});const i=await _e(`Folder ${v+1}`);for(const r of x)await Bn(r.id,i.id);console.log("Migration complete.")}}function _e(E,x=""){return new Promise((s,v)=>{const i=dt.transaction([At],"readwrite").objectStore(At),r={id:Date.now(),name:E,memo:x,date:new Date().toISOString()},e=i.add(r);e.onsuccess=()=>{ft.push(r),s(r)},e.onerror=()=>v(e.error)})}function Ue(){return new Promise((E,x)=>{const d=dt.transaction([At],"readonly").objectStore(At).getAll();d.onsuccess=()=>E(d.result),d.onerror=()=>x(d.error)})}function Dt(E,x="",s=null){return new Promise((v,d)=>{const r=dt.transaction([wt],"readwrite").objectStore(wt),e={id:Date.now(),name:E,memo:x,folderId:s||ct,date:new Date().toISOString()},a=r.add(e);a.onsuccess=()=>{ut.push(e),v(e)},a.onerror=()=>d(a.error)})}function Bn(E,x){return new Promise((s,v)=>{const i=dt.transaction([wt],"readwrite").objectStore(wt),r=i.get(E);r.onsuccess=()=>{const e=r.result;e?(e.folderId=x,i.put(e),s()):v("Group not found")},r.onerror=()=>v(r.error)})}function On(E,x){return new Promise((s,v)=>{const i=dt.transaction([At],"readwrite").objectStore(At),r=i.get(E);r.onsuccess=()=>{const e=r.result;if(e){e.memo=x,i.put(e);const a=ft.findIndex(f=>f.id===E);a!==-1&&(ft[a].memo=x),s()}else v("Folder not found")},r.onerror=()=>v(r.error)})}function je(E,x){return new Promise((s,v)=>{const i=dt.transaction([wt],"readwrite").objectStore(wt),r=i.get(E);r.onsuccess=()=>{const e=r.result;if(e){e.memo=x,i.put(e);const a=ut.findIndex(f=>f.id===E);a!==-1&&(ut[a].memo=x),s()}else v("Group not found")},r.onerror=()=>v(r.error)})}function Me(){return new Promise((E,x)=>{const d=dt.transaction([wt],"readonly").objectStore(wt).getAll();d.onsuccess=()=>E(d.result),d.onerror=()=>x(d.error)})}async function me(){const E=ut.find(x=>x.id===St);E&&(an.textContent=E.name,ne.value=E.memo||""),await Bt()}function ye(E,x=null){return new Promise((s,v)=>{const i=dt.transaction([_t],"readwrite").objectStore(_t),r={id:Date.now(),blob:E,groupId:x||St,date:new Date().toISOString()},e=i.add(r);e.onsuccess=()=>s(r),e.onerror=()=>v(e.error)})}function Ln(E,x){return new Promise((s,v)=>{const i=dt.transaction([_t],"readwrite").objectStore(_t),r=i.get(E);r.onsuccess=()=>{const e=r.result;e?(e.groupId=x,i.put(e),s()):v("Photo not found")},r.onerror=()=>v(r.error)})}function We(){return new Promise((E,x)=>{const d=dt.transaction([_t],"readonly").objectStore(_t).getAll();d.onsuccess=()=>E(d.result.reverse()),d.onerror=()=>x(d.error)})}function Ge(E){return new Promise((x,s)=>{const i=dt.transaction([_t],"readwrite").objectStore(_t).delete(E);i.onsuccess=()=>x(),i.onerror=()=>s(i.error)})}function Ze(E){return new Promise(async(x,s)=>{try{const v=dt.transaction([_t],"readwrite");let i=v.objectStore(_t).openCursor();i.onsuccess=f=>{const _=f.target.result;_&&(_.value.groupId===E&&_.delete(),_.continue())},await new Promise((f,_)=>{v.oncomplete=f,v.onerror=_});const e=dt.transaction([wt],"readwrite").objectStore(wt);await new Promise((f,_)=>{const p=e.delete(E);p.onsuccess=f,p.onerror=_});const a=ut.findIndex(f=>f.id===E);a>-1&&ut.splice(a,1),x()}catch(v){s(v)}})}async function ie(){if(!Ct)try{Ct=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:4096},height:{ideal:4096}},audio:!1}),zt.srcObject=Ct,zt.play().catch(E=>console.log("Autoplay blocked:",E)),oe()}catch(E){console.error("Camera access denied:",E)}}function He(){Ct&&(Ct.getTracks().forEach(E=>E.stop()),Ct=null,zt.srcObject=null),Lt&&(clearTimeout(Lt),Lt=null)}function oe(){Lt&&clearTimeout(Lt),Zt.classList.contains("hidden")||(Lt=setTimeout(()=>{He(),console.log("Camera auto-disabled due to inactivity")},en))}function Rn(){if(oe(),!Ct){ie();return}const E=zt.videoWidth,x=zt.videoHeight,s=E/x,v=1080,d=v/s;Xt.width=v,Xt.height=d,Xt.getContext("2d").drawImage(zt,0,0,v,d),Xt.toBlob(async r=>{if(r)try{const e=await ye(r);ot.unshift(e),be();const a=document.querySelector(".inner-circle");a.style.transform="scale(0.8)",setTimeout(()=>a.style.transform="scale(1)",100)}catch(e){console.error("Failed to save photo:",e),alert("Failed to save photo.")}},"image/jpeg",.8)}function be(){const E=ot.length;if(on.textContent=E,E>0){const x=ot[0],s="thumbnail-latest",v=mt.get(s);v&&URL.revokeObjectURL(v);const d=URL.createObjectURL(x.blob);mt.set(s,d),Vt.src=d,Vt.classList.remove("hidden")}else{const x=mt.get("thumbnail-latest");x&&(URL.revokeObjectURL(x),mt.delete("thumbnail-latest")),Vt.src="",Vt.classList.add("hidden")}}let Wt=new Set;async function yt(){En(),ot=await We(),be(),Se.innerHTML="";const E=new Map;ut.forEach(e=>E.set(e.id,e));const x={};ot.forEach(e=>{const a=e.groupId||"undefined";x[a]||(x[a]=[]),x[a].push(e)});const s=new Map;ft.forEach(e=>s.set(e.id,e));let v=ct;!s.has(v)&&v!=="undefined"&&(ft.length>0?v=ft[0].id:v="undefined");const d=ut.filter(e=>v==="undefined"?!e.folderId:e.folderId===v);v==="undefined"||s.get(v);const i=document.createDocumentFragment(),r=d.sort((e,a)=>{const f=b=>{const l=b.name&&b.name.match(/Group\s*(\d+)/i);return l?parseInt(l[1]):-1},_=f(e),p=f(a);return _!==-1&&p!==-1?p-_:a.id-e.id});if(r.length===0){const e=document.createElement("div");e.style.cssText="width: 100%; text-align: center; padding: 40px; color: #666; font-style: italic;",e.textContent="No groups in this folder.",i.appendChild(e)}for(const e of r){const a=x[e.id]||[],f=document.createElement("div");f.className="gallery-group-header",f.style.marginLeft="0px",f.style.width="100%";const _=document.createElement("div");_.style.display="flex",_.style.alignItems="center",_.style.flex="1",_.style.overflow="hidden";const p=document.createElement("button");p.className="icon-btn small",p.innerHTML=Wt.has(e.id)?"":"",p.style.marginRight="8px",p.style.fontSize="0.8rem",p.onclick=c=>{c.stopPropagation(),Dn(e.id)};const b=document.createElement("span");b.textContent=e.name;const l=document.createElement("span");l.className="group-memo-display",l.textContent=e.memo||"Add memo...",l.onclick=()=>{const c=prompt("Edit Memo:",e.memo||"");c!==null&&je(e.id,c).then(()=>{yt(),St===e.id&&(ne.value=c)})},_.appendChild(p),_.appendChild(b),_.appendChild(l);const m=document.createElement("div");m.style.display="flex",m.style.alignItems="center",m.style.gap="8px";const o=document.createElement("span");o.style.fontSize="0.7rem",o.style.opacity="0.7",o.textContent=a.length;const u=document.createElement("button");u.className="icon-btn small danger",u.innerHTML=`
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        `,u.onclick=()=>Fn(e.id,a.length),m.appendChild(o),m.appendChild(u),f.appendChild(_),f.appendChild(m),i.appendChild(f),Wt.has(e.id)||(a.forEach(c=>{const y=Pn(c);i.appendChild(y)}),i.appendChild(Jn(e.id)))}Se.appendChild(i),Un()}function Dn(E){Wt.has(E)?Wt.delete(E):Wt.add(E),yt()}async function Fn(E,x){if(confirm(`Delete Group and all ${x} photos?`))try{await Ze(E),St===E&&ut.length>0&&(St=ut[0].id),await yt()}catch(s){console.error(s),alert("Failed to delete group")}}async function Tn(E){const x=ft.find(s=>s.id===E);if(x)try{const s=new ee,v=x.name.replace(/[\\/:*?"<>|]/g,"_"),d=(x.memo||"").replace(/[\\/:*?"<>|]/g,"_"),i=d?`${v}(${d}).zip`:`${v}.zip`,r=ut.filter(f=>f.folderId===E);for(const f of r){const _=f.name.replace(/[\\/:*?"<>|]/g,"_"),p=(f.memo||"").replace(/[\\/:*?"<>|]/g,"_"),b=p?`${_}(${p})`:_,l=ot.filter(o=>o.groupId===f.id);l.sort((o,u)=>new Date(o.date)-new Date(u.date));let m=1;for(const o of l){const u=new Date(o.date),c=u.getFullYear(),y=String(u.getMonth()+1).padStart(2,"0"),k=String(u.getDate()).padStart(2,"0"),C=String(u.getHours()).padStart(2,"0"),I=String(u.getMinutes()).padStart(2,"0"),T=String(u.getSeconds()).padStart(2,"0"),j=`${`${c}${y}${k}_${C}${I}${T}`}(${m}).jpg`;s.folder(b).file(j,o.blob),m++}}const e=await s.generateAsync({type:"blob"}),a=document.createElement("a");a.href=URL.createObjectURL(e),a.download=i,a.click(),URL.revokeObjectURL(a.href)}catch(s){console.error("Failed to save folder:",s),alert("Failed to export folder.")}}async function Nn(E){const x=document.createElement("input");x.type="file",x.accept=".zip",x.onchange=async s=>{const v=s.target.files[0];if(v&&confirm("This will REPLACE the contents of this folder. Continue?"))try{const d=await ee.loadAsync(v),i=ut.filter(f=>f.folderId===E);for(const f of i)await Ze(f.id);const r=new Map,e=f=>{const _=f.match(/^(.*)\((.*)\)$/);return _?{name:_[1].trim(),memo:_[2].trim()}:{name:f.trim(),memo:""}},a=f=>{const _=f.match(/^(\d{4})(\d{2})(\d{2})_(\d{2})(\d{2})(\d{2})\(\d+\)\./);if(_){const p=parseInt(_[1]),b=parseInt(_[2])-1,l=parseInt(_[3]),m=parseInt(_[4]),o=parseInt(_[5]),u=parseInt(_[6]);return new Date(p,b,l,m,o,u).toISOString()}return new Date().toISOString()};d.forEach((f,_)=>{if(_.dir||f.startsWith("__MACOSX")||f.includes("/."))return;const p=f.split("/");let b="Uncategorized",l=p[p.length-1];p.length>=2&&(b=p[p.length-2]),r.has(b)||r.set(b,{...e(b),photos:[]}),r.get(b).photos.push(_)});for(const[f,_]of r){const p=await Dt(_.name,_.memo,E);_.photos.sort((b,l)=>b.name.localeCompare(l.name));for(const b of _.photos){const l=await b.async("blob"),m=b.name.split("/").pop(),o=a(m);await new Promise((u,c)=>{const k=dt.transaction([_t],"readwrite").objectStore(_t),C={id:Date.now()+Math.random(),groupId:p.id,name:m,blob:l,date:o},I=k.add(C);I.onsuccess=u,I.onerror=c})}}await yt(),alert("Folder Restored Successfully")}catch(d){console.error(d),alert("Failed to restore folder")}},x.click()}function Pn(E){const x=document.createElement("div");x.className="gallery-item";const s=document.createElement("div");s.className="selection-indicator",x.appendChild(s);const v=document.createElement("img");if(v.dataset.photoId=E.id,v.alt="",jt)jt.observe(v);else{const d=URL.createObjectURL(E.blob);v.src=d,mt.set(E.id,d)}return x.appendChild(v),x.onclick=()=>{Ut?jn(E.id,x):Hn(E.id)},x}function Un(){const E=ot.length;cn.textContent=`${E} photo${E!==1?"s":""}`}function ae(){Ut=!Ut,Ut?(Ce.classList.remove("hidden"),he.textContent="Cancel",document.querySelectorAll(".gallery-item").forEach(E=>{E.classList.add("selecting")})):(Ce.classList.add("hidden"),he.textContent="Select",gt.clear(),ve(),document.querySelectorAll(".gallery-item").forEach(E=>{E.classList.remove("selecting","selected")}))}function jn(E,x){gt.has(E)?(gt.delete(E),x.classList.remove("selected")):(gt.add(E),x.classList.add("selected")),ve()}function ve(){fn.textContent=`${gt.size} selected`,gt.size===ot.length&&ot.length>0?fe.textContent="Deselect All":fe.textContent="Select All"}function Mn(){gt.size===ot.length?(gt.clear(),document.querySelectorAll(".gallery-item").forEach(E=>{E.classList.remove("selected")})):(ot.forEach(E=>gt.add(E.id)),document.querySelectorAll(".gallery-item").forEach(E=>{E.classList.add("selected")})),ve()}async function Wn(){if(gt.size===0)return;const E=ot.filter(c=>gt.has(c.id));let x=null;const s=new Date,v=s.getFullYear(),d=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0"),r=String(s.getHours()).padStart(2,"0"),e=String(s.getMinutes()).padStart(2,"0"),a=String(s.getSeconds()).padStart(2,"0"),f=`${v}${d}${i}_${r}${e}${a}`;if(Gt)x=f;else{const c=prompt("Enter filename:",f);if(c===null)return;x=c.replace(".zip","").replace(".jpg","")}const _=new ee,p=new Map(ut.map(c=>[c.id,c])),b={};E.forEach(c=>{const y=c.groupId||"undefined";b[y]||(b[y]=[]),b[y].push(c)});let l=1;for(const[c,y]of Object.entries(b)){let k="Uncategorized";if(c!=="undefined"){const I=p.get(Number(c));if(I){const T=I.name.replace(/[\\/:*?"<>|]/g,"_"),R=(I.memo||"").replace(/[\\/:*?"<>|]/g,"_");k=R?`${T}(${R})`:T}}const C=_.folder(k);y.forEach(I=>{const T=`${x}(${l}).jpg`;C.file(T,I.blob),l++})}const m=await _.generateAsync({type:"blob"}),o=URL.createObjectURL(m),u=document.createElement("a");u.href=o,u.download=`${x}.zip`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o),alert(`${x}.zip ${E.length}  .`),ae()}async function Gn(){if(gt.size!==0&&confirm(`Delete ${gt.size} photos?`)){for(const E of gt)await Ge(E);await yt(),ae()}}function $e(E=null){if(E?Qt=new Set(E):Qt=new Set(gt),Qt.size===0)return;Jt.innerHTML="";const x={};ft.forEach(d=>x[d.id]=[]),x.undefined=[],ut.forEach(d=>{d.folderId&&x[d.folderId]?x[d.folderId].push(d):x.undefined.push(d)});const s=ft.sort((d,i)=>d.id-i.id),v=d=>{const i=document.createElement("div");i.className="group-list-item",i.style.paddingLeft="25px",i.innerHTML=`<span>${d.name}</span><span style="font-size:0.8rem;color:#aaa">${d.memo||""}</span>`,i.onclick=()=>Zn(d.id),Jt.appendChild(i)};if(s.forEach(d=>{const i=x[d.id];if(i.length===0)return;const r=document.createElement("div");r.style.cssText="padding: 8px 10px; background: rgba(255,255,255,0.1); font-weight: bold; margin-top: 5px; border-radius: 4px;",r.textContent=` ${d.name}`,Jt.appendChild(r),i.forEach(v)}),x.undefined.length>0){const d=document.createElement("div");d.style.cssText="padding: 8px 10px; background: rgba(255,255,255,0.1); font-weight: bold; margin-top: 5px; border-radius: 4px;",d.textContent=" Uncategorized",Jt.appendChild(d),x.undefined.forEach(v)}Ot.classList.remove("hidden")}async function Zn(E){for(const x of Qt)await Ln(x,E);Ot.classList.add("hidden"),Ut&&ae(),await yt()}function Hn(E){bt=ot.findIndex(x=>x.id===E),bt!==-1&&(se(),Mt.classList.remove("hidden"))}function se(){const E=ot[bt];if(!E)return;const x=`modal-${E.id}`;let s=mt.get(x);s||(s=URL.createObjectURL(E.blob),mt.set(x,s)),Re.src=s,yn.onclick=()=>$n(E),vn.onclick=()=>$e([E.id]),bn.onclick=async()=>{if(confirm("Delete this photo?")){await Ge(E.id);const v=mt.get(E.id);v&&(URL.revokeObjectURL(v),mt.delete(E.id));const d=mt.get(x);d&&(URL.revokeObjectURL(d),mt.delete(x)),ot.splice(bt,1),ot.length===0?(te(),yt()):(bt>=ot.length&&(bt=ot.length-1),se(),yt())}},De.style.display=bt>0?"flex":"none",Fe.style.display=bt<ot.length-1?"flex":"none"}function ze(){bt<ot.length-1&&(bt++,se())}function Ae(){bt>0&&(bt--,se())}function te(){Mt.classList.add("hidden"),setTimeout(()=>{Re.src="",bt=-1},300)}function $n(E,x=null,s=null){return new Promise(v=>{const d=URL.createObjectURL(E.blob),i=document.createElement("a");i.href=d;let r,e;if(s)r=s,e=`${r}.jpg`;else{const a=new Date,f=a.getFullYear(),_=String(a.getMonth()+1).padStart(2,"0"),p=String(a.getDate()).padStart(2,"0"),b=String(a.getHours()).padStart(2,"0"),l=String(a.getMinutes()).padStart(2,"0"),m=String(a.getSeconds()).padStart(2,"0");if(r=`${f}${_}${p}_${b}${l}${m}`,e=`${r}.jpg`,!Gt){const o=prompt("Enter filename:",e);if(o===null){URL.revokeObjectURL(d),v();return}r=o.replace(".jpg",""),e=`${r}.jpg`}}if(x){let a=1;for(;x.has(e);)e=`${r}(${a}).jpg`,a++;x.add(e)}i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(d),v()})}function qn(){const E=document.createElement("input");E.type="file",E.id="hidden-zip-input",E.accept=".zip",E.style.display="none",document.body.appendChild(E),E.addEventListener("change",x=>Yn(x.target.files[0]))}async function Yn(E){if(E){if(!confirm("WARNING: This will DELETE ALL current photos and replace them with the backup.")){document.getElementById("hidden-zip-input").value="";return}try{const x=await ee.loadAsync(E);dt&&dt.close(),await new Promise((r,e)=>{const a=indexedDB.deleteDatabase(ge);a.onsuccess=()=>{dt=null,r()},a.onerror=()=>{console.warn("Delete DB failed or blocked, trying to proceed anyway"),r()},a.onblocked=()=>{console.warn("Delete DB blocked. Reloading page might be needed.")}}),await new Promise(r=>setTimeout(r,100)),await Pe(),ut=[];const s=new Map,v=r=>{const e=r.replace(/\/$/,""),a=/^(.*?)(\((.*)\))?$/,f=e.match(a);let _=e,p="";return f&&(_=f[1]||e,f[3]&&(p=f[3])),{name:_.trim(),memo:p.trim()}},d=[];x.forEach((r,e)=>{!e.dir&&!r.startsWith("__MACOSX")&&!r.includes("/.")&&d.push(e)}),console.log(`Found ${d.length} files in ZIP.`);let i=0;for(const r of d)try{const e=r.name.split("/");let a=null;if(e.length>1){const p=e[0];if(!s.has(p)){const b=v(p),l=await Dt(b.name,b.memo);s.set(p,l.id)}a=s.get(p)}else{if(!s.has("Default")){const p=await Dt("Restored");s.set("Default",p.id)}a=s.get("Default")}const f=await r.async("blob"),_=await Ye(f);await ye(_,a),i++}catch(e){console.error(`Failed to process ${r.name}:`,e)}alert(`Restore complete! ${i} photos imported.`),location.reload()}catch(x){console.error(x),alert("Failed to restore backup: "+x.message),location.reload()}}}function de(){document.getElementById("auto-filename-toggle"),document.getElementById("restore-btn"),pe.classList.toggle("hidden")}function Kn(){if(confirm("WARNING: This will delete ALL photos.")){const E=indexedDB.deleteDatabase(ge);E.onsuccess=()=>{alert("App reset successfully."),location.reload()},E.onerror=()=>{alert("Failed to reset app.")}}}function qe(){Ht&&(Ht.classList.remove("hidden"),Bt())}function Xn(){Ht&&Ht.classList.add("hidden")}function Vn(){document.addEventListener("click",x=>{Zt.classList.contains("hidden")||(Ct?oe():ie())},!0),rn.addEventListener("click",zn),ln.addEventListener("click",Ne),nn.addEventListener("click",Rn),ue&&ue.addEventListener("click",qe),xe&&xe.addEventListener("click",Xn);const E=document.getElementById("gallery-folder-select");E&&E.addEventListener("change",async x=>{ct=Number(x.target.value),localStorage.setItem("defaultFolderId",ct),re(),Bt(),await yt()}),Ee&&Ee.addEventListener("click",async()=>{await un(),Bt()}),sn.addEventListener("click",hn),ne.addEventListener("change",x=>{St&&je(St,x.target.value)}),_n.addEventListener("click",te),Mt.addEventListener("click",x=>{x.target===Mt&&te()}),De.addEventListener("click",x=>{x.stopPropagation(),Ae()}),Fe.addEventListener("click",x=>{x.stopPropagation(),ze()}),document.addEventListener("keydown",x=>{Mt.classList.contains("hidden")||(x.key==="ArrowLeft"&&Ae(),x.key==="ArrowRight"&&ze(),x.key==="Escape"&&te())}),he.addEventListener("click",ae),fe.addEventListener("click",Mn),pn.addEventListener("click",Wn),mn.addEventListener("click",Gn),gn.addEventListener("click",()=>$e()),dn.addEventListener("click",de),wn.addEventListener("click",de),pe.addEventListener("click",x=>{x.target===pe&&de()}),Te.addEventListener("change",x=>{Gt=x.target.checked,localStorage.setItem("isAutoFilename",Gt)}),kn.addEventListener("click",Kn),document.getElementById("restore-btn").onclick=()=>{document.getElementById("hidden-zip-input").click()},xn.addEventListener("click",()=>Ot.classList.add("hidden")),Ot.addEventListener("click",x=>{x.target===Ot&&Ot.classList.add("hidden")})}function Be(){const E=document.createElement("input");E.type="file",E.id="hidden-file-input",E.accept="image/*",E.multiple=!0,E.style.display="none",document.body.appendChild(E),E.addEventListener("change",x=>Qn(x.target.files))}function Jn(E){const x=document.createElement("div");return x.className="gallery-item upload-btn",x.innerHTML=`
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
    `,x.onclick=()=>{Le=Number(E),document.getElementById("hidden-file-input").click()},x}async function Qn(E){if(!(!E||E.length===0))try{const x=Array.from(E);let s=0;for(const v of x){const d=await Ye(v);await ye(d,Le),s++}document.getElementById("hidden-file-input").value="",await yt()}catch(x){console.error("Upload failed:",x),alert("Failed to upload photos.")}}function Ye(E){return new Promise((x,s)=>{const v=new FileReader;v.onload=d=>{const i=new Image;i.onload=()=>{let e=i.width,a=i.height;e>a?e>1920&&(a*=1920/e,e=1920):a>1920&&(e*=1920/a,a=1920);const f=document.createElement("canvas");f.width=e,f.height=a,f.getContext("2d").drawImage(i,0,0,e,a),f.toBlob(p=>{x(p)},"image/jpeg",.8)},i.onerror=s,i.src=d.target.result},v.onerror=s,v.readAsDataURL(E)})}Cn();
